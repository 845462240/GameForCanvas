(function(e,t,n){function U(e){return ot(K(it(e),e.length*R))}function z(e){return ut(K(it(e),e.length*R))}function W(e){return st(K(it(e),e.length*R))}function X(e,t){return ot(tt(e,t))}function V(e,t){return ut(tt(e,t))}function $(e,t){return st(tt(e,t))}function J(){return U("abc")=="900150983cd24fb0d6963f7d28e17f72"}function K(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;var n=1732584193,r=-271733879,i=-1732584194,s=271733878;for(var o=0;o<e.length;o+=16){var u=n,a=r,f=i,l=s;n=G(n,r,i,s,e[o+0],7,-680876936),s=G(s,n,r,i,e[o+1],12,-389564586),i=G(i,s,n,r,e[o+2],17,606105819),r=G(r,i,s,n,e[o+3],22,-1044525330),n=G(n,r,i,s,e[o+4],7,-176418897),s=G(s,n,r,i,e[o+5],12,1200080426),i=G(i,s,n,r,e[o+6],17,-1473231341),r=G(r,i,s,n,e[o+7],22,-45705983),n=G(n,r,i,s,e[o+8],7,1770035416),s=G(s,n,r,i,e[o+9],12,-1958414417),i=G(i,s,n,r,e[o+10],17,-42063),r=G(r,i,s,n,e[o+11],22,-1990404162),n=G(n,r,i,s,e[o+12],7,1804603682),s=G(s,n,r,i,e[o+13],12,-40341101),i=G(i,s,n,r,e[o+14],17,-1502002290),r=G(r,i,s,n,e[o+15],22,1236535329),n=Y(n,r,i,s,e[o+1],5,-165796510),s=Y(s,n,r,i,e[o+6],9,-1069501632),i=Y(i,s,n,r,e[o+11],14,643717713),r=Y(r,i,s,n,e[o+0],20,-373897302),n=Y(n,r,i,s,e[o+5],5,-701558691),s=Y(s,n,r,i,e[o+10],9,38016083),i=Y(i,s,n,r,e[o+15],14,-660478335),r=Y(r,i,s,n,e[o+4],20,-405537848),n=Y(n,r,i,s,e[o+9],5,568446438),s=Y(s,n,r,i,e[o+14],9,-1019803690),i=Y(i,s,n,r,e[o+3],14,-187363961),r=Y(r,i,s,n,e[o+8],20,1163531501),n=Y(n,r,i,s,e[o+13],5,-1444681467),s=Y(s,n,r,i,e[o+2],9,-51403784),i=Y(i,s,n,r,e[o+7],14,1735328473),r=Y(r,i,s,n,e[o+12],20,-1926607734),n=Z(n,r,i,s,e[o+5],4,-378558),s=Z(s,n,r,i,e[o+8],11,-2022574463),i=Z(i,s,n,r,e[o+11],16,1839030562),r=Z(r,i,s,n,e[o+14],23,-35309556),n=Z(n,r,i,s,e[o+1],4,-1530992060),s=Z(s,n,r,i,e[o+4],11,1272893353),i=Z(i,s,n,r,e[o+7],16,-155497632),r=Z(r,i,s,n,e[o+10],23,-1094730640),n=Z(n,r,i,s,e[o+13],4,681279174),s=Z(s,n,r,i,e[o+0],11,-358537222),i=Z(i,s,n,r,e[o+3],16,-722521979),r=Z(r,i,s,n,e[o+6],23,76029189),n=Z(n,r,i,s,e[o+9],4,-640364487),s=Z(s,n,r,i,e[o+12],11,-421815835),i=Z(i,s,n,r,e[o+15],16,530742520),r=Z(r,i,s,n,e[o+2],23,-995338651),n=et(n,r,i,s,e[o+0],6,-198630844),s=et(s,n,r,i,e[o+7],10,1126891415),i=et(i,s,n,r,e[o+14],15,-1416354905),r=et(r,i,s,n,e[o+5],21,-57434055),n=et(n,r,i,s,e[o+12],6,1700485571),s=et(s,n,r,i,e[o+3],10,-1894986606),i=et(i,s,n,r,e[o+10],15,-1051523),r=et(r,i,s,n,e[o+1],21,-2054922799),n=et(n,r,i,s,e[o+8],6,1873313359),s=et(s,n,r,i,e[o+15],10,-30611744),i=et(i,s,n,r,e[o+6],15,-1560198380),r=et(r,i,s,n,e[o+13],21,1309151649),n=et(n,r,i,s,e[o+4],6,-145523070),s=et(s,n,r,i,e[o+11],10,-1120210379),i=et(i,s,n,r,e[o+2],15,718787259),r=et(r,i,s,n,e[o+9],21,-343485551),n=nt(n,u),r=nt(r,a),i=nt(i,f),s=nt(s,l)}return Array(n,r,i,s)}function Q(e,t,n,r,i,s){return nt(rt(nt(nt(t,e),nt(r,s)),i),n)}function G(e,t,n,r,i,s,o){return Q(t&n|~t&r,e,t,i,s,o)}function Y(e,t,n,r,i,s,o){return Q(t&r|n&~r,e,t,i,s,o)}function Z(e,t,n,r,i,s,o){return Q(t^n^r,e,t,i,s,o)}function et(e,t,n,r,i,s,o){return Q(n^(t|~r),e,t,i,s,o)}function tt(e,t){var n=it(e);n.length>16&&(n=K(n,e.length*R));var r=Array(16),i=Array(16);for(var s=0;s<16;s++)r[s]=n[s]^909522486,i[s]=n[s]^1549556828;var o=K(r.concat(it(t)),512+t.length*R);return K(i.concat(o),640)}function nt(e,t){var n=(e&65535)+(t&65535),r=(e>>16)+(t>>16)+(n>>16);return r<<16|n&65535}function rt(e,t){return e<<t|e>>>32-t}function it(e){var t=Array(),n=(1<<R)-1;for(var r=0;r<e.length*R;r+=R)t[r>>5]|=(e.charCodeAt(r/R)&n)<<r%32;return t}function st(e){var t="",n=(1<<R)-1;for(var r=0;r<e.length*32;r+=R)t+=String.fromCharCode(e[r>>5]>>>r%32&n);return t}function ot(e){var t=I?"0123456789ABCDEF":"0123456789abcdef",n="";for(var r=0;r<e.length*4;r++)n+=t.charAt(e[r>>2]>>r%4*8+4&15)+t.charAt(e[r>>2]>>r%4*8&15);return n}function ut(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="";for(var r=0;r<e.length*4;r+=3){var i=(e[r>>2]>>8*(r%4)&255)<<16|(e[r+1>>2]>>8*((r+1)%4)&255)<<8|e[r+2>>2]>>8*((r+2)%4)&255;for(var s=0;s<4;s++)r*8+s*6>e.length*32?n+=q:n+=t.charAt(i>>6*(3-s)&63)}return n}var r=function(t){var n=t.split("."),r=e;for(var i=0;i<n.length;i++)r[n[i]]||(r[n[i]]={}),r=r[n[i]]};r("com.qici.richText");var i=com.qici.richText.UnicodeBlock={};i.of=function(e){var t=e.charCodeAt(0),n=i.blockStarts,r=0,s=n.length,o=s/2;while(s-r>1)t>=n[o]?r=o:s=o,o=(r+s)/2|0;return i.blocks[o]},i.isCJK=function(e){var t=i.of(e);return t>=i.CJK_START&&t<=i.CJK_END};var s=1;i.AEGEAN_NUMBERS=s++,i.ALCHEMICAL_SYMBOLS=s++,i.ALPHABETIC_PRESENTATION_FORMS=s++,i.ANCIENT_GREEK_MUSICAL_NOTATION=s++,i.ANCIENT_GREEK_NUMBERS=s++,i.ANCIENT_SYMBOLS=s++,i.ARABIC=s++,i.ARABIC_EXTENDED_A=s++,i.ARABIC_MATHEMATICAL_ALPHABETIC_SYMBOLS=s++,i.ARABIC_PRESENTATION_FORMS_A=s++,i.ARABIC_PRESENTATION_FORMS_B=s++,i.ARABIC_SUPPLEMENT=s++,i.ARMENIAN=s++,i.ARROWS=s++,i.AVESTAN=s++,i.BALINESE=s++,i.BAMUM=s++,i.BAMUM_SUPPLEMENT=s++,i.BASIC_LATIN=s++,i.BATAK=s++,i.BENGALI=s++,i.BLOCK_ELEMENTS=s++,i.BOPOMOFO=s++,i.BOPOMOFO_EXTENDED=s++,i.BOX_DRAWING=s++,i.BRAHMI=s++,i.BRAILLE_PATTERNS=s++,i.BUGINESE=s++,i.BUHID=s++,i.BYZANTINE_MUSICAL_SYMBOLS=s++,i.CARIAN=s++,i.CHAKMA=s++,i.CHAM=s++,i.CHEROKEE=s++,i.CJK_COMPATIBILITY=s++,i.CJK_START=i.CJK_COMPATIBILITY,i.CJK_COMPATIBILITY_FORMS=s++,i.CJK_COMPATIBILITY_IDEOGRAPHS=s++,i.CJK_COMPATIBILITY_IDEOGRAPHS_SUPPLEMENT=s++,i.CJK_RADICALS_SUPPLEMENT=s++,i.CJK_STROKES=s++,i.CJK_SYMBOLS_AND_PUNCTUATION=s++,i.HALFWIDTH_AND_FULLWIDTH_FORMS=s++,i.CJK_UNIFIED_IDEOGRAPHS=s++,i.CJK_UNIFIED_IDEOGRAPHS_EXTENSION_A=s++,i.CJK_UNIFIED_IDEOGRAPHS_EXTENSION_B=s++,i.CJK_UNIFIED_IDEOGRAPHS_EXTENSION_C=s++,i.CJK_UNIFIED_IDEOGRAPHS_EXTENSION_D=s++,i.CJK_END=i.CJK_UNIFIED_IDEOGRAPHS_EXTENSION_D,i.COMBINING_DIACRITICAL_MARKS=s++,i.COMBINING_DIACRITICAL_MARKS_SUPPLEMENT=s++,i.COMBINING_HALF_MARKS=s++,i.COMBINING_MARKS_FOR_SYMBOLS=s++,i.COMMON_INDIC_NUMBER_FORMS=s++,i.CONTROL_PICTURES=s++,i.COPTIC=s++,i.COUNTING_ROD_NUMERALS=s++,i.CUNEIFORM=s++,i.CUNEIFORM_NUMBERS_AND_PUNCTUATION=s++,i.CURRENCY_SYMBOLS=s++,i.CYPRIOT_SYLLABARY=s++,i.CYRILLIC=s++,i.CYRILLIC_EXTENDED_A=s++,i.CYRILLIC_EXTENDED_B=s++,i.CYRILLIC_SUPPLEMENTARY=s++,i.DESERET=s++,i.DEVANAGARI=s++,i.DEVANAGARI_EXTENDED=s++,i.DINGBATS=s++,i.DOMINO_TILES=s++,i.EGYPTIAN_HIEROGLYPHS=s++,i.EMOTICONS=s++,i.ENCLOSED_ALPHANUMERIC_SUPPLEMENT=s++,i.ENCLOSED_ALPHANUMERICS=s++,i.ENCLOSED_CJK_LETTERS_AND_MONTHS=s++,i.ENCLOSED_IDEOGRAPHIC_SUPPLEMENT=s++,i.ETHIOPIC=s++,i.ETHIOPIC_EXTENDED=s++,i.ETHIOPIC_EXTENDED_A=s++,i.ETHIOPIC_SUPPLEMENT=s++,i.GENERAL_PUNCTUATION=s++,i.GEOMETRIC_SHAPES=s++,i.GEORGIAN=s++,i.GEORGIAN_SUPPLEMENT=s++,i.GLAGOLITIC=s++,i.GOTHIC=s++,i.GREEK=s++,i.GREEK_EXTENDED=s++,i.GUJARATI=s++,i.GURMUKHI=s++,i.HANGUL_COMPATIBILITY_JAMO=s++,i.HANGUL_JAMO=s++,i.HANGUL_JAMO_EXTENDED_A=s++,i.HANGUL_JAMO_EXTENDED_B=s++,i.HANGUL_SYLLABLES=s++,i.HANUNOO=s++,i.HEBREW=s++,i.HIGH_PRIVATE_USE_SURROGATES=s++,i.HIGH_SURROGATES=s++,i.HIRAGANA=s++,i.IDEOGRAPHIC_DESCRIPTION_CHARACTERS=s++,i.IMPERIAL_ARAMAIC=s++,i.INSCRIPTIONAL_PAHLAVI=s++,i.INSCRIPTIONAL_PARTHIAN=s++,i.IPA_EXTENSIONS=s++,i.JAVANESE=s++,i.KAITHI=s++,i.KANA_SUPPLEMENT=s++,i.KANBUN=s++,i.KANGXI_RADICALS=s++,i.KANNADA=s++,i.KATAKANA=s++,i.KATAKANA_PHONETIC_EXTENSIONS=s++,i.KAYAH_LI=s++,i.KHAROSHTHI=s++,i.KHMER=s++,i.KHMER_SYMBOLS=s++,i.LAO=s++,i.LATIN_1_SUPPLEMENT=s++,i.LATIN_EXTENDED_A=s++,i.LATIN_EXTENDED_ADDITIONAL=s++,i.LATIN_EXTENDED_B=s++,i.LATIN_EXTENDED_C=s++,i.LATIN_EXTENDED_D=s++,i.LEPCHA=s++,i.LETTERLIKE_SYMBOLS=s++,i.LIMBU=s++,i.LINEAR_B_IDEOGRAMS=s++,i.LINEAR_B_SYLLABARY=s++,i.LISU=s++,i.LOW_SURROGATES=s++,i.LYCIAN=s++,i.LYDIAN=s++,i.MAHJONG_TILES=s++,i.MALAYALAM=s++,i.MANDAIC=s++,i.MATHEMATICAL_ALPHANUMERIC_SYMBOLS=s++,i.MATHEMATICAL_OPERATORS=s++,i.MEETEI_MAYEK=s++,i.MEETEI_MAYEK_EXTENSIONS=s++,i.MEROITIC_CURSIVE=s++,i.MEROITIC_HIEROGLYPHS=s++,i.MIAO=s++,i.MISCELLANEOUS_MATHEMATICAL_SYMBOLS_A=s++,i.MISCELLANEOUS_MATHEMATICAL_SYMBOLS_B=s++,i.MISCELLANEOUS_SYMBOLS=s++,i.MISCELLANEOUS_SYMBOLS_AND_ARROWS=s++,i.MISCELLANEOUS_SYMBOLS_AND_PICTOGRAPHS=s++,i.MISCELLANEOUS_TECHNICAL=s++,i.MODIFIER_TONE_LETTERS=s++,i.MONGOLIAN=s++,i.MUSICAL_SYMBOLS=s++,i.MYANMAR=s++,i.MYANMAR_EXTENDED_A=s++,i.NEW_TAI_LUE=s++,i.NKO=s++,i.NUMBER_FORMS=s++,i.OGHAM=s++,i.OL_CHIKI=s++,i.OLD_ITALIC=s++,i.OLD_PERSIAN=s++,i.OLD_SOUTH_ARABIAN=s++,i.OLD_TURKIC=s++,i.OPTICAL_CHARACTER_RECOGNITION=s++,i.ORIYA=s++,i.OSMANYA=s++,i.PHAGS_PA=s++,i.PHAISTOS_DISC=s++,i.PHOENICIAN=s++,i.PHONETIC_EXTENSIONS=s++,i.PHONETIC_EXTENSIONS_SUPPLEMENT=s++,i.PLAYING_CARDS=s++,i.PRIVATE_USE_AREA=s++,i.REJANG=s++,i.RUMI_NUMERAL_SYMBOLS=s++,i.RUNIC=s++,i.SAMARITAN=s++,i.SAURASHTRA=s++,i.SHARADA=s++,i.SHAVIAN=s++,i.SINHALA=s++,i.SMALL_FORM_VARIANTS=s++,i.SORA_SOMPENG=s++,i.SPACING_MODIFIER_LETTERS=s++,i.SPECIALS=s++,i.SUNDANESE=s++,i.SUNDANESE_SUPPLEMENT=s++,i.SUPERSCRIPTS_AND_SUBSCRIPTS=s++,i.SUPPLEMENTAL_ARROWS_A=s++,i.SUPPLEMENTAL_ARROWS_B=s++,i.SUPPLEMENTAL_MATHEMATICAL_OPERATORS=s++,i.SUPPLEMENTAL_PUNCTUATION=s++,i.SUPPLEMENTARY_PRIVATE_USE_AREA_A=s++,i.SUPPLEMENTARY_PRIVATE_USE_AREA_B=s++,i.SURROGATES_AREA=s++,i.SYLOTI_NAGRI=s++,i.SYRIAC=s++,i.TAGALOG=s++,i.TAGBANWA=s++,i.TAGS=s++,i.TAI_LE=s++,i.TAI_THAM=s++,i.TAI_VIET=s++,i.TAI_XUAN_JING_SYMBOLS=s++,i.TAKRI=s++,i.TAMIL=s++,i.TELUGU=s++,i.THAANA=s++,i.THAI=s++,i.TIBETAN=s++,i.TIFINAGH=s++,i.TRANSPORT_AND_MAP_SYMBOLS=s++,i.UGARITIC=s++,i.UNIFIED_CANADIAN_ABORIGINAL_SYLLABICS=s++,i.UNIFIED_CANADIAN_ABORIGINAL_SYLLABICS_EXTENDED=s++,i.VAI=s++,i.VARIATION_SELECTORS=s++,i.VARIATION_SELECTORS_SUPPLEMENT=s++,i.VEDIC_EXTENSIONS=s++,i.VERTICAL_FORMS=s++,i.YI_RADICALS=s++,i.YI_SYLLABLES=s++,i.YIJING_HEXAGRAM_SYMBOLS=s++,i.blockStarts=[0,128,256,384,592,688,768,880,1024,1280,1328,1424,1536,1792,1872,1920,1984,2048,2112,2144,2208,2304,2432,2560,2688,2816,2944,3072,3200,3328,3456,3584,3712,3840,4096,4256,4352,4608,4992,5024,5120,5760,5792,5888,5920,5952,5984,6016,6144,6320,6400,6480,6528,6624,6656,6688,6832,6912,7040,7104,7168,7248,7296,7360,7376,7424,7552,7616,7680,7936,8192,8304,8352,8400,8448,8528,8592,8704,8960,9216,9280,9312,9472,9600,9632,9728,9984,10176,10224,10240,10496,10624,10752,11008,11264,11360,11392,11520,11568,11648,11744,11776,11904,12032,12256,12272,12288,12352,12448,12544,12592,12688,12704,12736,12784,12800,13056,13312,19904,19968,40960,42128,42192,42240,42560,42656,42752,42784,43008,43056,43072,43136,43232,43264,43312,43360,43392,43488,43520,43616,43648,43744,43776,43824,43968,44032,55216,55296,56192,56320,57344,63744,64256,64336,65024,65040,65056,65072,65104,65136,65280,65520,65536,65664,65792,65856,65936,66e3,66048,66176,66208,66272,66304,66352,66384,66432,66464,66528,66560,66640,66688,66736,67584,67648,67680,67840,67872,67904,67968,68e3,68096,68192,68224,68352,68416,68448,68480,68608,68688,69216,69248,69632,69760,69840,69888,69968,70016,70112,71296,71376,73728,74752,74880,77824,78896,92160,92736,93952,94112,110592,110848,118784,119040,119296,119376,119552,119648,119680,119808,120832,126464,126720,126976,127024,127136,127232,127488,127744,128512,128592,128640,128768,128896,131072,173792,173824,177984,178208,194560,195104,917504,917632,917760,918e3,983040,1048576],i.blocks=[i.BASIC_LATIN,i.LATIN_1_SUPPLEMENT,i.LATIN_EXTENDED_A,i.LATIN_EXTENDED_B,i.IPA_EXTENSIONS,i.SPACING_MODIFIER_LETTERS,i.COMBINING_DIACRITICAL_MARKS,i.GREEK,i.CYRILLIC,i.CYRILLIC_SUPPLEMENTARY,i.ARMENIAN,i.HEBREW,i.ARABIC,i.SYRIAC,i.ARABIC_SUPPLEMENT,i.THAANA,i.NKO,i.SAMARITAN,i.MANDAIC,0,i.ARABIC_EXTENDED_A,i.DEVANAGARI,i.BENGALI,i.GURMUKHI,i.GUJARATI,i.ORIYA,i.TAMIL,i.TELUGU,i.KANNADA,i.MALAYALAM,i.SINHALA,i.THAI,i.LAO,i.TIBETAN,i.MYANMAR,i.GEORGIAN,i.HANGUL_JAMO,i.ETHIOPIC,i.ETHIOPIC_SUPPLEMENT,i.CHEROKEE,i.UNIFIED_CANADIAN_ABORIGINAL_SYLLABICS,i.OGHAM,i.RUNIC,i.TAGALOG,i.HANUNOO,i.BUHID,i.TAGBANWA,i.KHMER,i.MONGOLIAN,i.UNIFIED_CANADIAN_ABORIGINAL_SYLLABICS_EXTENDED,i.LIMBU,i.TAI_LE,i.NEW_TAI_LUE,i.KHMER_SYMBOLS,i.BUGINESE,i.TAI_THAM,0,i.BALINESE,i.SUNDANESE,i.BATAK,i.LEPCHA,i.OL_CHIKI,0,i.SUNDANESE_SUPPLEMENT,i.VEDIC_EXTENSIONS,i.PHONETIC_EXTENSIONS,i.PHONETIC_EXTENSIONS_SUPPLEMENT,i.COMBINING_DIACRITICAL_MARKS_SUPPLEMENT,i.LATIN_EXTENDED_ADDITIONAL,i.GREEK_EXTENDED,i.GENERAL_PUNCTUATION,i.SUPERSCRIPTS_AND_SUBSCRIPTS,i.CURRENCY_SYMBOLS,i.COMBINING_MARKS_FOR_SYMBOLS,i.LETTERLIKE_SYMBOLS,i.NUMBER_FORMS,i.ARROWS,i.MATHEMATICAL_OPERATORS,i.MISCELLANEOUS_TECHNICAL,i.CONTROL_PICTURES,i.OPTICAL_CHARACTER_RECOGNITION,i.ENCLOSED_ALPHANUMERICS,i.BOX_DRAWING,i.BLOCK_ELEMENTS,i.GEOMETRIC_SHAPES,i.MISCELLANEOUS_SYMBOLS,i.DINGBATS,i.MISCELLANEOUS_MATHEMATICAL_SYMBOLS_A,i.SUPPLEMENTAL_ARROWS_A,i.BRAILLE_PATTERNS,i.SUPPLEMENTAL_ARROWS_B,i.MISCELLANEOUS_MATHEMATICAL_SYMBOLS_B,i.SUPPLEMENTAL_MATHEMATICAL_OPERATORS,i.MISCELLANEOUS_SYMBOLS_AND_ARROWS,i.GLAGOLITIC,i.LATIN_EXTENDED_C,i.COPTIC,i.GEORGIAN_SUPPLEMENT,i.TIFINAGH,i.ETHIOPIC_EXTENDED,i.CYRILLIC_EXTENDED_A,i.SUPPLEMENTAL_PUNCTUATION,i.CJK_RADICALS_SUPPLEMENT,i.KANGXI_RADICALS,0,i.IDEOGRAPHIC_DESCRIPTION_CHARACTERS,i.CJK_SYMBOLS_AND_PUNCTUATION,i.HIRAGANA,i.KATAKANA,i.BOPOMOFO,i.HANGUL_COMPATIBILITY_JAMO,i.KANBUN,i.BOPOMOFO_EXTENDED,i.CJK_STROKES,i.KATAKANA_PHONETIC_EXTENSIONS,i.ENCLOSED_CJK_LETTERS_AND_MONTHS,i.CJK_COMPATIBILITY,i.CJK_UNIFIED_IDEOGRAPHS_EXTENSION_A,i.YIJING_HEXAGRAM_SYMBOLS,i.CJK_UNIFIED_IDEOGRAPHS,i.YI_SYLLABLES,i.YI_RADICALS,i.LISU,i.VAI,i.CYRILLIC_EXTENDED_B,i.BAMUM,i.MODIFIER_TONE_LETTERS,i.LATIN_EXTENDED_D,i.SYLOTI_NAGRI,i.COMMON_INDIC_NUMBER_FORMS,i.PHAGS_PA,i.SAURASHTRA,i.DEVANAGARI_EXTENDED,i.KAYAH_LI,i.REJANG,i.HANGUL_JAMO_EXTENDED_A,i.JAVANESE,0,i.CHAM,i.MYANMAR_EXTENDED_A,i.TAI_VIET,i.MEETEI_MAYEK_EXTENSIONS,i.ETHIOPIC_EXTENDED_A,0,i.MEETEI_MAYEK,i.HANGUL_SYLLABLES,i.HANGUL_JAMO_EXTENDED_B,i.HIGH_SURROGATES,i.HIGH_PRIVATE_USE_SURROGATES,i.LOW_SURROGATES,i.PRIVATE_USE_AREA,i.CJK_COMPATIBILITY_IDEOGRAPHS,i.ALPHABETIC_PRESENTATION_FORMS,i.ARABIC_PRESENTATION_FORMS_A,i.VARIATION_SELECTORS,i.VERTICAL_FORMS,i.COMBINING_HALF_MARKS,i.CJK_COMPATIBILITY_FORMS,i.SMALL_FORM_VARIANTS,i.ARABIC_PRESENTATION_FORMS_B,i.HALFWIDTH_AND_FULLWIDTH_FORMS,i.SPECIALS,i.LINEAR_B_SYLLABARY,i.LINEAR_B_IDEOGRAMS,i.AEGEAN_NUMBERS,i.ANCIENT_GREEK_NUMBERS,i.ANCIENT_SYMBOLS,i.PHAISTOS_DISC,0,i.LYCIAN,i.CARIAN,0,i.OLD_ITALIC,i.GOTHIC,0,i.UGARITIC,i.OLD_PERSIAN,0,i.DESERET,i.SHAVIAN,i.OSMANYA,0,i.CYPRIOT_SYLLABARY,i.IMPERIAL_ARAMAIC,0,i.PHOENICIAN,i.LYDIAN,0,i.MEROITIC_HIEROGLYPHS,i.MEROITIC_CURSIVE,i.KHAROSHTHI,i.OLD_SOUTH_ARABIAN,0,i.AVESTAN,i.INSCRIPTIONAL_PARTHIAN,i.INSCRIPTIONAL_PAHLAVI,0,i.OLD_TURKIC,0,i.RUMI_NUMERAL_SYMBOLS,0,i.BRAHMI,i.KAITHI,i.SORA_SOMPENG,i.CHAKMA,0,i.SHARADA,0,i.TAKRI,0,i.CUNEIFORM,i.CUNEIFORM_NUMBERS_AND_PUNCTUATION,0,i.EGYPTIAN_HIEROGLYPHS,0,i.BAMUM_SUPPLEMENT,0,i.MIAO,0,i.KANA_SUPPLEMENT,0,i.BYZANTINE_MUSICAL_SYMBOLS,i.MUSICAL_SYMBOLS,i.ANCIENT_GREEK_MUSICAL_NOTATION,0,i.TAI_XUAN_JING_SYMBOLS,i.COUNTING_ROD_NUMERALS,0,i.MATHEMATICAL_ALPHANUMERIC_SYMBOLS,0,i.ARABIC_MATHEMATICAL_ALPHABETIC_SYMBOLS,0,i.MAHJONG_TILES,i.DOMINO_TILES,i.PLAYING_CARDS,i.ENCLOSED_ALPHANUMERIC_SUPPLEMENT,i.ENCLOSED_IDEOGRAPHIC_SUPPLEMENT,i.MISCELLANEOUS_SYMBOLS_AND_PICTOGRAPHS,i.EMOTICONS,0,i.TRANSPORT_AND_MAP_SYMBOLS,i.ALCHEMICAL_SYMBOLS,0,i.CJK_UNIFIED_IDEOGRAPHS_EXTENSION_B,0,i.CJK_UNIFIED_IDEOGRAPHS_EXTENSION_C,i.CJK_UNIFIED_IDEOGRAPHS_EXTENSION_D,0,i.CJK_COMPATIBILITY_IDEOGRAPHS_SUPPLEMENT,0,i.TAGS,0,i.VARIATION_SELECTORS_SUPPLEMENT,0,i.SUPPLEMENTARY_PRIVATE_USE_AREA_A,i.SUPPLEMENTARY_PRIVATE_USE_AREA_B];var o=com.qici.richText.RichTextSymbol=function(e){var t=this;t.game=e,t._symbols={},t._drawStyles={},t._emoji={},t.resetToSystemSymbol()};o.prototype={},o.prototype.constructor=o,o.prototype.registerSymbol=function(e,t){var n=this;n.unregisterSymbol(e,t);var r=n._symbols[e];r?(r.history.push(r.inEffect),r.inEffect=t):(r={history:[],inEffect:t},n._symbols[e]=r)},o.prototype.unregisterSymbol=function(e,t){var n=this,r=n._symbols[e];if(!r)return;if(r.inEffect===t)r.inEffect=r.history.pop();else{var i=r.history.length;while(i--)r.history[i]===t&&r.splice(i,1)}},o.prototype.getSymbolStyle=function(e,t){var n=this,r=n._symbols[e];return!r||!r.inEffect?null:r.inEffect(e,t)},o.prototype.registerDrawStyle=function(e,t){var n=this;n.unregisterDrawStyle(e,t);var r=n._drawStyles[e];r?(r.history.push(r.inEffect),r.inEffect=t):(r={history:[],inEffect:t},n._drawStyles[e]=r)},o.prototype.unregisterDrawStyle=function(e,t){var n=this,r=n._drawStyles[e];if(!r)return;if(r.inEffect===t)r.inEffect=r.history.pop();else{var i=r.history.length;while(i--)r.history[i]===t&&r.splice(i,1)}},o.prototype.registerEmoji=function(e,t){var n=this;n.unregisterEmoji(e,t);var r=n._emoji[e];r||(r=[],n._emoji[e]=r),r.push(t)},o.prototype.unregisterEmoji=function(e,t){var n=this,r=n._emoji[e];if(!r)return;var i=r.length;while(i--)r[i]===t&&r.splice(i,1)},o.prototype.findEmojiAtlas=function(e,t){var n=this,r=n._emoji[e];if(!r)return null;var i=-1,s=r.length;if(!t)return r[0];while(++i<s){var o=-1,u=r[i].atlas.frameNames,a=u.length;while(++o<a)if(u[o]===t)return r[i].atlas}return null},o.prototype.getDrawStyle=function(e){var t=this,n=t._drawStyles[e];return!n||!n.inEffect?null:n.inEffect},o.doPostDrawText=function(e,t,n,r,i){var s=e.fillStyle,o=t.style,u,a;o.underline&&(o.underlineColor&&(e.fillStyle=o.underlineColor),u=t.elementRects[n].rect,a=t.isFirstBlockInLine&&n===0?0:o.charSpace+t.line.elementSpace,e.fillRect(r+u.x-a,Math.floor(i+u.height-1),u.width+a,1),e.fillStyle=s),o.strikethrough&&(o.strikethroughColor&&(e.fillStyle=o.strikethroughColor),u=t.elementRects[n].rect,a=t.isFirstBlockInLine&&n===0?0:o.charSpace+t.line.elementSpace,e.fillRect(r+u.x-a,Math.floor(i+(u.height-1)/2),u.width+a,1),e.fillStyle=s)},o.fillText=function(e,t,n,r,i){e.fillStyle=t.style.fontColor,e.textBaseline="middle";var s=t.elementRects[n].rect;e.fillText(t.elements[n],r+s.x,i+s.y+s.height/2)},o.strokeText=function(e,t,n,r,i){e.strokeStyle=t.style.fontColor,e.textBaseline="middle";var s=t.elementRects[n].rect;e.strokeText(t.elements[n],r+s.x,i+s.y+s.height/2)},o.prototype.resetToSystemSymbol=function(){var e=this;e._symbols={},e._drawStyle={},e.registerDrawStyle("fill",o.fillText),e.registerDrawStyle("stroke",o.strokeText),e.registerSymbol("color",function(e,t,n){return{fontColor:t.value}}),e.registerSymbol("size",function(e,t,n){return{fontSize:parseInt(t.value)}}),e.registerSymbol("text-align",function(e,t,n){return{textAlign:t.value}}),e.registerSymbol("vertical-align",function(e,t,n){return{verticalAlign:t.value}}),e.registerSymbol("b",function(e,t,n){return{fontWeight:"bold"}}),e.registerSymbol("i",function(e,t,n){return{fontStyle:"italic"}}),e.registerSymbol("underline",function(e,t,n){var r={underline:!0,underlineColor:t.color,postDrawElementHandle:o.doPostDrawText};return r}),e.registerSymbol("strikethrough",function(e,t,n){var r={strikethrough:!0,strikethroughColor:t.color,postDrawElementHandle:o.doPostDrawText};return r}),e.registerSymbol("click",function(e,t,n){var r={onClickHandle:function(e,n,r,i){var s=t.value;e&&e._sendMessage?e._sendMessage(s,!0,n.elements.join(""),r,i):e&&typeof e[s]=="function"&&e[s].call(e,n.elements.join(""),r,i)}};return r}),e.registerSymbol("stroke",function(e,t,n){return{drawStyle:"stroke"}}),e.registerSymbol("linespace",function(e,t,n){return{lineSpace:parseInt(t.value)}}),e.registerSymbol("charspace",function(e,t,n){return{charSpace:parseInt(t.value)}}),e.registerSymbol("lineweight",function(e,t,n){return{lineWeight:parseInt(t.value)}}),e.registerSymbol("image",function(t,n,r){var i=n.package,s=n.frame,o=e.findEmojiAtlas(i,s);if(!o)return null;var a=new Phaser.Sprite(e.game.phaser);return a.loadTexture(o.key,s),n.width&&(a.texture.frame.width=parseInt(n.width)),n.height&&(a.texture.frame.height=parseInt(n.height)),{onEnable:function(e){var t=new u(s);return t.type=u.BLOCK,t.sprite=a,[t]},measureHandle:function(e,t,n){var r=n.sprite;return{x:0,y:0,width:r?r.width:0,height:r?r.height:0}},drawElementHandle:function(e,t,n,r,i){var s=t.elements[n].sprite;if(!s)return;var o=s.texture.baseTexture.resolution;e.drawImage(s.texture.baseTexture.source,s.texture.crop.x,s.texture.crop.y,s.texture.crop.width,s.texture.crop.height,r,i,s.texture.frame.width/o,s.texture.frame.height/o)}}})};var u=com.qici.richText.RichTextChunk=function(e){var t=this;t.type=u.TEXT,t.tag="text",t.parent=null,t.source=e,t.attributes={},t.subs=[],t.inner={source:e,start:0,end:e.length,toString:function(){return this.source.substring(this.start,this.end)}},t.outer={source:e,start:0,end:e.length,toString:function(){return this.source.substring(this.start,this.end)}}};u.prototype={},u.prototype.constructor=u,u.TEXT=0,u.BLOCK=1,u.SYMBOL=2;var a=com.qici.richText.RichTextAttributeParse=function(e){var t=this;t.text=e,t.idx=0};a.prototype={},a.prototype.constructor=a,a.prototype.reset=function(){this.idx=0},a.prototype.nextWord=function(){var e=this.text,t=e.length,n=e[this.idx],r=n===" "||n==="	";if(r)do n=e[++this.idx];while(n===" "||n==="	");if(this.idx>=t)return null;if(n==="="){do n=e[++this.idx];while(n===" "||n==="	");return"="}if(r)return" ";var i=[];do{if(n==="\\")this.idx<t-1&&i.push(e[++this.idx]);else if(n==="'"||n==='"'){var s=e[++this.idx];do{if(s==="\\")this.idx<t-1&&i.push(e[++this.idx]);else{if(s===n)break;i.push(s)}s=e[++this.idx]}while(this.idx<t)}else{if(n===" "||n==="	"||n==="=")break;i.push(n)}n=e[++this.idx]}while(this.idx<t);return i.join("")};var f=com.qici.richText.RichTextParse=function(e){this.source=e,this._reset()};f.prototype={},f.prototype.constructor=f,f.parse=function(e){var t=f._instance||(f._instance=new f(""));return t.source=e,t.parse()},f.prototype._reset=function(){var e=this;e._idx=0,e._len=e.source.length,e._lastChunk=null,e.chunks=[]},f.prototype._next=function(){var e=this,t=e.source,n=e._idx,r=e._len;if(n>=r)return null;var i=!1,s=t[n]==="[",o=r;while(!i&&++e._idx<r)switch(t[e._idx]){case"]":e._idx++,i=!0;break;case"[":i=!0,s=!1;break;case" ":case"=":o=Math.min(o,e._idx)}var u={start:n,end:e._idx,isSymbol:i&&s,attributes:{}};if(u.isSymbol){u.selfClose=t[u.end-2]==="/",u.isClose=t[u.start+1]==="/";var f=t.substring(u.start+(u.isClose?2:1),u.end-(u.selfClose?2:1)),l=new a(f),c,h,p;c=l.nextWord()||"",h=c&&l.nextWord(),p=h==="="?l.nextWord():!0,u.key=c.toLowerCase(),u.attributes.value=p;do c=l.nextWord(),c===" "&&(c=l.nextWord()),h=c&&l.nextWord(),p=h==="="?l.nextWord():!0,c&&(u.attributes[c.toLowerCase()]=p);while(c)}return u},f.prototype._parseNextChunk=function(){var e=this,t=e.source,n=e._next(),r=e._lastChunk;if(!n)return!1;var i=new u(t);if(!n.isSymbol)i.type=u.TEXT,i.tag="text",i.outer.start=i.inner.start=n.start,i.outer.end=i.inner.end=n.end,i.close=!0;else if(n.isClose){while(r&&r.tag!==n.key)r=r.parent;r?(r.close=!0,r.outer.end=n.end,r.inner.end=n.start,i=null):(r=e._lastChunk,i.type=u.TEXT,i.tag="text",i.outer.start=i.inner.start=n.start,i.outer.end=i.inner.end=n.end,i.close=!0)}else n.selfClose?(i.type=u.SYMBOL,i.tag=n.key,i.outer.start=n.start,i.outer.end=n.end,i.inner.start=i.inner.end=n.start,i.close=!0,i.attributes=n.attributes):(i.type=u.SYMBOL,i.tag=n.key,i.outer.start=n.start,i.inner.start=n.end,i.close=!1,i.attributes=n.attributes);while(r&&r.close)r=r.parent;return i?(r?(r.subs.push(i),i.parent=r):e.chunks.push(i),e._lastChunk=i,!0):(e._lastChunk=r,!0)},f.prototype.parse=function(){var e=this;e._reset();while(e._parseNextChunk());return e.chunks};var l=com.qici.richText.RichTextBlock=function(e,t){var n=this;n.line=e,n.isClosed=!1,n.style=t,n.elements=[],n.elementRects=[],n.type=0,n.isFirstBlockInLine=!1,n.rect={x:0,y:0,width:0,height:0},n.margin={left:0,right:0,top:0,bottom:0},n.elementCount=0};l.prototype={},l.prototype.constructor=l,l.prototype.close=function(){var e=this;if(e.isClosed)return;e.isClosed=!0,e.line._appendLayout(e)},l.prototype.appendElement=function(e,t,n,r,i,s,o,u,a,f){var l=this;l.elements.push(e),l.elementCount+=t,l.line.elementCount+=t;var c={rect:{x:n,y:r,width:i,height:s},margin:{left:o,right:u,top:a,bottom:f}};l.elementRects.push(c),l._appendLayout(c.rect,c.margin)},l.prototype._appendLayout=function(e,t){var n=this,r=n.rect.x,i=n.rect.y,s=r+n.rect.width,o=i+n.rect.height,u=r-n.margin.left,a=i-n.margin.top,f=s+n.margin.right,l=o+n.margin.left,c=n.line.section.charStep,h=s===r&&o===i?0:n.line.elementSpace+n.style.charSpace,p=(s+h)*c.width+e.x,d=(o+h)*c.height+e.y,v=p+e.width,m=d+e.height;n.rect.x=Math.min(r,p),n.rect.y=Math.min(i,d),n.rect.width=Math.max(s,v)-n.rect.x,n.rect.height=Math.max(o,m)-n.rect.y,u=Math.min(u,p-t.left),a=Math.min(a,d-t.top),f=Math.max(f,v+t.right),l=Math.max(l,m+t.bottom),n.margin.left=Math.max(0,n.rect.x-u),n.margin.right=Math.max(0,f-n.rect.x-n.rect.width),n.margin.top=Math.max(0,n.rect.y-a),n.margin.bottom=Math.max(0,l-n.rect.y-n.rect.height)},l.prototype.relayout=function(){var e=this;e.rect.x=e.rect.y=e.rect.width=e.rect.height=0,e.margin.left=e.margin.right=e.margin.top=e.margin.bottom=0;var t=-1,n=e.elementRects.length;while(++t<n){var r=e.elementRects[t];e._appendLayout(r.rect,r.margin)}};var c=com.qici.richText.RichTextLine=function(e){var t=this;t.section=e,t.isClosed=!1,t.blocks=[],t.rect={x:0,y:0,width:0,height:0},t.margin={left:0,right:0,top:0,bottom:0},t.offset=0,t.styles=[t.section.getCurrStyle()],t.elementCount=0,t.elementSpace=0};c.prototype={},c.prototype.constructor=c,c.prototype.close=function(){var e=this;if(e.isClosed)return;e.isClosed=!0,e.closeLastBlock();var t=e.styles[e.styles.length-1],n=e.remainSpace(),r=t.textAlign;e.rect.height+=Math.max(0,t.getFontHeight()-e.rect.height-e.rect.y);if(r==="end")e.offset=n,e.elementSpace=0;else if(r==="center")e.offset=n/2,e.elementSpace=0;else if(r==="justify"){e.offset=0,e.elementCount<2?e.elementSpace=0:e.elementSpace=n/(e.elementCount-1),e.rect.x=e.rect.y=e.rect.width=e.rect.height=0,e.margin.left=e.margin.right=e.margin.top=e.margin.bottom=0;var i=-1,s=e.blocks.length;while(++i<s){var o=e.blocks[i];o.relayout(),e._appendLayout(o)}}else e.offset=0,e.elementSpace=0;e.lineSpace=t.lineSpace,t.lineWeight&&(e.section.lineStep.height?e.lineSpace+=t.lineWeight-e.rect.height:e.section.lineStep.width&&(e.lineSpace+=t.lineWeight-e.rect.width)),e.section._appendLayout(e.rect,e.margin,e.lineSpace)},c.prototype.closeLastBlock=function(){var e=this,t=e.getLastBlock();if(!t||t.isClosed)return;t.close()},c.prototype.getLastBlock=function(){var e=this,t=e.blocks.length;return t<1?null:e.blocks[t-1]},c.prototype.getCurrBlock=function(){var e=this,t=e.getLastBlock();if(!t||t.isClosed)t=new l(this,e.section.getCurrStyle()),t.isFirstBlockInLine=e.blocks.length===0,e.blocks.push(t);return t},c.prototype._appendLayout=function(e){var t=this,n=e.rect,r=e.margin,i=t.rect.x,s=t.rect.y,o=i+t.rect.width,u=s+t.rect.height,a=i-t.margin.left,f=s-t.margin.top,l=o+t.margin.right,c=u+t.margin.left,h=t.section.charStep,p=o===i&&u===s?0:t.elementSpace+e.style.charSpace,d=(o+p)*h.width+n.x,v=(u+p)*h.height+n.y,m=d+n.width,g=v+n.height;t.rect.x=Math.min(i,d),t.rect.y=Math.min(s,v),t.rect.width=Math.max(o,m)-t.rect.x,t.rect.height=Math.max(u,g)-t.rect.y,a=Math.min(a,d-r.left),f=Math.min(f,v-r.top),l=Math.max(l,m+r.right),c=Math.max(c,g+r.bottom),t.margin.left=Math.max(0,t.rect.x-a),t.margin.right=Math.max(0,l-t.rect.x-t.rect.width),t.margin.top=Math.max(0,t.rect.y-f),t.margin.bottom=Math.max(0,c-t.rect.y-t.rect.height)},c.prototype.remainSpace=function(){var e=this,t=e.getLastBlock(),n=e.section.limitLength-(e.rect.width+e.rect.x)*e.section.charStep.width-(e.rect.height+e.rect.y)*e.section.charStep.height;return t&&!t.isClosed&&(n-=(e.blocks.length>1?t.style.charSpace:0)+(t.rect.width+t.rect.x)*e.section.charStep.width+(t.rect.height+t.rect.y)*e.section.charStep.height),n};var h=com.qici.richText.RichTextSection=function(e,t,n,r){var i=this;i.lines=[],i.limitLength=e,i.breakStyle=t,i.rect={x:0,y:0,width:0,height:0},i.margin={left:0,right:0,top:0,bottom:0},i._styles=[],i.defaultStyle=n,i.lineSpaces=[],i.charOrder=r||0,i.clickHandleContext=null,i.calcStep()};h.prototype={},h.prototype.constructor=h,h.prototype.reset=function(){var e=this;e.lines=[],e._styles=[],e.rect={x:0,y:0,width:0,height:0},e.margin={left:0,right:0,top:0,bottom:0}},h.prototype.closeLastLine=function(){var e=this,t=e.getLastLine();if(!t||t.isClosed)return;t.close()},h.prototype.getLastLine=function(){var e=this,t=e.lines.length;return t<1?null:e.lines[t-1]},h.prototype.getLastBlock=function(){var e=this,t=e.getLastLine();return t?t.getLastBlock():null},h.prototype.getCurrLine=function(){var e=this,t=e.getLastLine();if(!t||t.isClosed)t=new c(this),e.lines.push(t);return t},h.prototype.getCurrBlock=function(){var e=this,t=e.getCurrLine();return t.getCurrBlock()},h.prototype.getCurrStyle=function(){var e=this,t=e._styles.length;return t<1?e.defaultStyle:e._styles[t-1]},h.prototype.pushStyle=function(e){var t=this,n=t.getLastLine(),r=t.getLastBlock();r&&!r.isClosed&&r.close(),n&&!n.isClosed&&n.styles.push(e),t._styles.push(e)},h.prototype.popStyle=function(){var e=this,t=e.getLastBlock();t&&!t.isClosed&&t.close();var n=e._styles.pop();return n||(n=e.defaultStyle),n},h.prototype.calcStep=function(){var e=this,t=(e.charOrder&15)!==0;switch((e.charOrder&240)>>>4){case 1:e.charStep={x:-1,y:0,width:1,height:0,xRatio:-1,yRatio:0},e.lineStep={x:0,y:t?-1:1,width:0,height:1,xRatio:0,yRatio:t?-1:0};break;case 2:e.charStep={x:0,y:1,width:0,height:1,xRatio:0,yRatio:0},e.lineStep={x:t?-1:1,y:0,width:1,height:0,xRatio:t?-1:0,yRatio:0};break;case 3:e.charStep={x:0,y:-1,width:0,height:1,xRatio:0,yRatio:-1},e.lineStep={x:t?-1:1,y:0,width:1,height:0,xRatio:t?-1:0,yRatio:0};break;default:e.charStep={x:1,y:0,width:1,height:0,xRatio:0,yRatio:0},e.lineStep={x:0,y:t?-1:1,width:0,height:1,xRatio:0,yRatio:t?-1:0}}},h.prototype.appendElement=function(e,t,n,r,i,s,o,u,a,f,l){var c=this,h=c.getLastBlock();if(!h||h.type!==e||h.isClosed)h&&h.close(),h=c.getCurrBlock(),h.type=e;h.appendElement(t,n,r,i,s,o,u,a,f,l)},h.prototype._appendLayout=function(e,t,n){var r=this,i=r.rect.x,s=r.rect.y,o=i+r.rect.width,u=s+r.rect.height,a=i-r.margin.left,f=s-r.margin.top,l=o+r.margin.right,c=u+r.margin.left,h=r.lineStep;h.height?o=r.limitLength:h.width&&(u=r.limitLength);var p=r.lineSpaces[r.lineSpaces.length-1]||0,d=(o+p)*h.width+e.x,v=(u+p)*h.height+e.y,m=d+e.width,g=v+e.height;r.rect.x=Math.min(i,d),r.rect.y=Math.min(s,v),r.rect.width=Math.max(o,m)-r.rect.x,r.rect.height=Math.max(u,g)-r.rect.y,a=Math.min(a,d-t.left),f=Math.min(f,v-t.top),l=Math.max(l,m+t.right),c=Math.max(c,g+t.bottom),r.margin.left=Math.max(0,r.rect.x-a),r.margin.right=Math.max(0,l-r.rect.x-r.rect.width),r.margin.top=Math.max(0,r.rect.y-f),r.margin.bottom=Math.max(0,c-r.rect.y-r.rect.height),r.lineSpaces.push(n)},h.prototype._buildLines=function(e,t,n){if(!t||t.length===0)return;var r=this,i=r.getCurrStyle(),s=-1,o=t.length,a,f;while(++s<o){var l=t[s];l.type===u.SYMBOL&&(a=n.getSymbolStyle(l.tag,l.attributes,i))?(i=i.mixin(a),r.pushStyle(i),a.onEnable&&(f=a.onEnable(r),f&&r._buildLines(e,f,n)),r._buildLines(e,l.subs,n),a.onDisable&&(f=a.onDisable(r),f&&r._buildLines(e,f,n)),r.popStyle(),i=r.getCurrStyle()):p.wrapChunk(r,e,r.breakStyle,l)}},h.prototype.build=function(e,t){var n=this,r=n.defaultStyle.symbol;n.reset(),n._buildLines(e,t,r),n.closeLastLine()},h.prototype.append=function(e,t,n){var r=this,i=r.defaultStyle.symbol;r._buildLines(e,t,i),n&&r.closeLastLine()},h.prototype.contains=function(e,t,n){return e.width<=0||e.height<=0?!1:t>=e.x&&t<e.x+e.width&&n>=e.y&&n<e.y+e.height},h.prototype.onClick=function(e,t){var n=this,r=n.lines,i=n.lineStep,s=n.charStep,o=-i.xRatio*(n.rect.width+n.rect.x),u=-i.yRatio*(n.rect.height+n.rect.y),a=o,f=u,l,c,h,p,d,v,m,g,y,b,w;for(l=0;l<r.length;++l){c=r[l],h=n.lineSpaces[l],g=c.elementSpace,p=c.blocks,o+=i.xRatio*c.rect.width,u+=i.yRatio*c.rect.height,a=o-s.xRatio*n.limitLength+s.x*c.offset,f=u-s.yRatio*n.limitLength+s.y*c.offset;if(i.width&&e>=a&&e<=a+c.rect.width||i.height&&t>=f&&t<=f+c.rect.height)for(d=0;d<p.length;++d){v=p[d],a+=s.xRatio*v.rect.width+s.x*(d===0?0:v.style.charSpace),f+=s.yRatio*v.rect.height+s.y*(d===0?0:v.style.charSpace);if(n.contains(v.rect,e-a,t-f)){v.style&&v.style.onClick(n.clickHandleContext,v,e,t);return}a+=s.x*((1+s.xRatio)*v.rect.width+g*(v.elementCount-1)),f+=s.y*((1+s.yRatio)*v.rect.height+g*(v.elementCount-1))}o+=i.x*((1+i.xRatio)*c.rect.width+c.lineSpace),u+=i.y*((1+i.yRatio)*c.rect.height+c.lineSpace)}},h.prototype._loopElement=function(e,t,n,r){var i=this,s=i.lines,o=i.lineStep,u=i.charStep,a=t-o.xRatio*(i.rect.width+i.rect.x),f=n-o.yRatio*(i.rect.height+i.rect.y),l=a,c=f,h,p,d,v,m,g,y,b,w,E,S;for(h=0;h<s.length;++h){p=s[h],d=i.lineSpaces[h],b=p.elementSpace,v=p.blocks,a+=o.xRatio*p.rect.width,f+=o.yRatio*p.rect.height,l=a-u.xRatio*i.limitLength+u.x*p.offset,c=f-u.yRatio*i.limitLength+u.y*p.offset;for(m=0;m<v.length;++m){g=v[m];if(g&&g.style){w=-1,E=g.elements.length;while(++w<E)S=g.elementRects[w],l+=u.xRatio*S.rect.width+u.x*(m===0&&w===0?0:g.style.charSpace),c+=u.yRatio*S.rect.height+u.y*(m===0&&w===0?0:g.style.charSpace),r(e,g,w,l,c),l+=u.x*((1+u.xRatio)*S.rect.width+b),c+=u.y*((1+u.yRatio)*S.rect.height+b)}}a+=o.x*((1+o.xRatio)*p.rect.width+p.lineSpace),f+=o.y*((1+o.yRatio)*p.rect.height+p.lineSpace)}},h.prototype._doPreDrawElement=function(e,t,n,r,i){t.style&&t.style.preDraw(e,t,n,r,i)},h.prototype._doDrawElement=function(e,t,n,r,i){t.style&&t.style.drawElement(e,t,n,r,i)},h.prototype._doPostDrawElement=function(e,t,n,r,i){t.style&&t.style.postDraw(e,t,n,r,i)},h.prototype.render=function(e,t,n){var r=this;r._loopElement(e,t,n,r._doPreDrawElement),r._loopElement(e,t,n,r._doDrawElement),r._loopElement(e,t,n,r._doPostDrawElement)},h.LTR_TTB=0,h.LTR_BTT=1,h.RTL_TTB=16,h.RTL_BTT=17,h.TTB_LTR=32,h.TTB_RTL=33,h.BTT_LTR=48,h.BTT_RTL=49;var p=com.qici.richText.RichTextWrap={};p.BREAK_NORMAL=0,p.BREAK_BREAKALL=1,p.BREAK_KEEPALL=2,p.SP_NORMAL=0,p.SP_PREFIX=1,p.SP_SUFFIX=2,p.CJK_SP=[p.SP_SUFFIX,p.SP_SUFFIX,p.SP_SUFFIX,p.SP_SUFFIX,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_PREFIX,p.SP_SUFFIX,p.SP_PREFIX,p.SP_SUFFIX,p.SP_PREFIX,p.SP_SUFFIX,p.SP_PREFIX,p.SP_SUFFIX,p.SP_PREFIX,p.SP_SUFFIX,p.SP_NORMAL,p.SP_NORMAL,p.SP_PREFIX,p.SP_SUFFIX,p.SP_PREFIX,p.SP_SUFFIX,p.SP_PREFIX,p.SP_SUFFIX,p.SP_PREFIX,p.SP_SUFFIX,p.SP_SUFFIX,p.SP_PREFIX,p.SP_SUFFIX,p.SP_SUFFIX,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_SUFFIX,p.SP_SUFFIX,p.SP_SUFFIX,p.SP_SUFFIX,p.SP_PREFIX,p.SP_SUFFIX,p.SP_SUFFIX,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL],p.HALF_FULL_FORMS=[p.SP_NORMAL,p.SP_SUFFIX,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_PREFIX,p.SP_SUFFIX,p.SP_NORMAL,p.SP_SUFFIX,p.SP_SUFFIX,p.SP_SUFFIX,p.SP_SUFFIX,p.SP_SUFFIX,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_SUFFIX,p.SP_SUFFIX,p.SP_SUFFIX,p.SP_SUFFIX,p.SP_SUFFIX,p.SP_SUFFIX,p.SP_SUFFIX,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_PREFIX,p.SP_NORMAL,p.SP_SUFFIX,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_PREFIX,p.SP_NORMAL,p.SP_SUFFIX,p.SP_NORMAL,p.SP_PREFIX,p.SP_SUFFIX,p.SP_SUFFIX,p.SP_PREFIX,p.SP_SUFFIX,p.SP_SUFFIX,p.SP_SUFFIX,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_SUFFIX,p.SP_SUFFIX,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL,p.SP_NORMAL],p.WORD_ELEMENT=0,p.WORD_STAND=1,p.WORD_PREFIX=2,p.WORD_SUFFIX=3,p.WORD_SPLIT=4,p.WORD_FORCE=5,p._isWordEnd=function(e,t){if(t>=e.length)return p.WORD_FORCE;var n=e[t];if(n==="\r"||n==="\n")return p.WORD_FORCE;if(n===" "||n==="	")return p.WORD_SPLIT;var r=i.of(n);if(r<i.CJK_START||r>i.CJK_END)return p.WORD_ELEMENT;if(r===i.CJK_SYMBOLS_AND_PUNCTUATION){var s=p.CJK_SP[n.charCodeAt(0)-12288];switch(s){case p.SP_NORMAL:return p.WORD_STAND;case p.SP_PREFIX:return p.WORD_PREFIX;case p.SP_SUFFIX:return p.WORD_SUFFIX}}else if(r===i.HALFWIDTH_AND_FULLWIDTH_FORMS){var o=p.HALF_FULL_FORMS[n.charCodeAt(0)-65280];switch(o){case p.SP_NORMAL:return p.WORD_STAND;case p.SP_PREFIX:return p.WORD_PREFIX;case p.SP_SUFFIX:return p.WORD_SUFFIX}}return p.WORD_STAND},p._nextWord=function(e,t){var n=e.length;if(n<=t)return!1;var r=e[t];if(r==="\r")return t+(e[t+1]==="\n"?2:1);if(r==="\n")return t+1;var i=p._isWordEnd(e,t),s=t+1,o=p._isWordEnd(e,s);if(i===p.WORD_PREFIX){while(o===p.WORD_PREFIX)i=o,o=p._isWordEnd(e,++s);if(o===p.WORD_ELEMENT||o===p.WORD_STAND||o===p.WORD_SUFFIX)i=o,o=p._isWordEnd(e,++s)}if(i===p.WORD_ELEMENT){while(o===p.WORD_ELEMENT)i=o,o=p._isWordEnd(e,++s);o===p.WORD_SUFFIX&&(i=o,o=p._isWordEnd(e,++s))}if(i===p.WORD_STAND||i===p.WORD_SUFFIX)while(o===p.WORD_SUFFIX)i=o,o=p._isWordEnd(e,++s);return s},p._nextBlockInNormal=function(e,t,n,r){var i=n.length;if(i<=r)return!1;var s=t.getCurrStyle(),o=t.getCurrLine(),u=o.remainSpace(),a=s.charSpace,f,l;for(var c=r;c<i;){var h=p._nextWord(n,c),d=n.substring(c,h);if(d==="\n"||d==="\r"||d==="\r\n")return c>r&&p._appendText(e,t,s,n,r,c),t.closeLastLine(),h;l=s.measureWord(e,d,t.charStep);var v=(l.x+l.width)*t.charStep.width+(l.y+l.height)*t.charStep.height+ +d.length*a;r===c&&o.elementCount===0&&(v-=a);if(!(v<u)){if(v>t.limitLength){c>r&&p._appendText(e,t,s,n,r,c);var m=0;do m=p._nextBlockInBreakAll(e,t,d,m);while(m);return h}return c>r&&p._appendText(e,t,s,n,r,c),t.closeLastLine(),d!==" "&&d!=="	"&&p._appendText(e,t,s,d,0,d.length),h}u-=v,c=h}return p._appendText(e,t,s,n,r,i),!1},p._nextBlockInBreakAll=function(e,t,n,r){var i=n.length;if(i<=r)return!1;var s=t.getCurrStyle(),o=t.getCurrLine(),u=o.remainSpace(),a=s.charSpace,f,l;for(var c=r;c<i;++c){var h=n[c];if(h==="\r")return c>r&&p._appendText(e,t,s,n,r,c),t.closeLastLine(),c+(n[c+1]==="\n"?2:1);if(h==="\n")return c>r&&p._appendText(e,t,s,n,r,c),t.closeLastLine(),c+1;l=s.measure(e,h);var d=(l.x+l.width)*t.charStep.width+(l.y+l.height)*t.charStep.height+ +a;r===c&&o.elementCount===0&&(d-=a);if(!(d<u))return c>r&&p._appendText(e,t,s,n,r,c),t.closeLastLine(),h!==" "&&h!=="	"&&p._appendText(e,t,s,h,0,1),c+1;u-=d}return p._appendText(e,t,s,n,r,i),!1},p._nextBlockInKeepAll=function(e,t,n,r){var i=n.length;if(i<=r)return!1;var s=t.getCurrStyle();for(var o=r;o<i;++o){var u=n[o];if(u==="\r")return o>r&&p._appendText(e,t,s,n,r,o),t.closeLastLine(),o+(n[o+1]==="\n"?2:1);if(u==="\n")return o>r&&p._appendText(e,t,s,n,r,o),t.closeLastLine(),o+1}return p._appendText(e,t,s,n,r,i),!1},p._wrapBlockInKeepAll=function(e,t,n,r){var i=t.getCurrStyle(),s=i.measure(e,n);return p._appendElement(t,n,s),!1},p._wrapBlockInNormal=function(e,t,n,r){var i=t.getCurrLine(),s=t.getCurrStyle(),o=s.measure(e,n),u=i.elementCount>0?s.charSpace:0,a=(o.x+o.width)*t.charStep.width+(o.y+o.height)*t.charStep.height+ +u;return i.remainSpace()<a&&i.close(),p._appendElement(t,n,o),!1},p._appendText=function(e,t,n,r,i,s){var o=n.measure(e,r[i]);p._appendElement(t,r[i],o);for(var u=i+1;u<s;++u)o=n.measure(e,r[u]),p._appendElement(t,r[u],o)},p._appendElement=function(e,t,n){e.appendElement(n.type||0,t,1,n.x||0,n.y||0,n.width||0,n.height||0,n.marginLeft||0,n.marginRight||0,n.marginTop||0,n.marginBottom||0)},p.wrapChunk=function(e,t,n,r){var i;if(r.type===u.BLOCK){i=n===p.BREAK_KEEPALL?p._wrapBlockInKeepAll:p._wrapBlockInNormal;var s=0;do s=i(t,e,r,s);while(s)}else{n===p.BREAK_KEEPALL?i=p._nextBlockInKeepAll:n===p.BREAK_BREAKALL?i=p._nextBlockInBreakAll:i=p._nextBlockInNormal;var o=r.inner.toString(),s=0;do s=i(t,e,o,s);while(s)}};var d=com.qici.richText.RichTextStyle=function(e,t){var n=this;n.symbol=e||new o,n._fontComponents={},n.cssFont=t,n.fontColor="rgb(0, 0, 0)",n.drawStyle="fill",n.textAlign="left",n.verticalAlign="bottom",n.lineSpace=0,n.charSpace=0,n.preDrawHandle=null,n.preDrawElementHandle=null,n.drawElementHandle=null,n.postDrawElementHandle=null,n.postDrawHandle=null,n.onClickHandle=null,n.measureHandle=null};d.prototype={},d.prototype.constuctor=d,t.defineProperties(d.prototype,{cssFont:{get:function(){return this._cssFont},set:function(e){e=e||"bold 20pt Arial",this._fontComponents=this._fontToComponents(e),this.refreshFont()}},font:{get:function(){return this._fontComponents.fontFamily},set:function(e){e=e||"Arial",e=e.trim(),!/^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(e)&&!/['",]/.exec(e)&&(e="'"+e+"'"),this._fontComponents.fontFamily=e,this.refreshFont()}},fontSize:{get:function(){var e=this._fontComponents.fontSize;return e&&/(?:^0$|px$)/.exec(e)?parseInt(e,10):e},set:function(e){e=e||"0",typeof e=="number"&&(e+="px"),this._fontComponents.fontSize=e,this.refreshFont()}},fontWeight:{get:function(){return this._fontComponents.fontWeight||"normal"},set:function(e){e=e||"normal",this._fontComponents.fontWeight=e,this.refreshFont()}},fontStyle:{get:function(){return this._fontComponents.fontStyle||"normal"},set:function(e){e=e||"normal",this._fontComponents.fontStyle=e,this.refreshFont()}},fontVariant:{get:function(){return this._fontComponents.fontVariant||"normal"},set:function(e){e=e||"normal",this._fontComponents.fontVariant=e,this.refreshFont()}}}),d.prototype.getFont=function(){var e=this;return e._cssFont},d.prototype.getFontHeight=function(){var e=this;return e._fontHeight},d.prototype.measureWord=function(e,t,n){var r=this;e.font=r.getFont();var i=0,s=0,o=0,u=0,a=-1,f=t.length,l,c;if(r.measureHandle)while(++a<f)l=r.measureHandle(e,r,t[a]),i=Math.min(i,l.x+o*n.width),s=Math.min(s,l.y+u*n.height),o=Math.max(o,l.x+o*n.width+l.width),u=Math.max(u,l.y+u*n.height+l.height);else while(++a<f)c=e.measureText(t[a]).width,o=Math.max(o,o*n.width+c),u=Math.max(u,u*n.height+r._fontHeight);return{x:i,y:s,width:o-i,height:u-s}},d.prototype.measure=function(e,t){var n=this,r;return e.font=n.getFont(),n.measureHandle?r=n.measureHandle(e,n,t):r={x:0,y:0,width:e.measureText(t).width,height:n._fontHeight},r},d.prototype.refreshFont=function(){var e=this;e._cssFont=e._componentsToFont(e._fontComponents),e._fontHeight=e._determineFontProperties().fontSize},d.prototype.mixin=function(e){var n=this,r=new d(n.symbol,n.cssFont),i=0,s=t.keys(n);for(i=0;i<s.length;++i){if(s[i][0]==="_")continue;if(typeof n[s[i]]!="function"||s[i].indexOf("Handle"))r[s[i]]=n[s[i]]}s=t.keys(e);for(i=0;i<s.length;++i)r[s[i]]=e[s[i]];return r},d.prototype.preDraw=function(e,t,n,r,i){var s=this;s.preDrawHandle&&s.preDrawHandle(e,t,n,r,i)},d.prototype.drawElement=function(e,t,n,r,i){var s=this;s.verticalAlign==="bottom"?(r+=(t.line.rect.width-t.rect.width)*t.line.section.lineStep.width,i+=(t.line.rect.height-t.rect.height)*t.line.section.lineStep.height):s.verticalAlign==="middle"&&(r+=(t.line.rect.width-t.rect.width)/2*t.line.section.lineStep.width,i+=(t.line.rect.height-t.rect.height)/2*t.line.section.lineStep.height),s.preDrawElementHandle&&s.preDrawElementHandle(e,t,n,r,i),e.font=s.getFont();var o=s.symbol.getDrawStyle(s.drawStyle);s.drawElementHandle?s.drawElementHandle(e,t,n,r,i):o&&o(e,t,n,r,i),s.postDrawElementHandle&&s.postDrawElementHandle(e,t,n,r,i)},d.prototype.postDraw=function(e,t,n,r,i){var s=this;s.postDrawHandle&&s.postDrawHandle(e,t,n,r,i)},d.prototype.onClick=function(e,t,n,r){var i=this;i.onClickHandle&&i.onClickHandle(e,t,n,r)},d.prototype._fontToComponents=function(e){var t=e.match(/^\s*(?:\b(normal|italic|oblique|inherit)?\b)\s*(?:\b(normal|small-caps|inherit)?\b)\s*(?:\b(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit)?\b)\s*(?:\b(xx-small|x-small|small|medium|large|x-large|xx-large|larger|smaller|0|\d*(?:[.]\d*)?(?:%|[a-z]{2,5}))?\b)\s*(.*)\s*$/);return t?{font:e,fontStyle:t[1]||"normal",fontVariant:t[2]||"normal",fontWeight:t[3]||"normal",fontSize:t[4]||"medium",fontFamily:t[5]}:(console.warn("RichTextStyle - unparsable CSS font: "+e),{font:e})},d.prototype._componentsToFont=function(e){var t=[],n;return n=e.fontStyle,n&&n!=="normal"&&t.push(n),n=e.fontVariant,n&&n!=="normal"&&t.push(n),n=e.fontWeight,n&&n!=="normal"&&t.push(n),n=e.fontSize,n&&n!=="medium"&&t.push(n),n=e.fontFamily,n&&t.push(n),t.length||t.push(e.font),t.join(" ")},d.fontPropertiesCache={},d.prototype._determineFontProperties=function(){var e=this._cssFont,t=d.fontPropertiesCache[e];if(!t){t={},d.fontPropertiesCanvas||(d.fontPropertiesCanvas=document.createElement("canvas"),d.fontPropertiesContext=d.fontPropertiesCanvas.getContext("2d"));var n=d.fontPropertiesCanvas,r=d.fontPropertiesContext;r.font=e;var i=Math.ceil(r.measureText("|MÉq").width);i===0&&(i=1);var s=Math.ceil(r.measureText("M").width),o=2*s;o===0&&(o=1),s=s*1.4|0,n.width=i,n.height=o,r.fillStyle="#f00",r.fillRect(0,0,i,o),r.font=e,r.textBaseline="alphabetic",r.fillStyle="#000",r.fillText("|MÉq",0,s);var u=r.getImageData(0,0,i,o).data,a=u.length,f=i*4,l,c,h=0,p=!1;for(l=0;l<s;l++){for(c=0;c<f;c+=4)if(u[h+c]!==255){p=!0;break}if(!!p)break;h+=f}t.ascent=s-l,h=a-f,p=!1;for(l=o;l>s;l--){for(c=0;c<f;c+=4)if(u[h+c]!==255){p=!0;break}if(!!p)break;h-=f}t.descent=l-s,t.fontSize=t.ascent+t.descent,d.fontPropertiesCache[e]=t}return t},qc.Serializer.registerCustomDeserializer("com.qici.richText.RichText",function(e,t,n){return new com.qici.richText.RichText(e,t,n)});var v=com.qici.richText.RichText=function(e,t,n){var r=this;r.canvas=document.createElement("canvas"),r.context=r.canvas.getContext("2d"),r.texture=PIXI.Texture.fromCanvas(r.canvas),r.texture.baseTexture.resolution=e.resolution;var i=r.sprite=new PIXI.Sprite(r.texture);r.text="",r.symbol=new com.qici.richText.RichTextSymbol(e),r.defaultStyle=new com.qici.richText.RichTextStyle(r.symbol,r.context.font),r.richTextChunks=[],r.richTextSection=new com.qici.richText.RichTextSection(this.width,p.BREAK_KEEPALL,r.defaultStyle,0),r.richTextSection.clickHandleContext=r,qc.Node.call(this,new Phaser.Group(e.phaser,null),t,n),r.name="RichText",r.phaser._renderSelfCanvas=r._renderSelfCanvas,r.phaser._renderSelfWebGL=r._renderSelfWebGL,r.phaser.transformCallback=r.onUpdateTransform,r.phaser.transformCallbackContext=r,r._currCanvasScale=1,r._currCanvasScaleDown=1,r._lastChangeTime=-Infinity,r.scaleDirtyInterval=1e3,r._updateBounds=!0,r.addListener(r.onClick,r.doClick,r),r.phaser.setDisplayProxy(r.sprite,!1)};v.prototype=t.create(qc.Node.prototype),v.prototype.constructor=v,t.defineProperties(v.prototype,{"class":{get:function(){return"com.qici.richText.RichText"}},text:{get:function(){return this._text},set:function(e){if(e===this._text)return;this._text=e,this.rebuildChunks(),this._needUpdateSection=!0}},order:{get:function(){return this.richTextSection.charOrder},set:function(e){if(e===this.richTextSection.charOrder)return;this.richTextSection.charOrder=e,this.richTextSection.calcStep(),this._needUpdateSection=!0}},wrap:{get:function(){return this.richTextSection.breakStyle},set:function(e){if(e===this.richTextSection.breakStyle)return;this.richTextSection.breakStyle=e,this._needUpdateSection=!0}},font:{get:function(){var e=this.defaultStyle.font.replace(/\'/g,"");return e},set:function(e){if(e===this.font)return;this.defaultStyle.font=e,this._needUpdateSection=!0}},fontSize:{get:function(){return this.defaultStyle.fontSize},set:function(e){if(e===this.defaultStyle.fontSize)return;this.defaultStyle.fontSize=e,this._needUpdateSection=!0}},bold:{get:function(){return this.defaultStyle.fontWeight==="bold"},set:function(e){if(e===this.bold)return;this.defaultStyle.fontWeight=e?"bold":"normal",this._needUpdateSection=!0}},italic:{get:function(){return this.defaultStyle.fontStyle==="italic"},set:function(e){if(e===this.italic)return;this.defaultStyle.fontStyle=e?"italic":"normal",this._needUpdateSection=!0}},color:{get:function(){return new qc.Color(this.defaultStyle.fontColor)},set:function(e){if(!(e instanceof qc.Color))throw new Error("Expected qc.Color");var t=e.toString("rgb");if(t===this.defaultStyle.fontColor)return;this.defaultStyle.fontColor=t,this._needUpdateSection=!0}},updateBounds:{get:function(){return this._updateBounds},set:function(e){if(e===this._updateBounds)return;this._updateBounds=e,this._needUpdateSection=!0,this._resizeNode()}}}),v.prototype.getMeta=function(){var e=qc.Node.prototype.getMeta.call(this),t=qc.Serializer;return e.text=t.STRING,e.wrap=t.NUMBER,e.order=t.NUMBER,e.font=t.FONT,e.bold=t.BOOLEAN,e.italic=t.BOOLEAN,e.fontSize=t.NUMBER,e.color=t.COLOR,e.updateBounds=t.BOOLEAN,e},v.prototype.onDestroy=function(){var e=this;e.phaser.transformCallback=null,e.phaser.transformCallbackContext=null,e.richTextSection.clickHandleContext=null,qc.Node.prototype.onDestroy.call(e)},v.prototype.setWidth=function(e){var t=this;qc.Node.prototype.setWidth.call(t,e),t.richTextSection.charStep.width&&t.richTextSection.limitLength!==e&&(t.richTextSection.limitLength=e,t._needUpdateSection=!0)},v.prototype.setHeight=function(e){var t=this;qc.Node.prototype.setHeight.call(t,e),t.richTextSection.charStep.height&&t.richTextSection.limitLength!==e&&(t.richTextSection.limitLength=e,t._needUpdateSection=!0)},v.prototype.update=function(){var e=this;e._needUpdateSection&&(e.rebuildSection(),e._needUpdateSection=!1)},v.prototype.doClick=function(e,t){var n=this,r=n.toLocal(t.source);n.richTextSection.onClick(r.x,r.y)},v.prototype.onUpdateTransform=function(){var e=this,t=e.sprite,n=e.richTextSection,r=e.phaser.worldTransform,i=e.getWorldScale(),s=Math.max(.2,Math.min(10,Math.abs(i.x))),o=Math.max(.2,Math.min(10,Math.abs(i.y))),u=e.game.resolution,a=e.game.device.desktop,f=a?1920:Math.max(960,e.game.world.width),l=a?1920:Math.max(960,e.game.world.height);s*u*n.rect.width>f&&(s=f/(n.rect.width*u)),o*u*n.rect.height>l&&(o=l/(n.rect.height*u));var c=Math.min(s,o),h=e.game.time.fixedTime,p=e._lastChangeTime||0;c!==e._currCanvasScale&&h-p>e.scaleDirtyInterval&&(e._currCanvasScale=c,e._lastChangeTime=h,e._needUpdateSection=!0),t.tint!==e.phaser.tint&&(t.tint=e.phaser.tint);var d=t.worldTransform;d.a=r.a*e._currCanvasScaleDown,d.b=r.b*e._currCanvasScaleDown,d.c=r.c*e._currCanvasScaleDown,d.d=r.d*e._currCanvasScaleDown,d.tx=r.tx|0,d.ty=r.ty|0},v.prototype.rebuildChunks=function(){var e=this;e.richTextChunks=com.qici.richText.RichTextParse.parse(e._text)},v.prototype._resizeCanvas=function(e,t){var n=this,r=n.texture.baseTexture.resolution=n.game.resolution;n.texture.baseTexture.scaleMode=PIXI.scaleModes.NEAREST,e=e*r*n._currCanvasScale,t=t*r*n._currCanvasScale,e=Math.max(1,Math.ceil(e)),t=Math.max(1,Math.ceil(t)),n.canvas.width=n.texture.frame.width=n.texture.baseTexture.width=n.texture.width=n.texture.crop.width=e,n.canvas.height=n.texture.frame.height=n.texture.baseTexture.height=n.texture.height=n.texture.crop.height=t,n._currCanvasScaleDown=1/n._currCanvasScale,n.context.setTransform(1,0,0,1,0,0),n.context.clearRect(0,0,n.canvas.width,n.canvas.height),n.context.scale(r*n._currCanvasScale,r*n._currCanvasScale)},v.prototype._resizeNode=function(){var e=this;if(!e._updateBounds)return;e.width!==e.richTextSection.rect.width&&(e.width=e.richTextSection.rect.width),e.height!==e.richTextSection.rect.height&&(e.height=e.richTextSection.rect.height)},v.prototype.rebuildSection=function(){var e=this,t=e.richTextSection;t.build(e.context,e.richTextChunks),e._resizeNode(),e.rebuildTexture()},v.prototype.rebuildTexture=function(){var e=this,t=e.richTextSection;e._resizeCanvas(t.rect.width+t.margin.left+t.margin.right,t.rect.height+t.margin.top+t.margin.bottom),t.render(e.context,t.margin.left|0,t.margin.top|0),e.texture.baseTexture.dirty(),e.sprite.cachedTint=e.sprite.tint-1,e.sprite.displayChanged(qc.DisplayChangeStatus.TEXTURE|qc.DisplayChangeStatus.SIZE),e.phaser.displayChanged(qc.DisplayChangeStatus.TEXTURE|qc.DisplayChangeStatus.SIZE)},v.prototype._renderSelfCanvas=function(e){var t=this,n=t._qc.sprite;n._renderCanvas(e)},v.prototype._renderSelfWebGL=function(e){var t=this,n=t._qc.sprite;n._renderWebGL(e)};var m=qc.defineBehaviour("com.qici.richText.RichTextEmoji",qc.Behaviour,function(){var e=this;e.packageName="emoji",e.packageAtlas=null},{richText:qc.Serializer.NODE,packageName:qc.Serializer.STRING,packageAtlas:qc.Serializer.TEXTURE});m.__menu="UI/RichText/RichTextEmoji",t.defineProperties(m.prototype,{packageName:{get:function(){return this._packageName},set:function(e){if(e===this._packageName)return;this.unregisterEmoji(),this._packageName=e,this.registerEmoji()}},packageAtlas:{get:function(){return this._packageAtlas},set:function(e){if(e===this._packageAtlas)return;this.unregisterEmoji(),this._packageAtlas=e,this.registerEmoji()}},richText:{get:function(){return this._richText},set:function(e){if(e===this._richText)return;this.unregisterEmoji(),this._richText=e,this.registerEmoji()}}}),m.prototype.onEnable=function(){this.registerEmoji()},m.prototype.onDisable=function(){this.unregisterEmoji()},m.prototype.registerEmoji=function(){var e=this;if(!e._richText||!e._packageAtlas)return;if(!e.enable)return;var t=e._richText.symbol;t.registerEmoji(e._packageName,e._packageAtlas)},m.prototype.unregisterEmoji=function(){var e=this;if(!e._richText||!e._packageAtlas)return;var t=e._richText.symbol;t.unregisterEmoji(e._packageName,e._packageAtlas)},qc.Serializer.registerCustomDeserializer("qc.ParticleSystem",function(e,t,n){return new qc.ParticleSystem(e,t,n)});var g=qc.ParticleSystem=function(e,t,r){qc.Node.call(this,new Phaser.Group(e.phaser,null),t,r),this.name="Particle System",this.paused=!1,this.onVisibleChanged=new qc.Signal,this.emitter=null;var i=e.assets.find("__builtin_resource__");this.textures=[i.getTexture("empty.png")],this.rendererType=qc.ParticleSystem.Renderer.SPRITE,this.zoneType=qc.ParticleSystem.Zones.Zone.POINT,this.zoneLength=100,this.zoneRotation=0,this.zoneRadius=100,this.zoneWidth=100,this.zoneHeight=100,this.frequency=.1,this.quantity=1,this.repeat=-1,this.delay=0,this.lifespan=[5,5],this.angle=[-120,-60],this.blendMode=Phaser.blendModes.NORMAL,this.srcColorTint=new qc.Color(16777215),this.dstColorTint=new qc.Color(16777215),this.startAlpha=[1,1],this.startScale=[1,1],this.startRotation=[0,0],this.startVelocity=[100,100],this.angularVelocity=[0,0],this.gravity=new qc.Point(0,0),this.maxParticles=200,this.playOnAwake=!0,this.enableColorCurve=!1,this.colorCurve=new qc.BezierCurve(new qc.Keyframe(0,0,0,0),new qc.Keyframe(1,1,0,0)),this.enableAlphaCurve=!1,this.alphaCurve=new qc.BezierCurve(new qc.Keyframe(0,1,0,0),new qc.Keyframe(1,1,0,0)),this.enableScaleCurve=!1,this.scaleCurve=new qc.BezierCurve(new qc.Keyframe(0,1,0,0),new qc.Keyframe(1,1,0,0)),this.enableVelocityCurve=!1,this.velocityCurve=new qc.BezierCurve(new qc.Keyframe(0,1,0,0),new qc.Keyframe(1,1,0,0)),this.enableAngularVelocityCurve=!1,this.angularVelocityCurve=new qc.BezierCurve(new qc.Keyframe(0,1,0,0),new qc.Keyframe(1,1,0,0));var s=r!==n;s||this.initEmitter()};g.prototype=t.create(qc.Node.prototype),g.prototype.constructor=g,qc.ParticleSystem.Transitions={},qc.ParticleSystem.Zones={},qc.ParticleSystem.Renderer={},qc.ParticleSystem.Renderer.SPRITE=1,t.defineProperties(g.prototype,{"class":{get:function(){return"qc.ParticleSystem"}}}),g.prototype.update=function(){if(this.paused)return;var e=this.game.time.deltaTime*.001;this.emitter.update(e)},g.prototype.initEmitter=function(){var e=new qc.ParticleSystem.Emitter(this);this.emitter=e,e.init(),!this.isWorldVisible()||!this.playOnAwake?this.pause():this.start()},g.prototype.start=function(){if(!this.isWorldVisible())return;this.paused=!1,this.emitter.start()},g.prototype.pause=function(){this.paused=!0,this.emitter.pause()},g.prototype.clear=function(){this.emitter.clear()},g.prototype.reset=function(){this.emitter.reset()},g.prototype.onDeserialized=function(){this.initEmitter()},g.prototype.onDestroy=function(){this.emitter.destroy(),this.emitter=null,qc.Node.prototype.onDestroy.call(this)},g.prototype.onVisibleChange=function(){if(this.emitter===null)return;this.onVisibleChanged.dispatch(),this.isWorldVisible()?this.start():(this.clear(),this.pause())},g.prototype.getMeta=function(){var e=this,t=qc.Serializer,n=qc.Node.prototype.getMeta.call(this);return n.rendererType=t.NUMBER,n.textures=t.TEXTURES,n.zoneType=t.NUMBER,n.zoneLength=t.NUMBER,n.zoneRotation=t.NUMBER,n.zoneRadius=t.NUMBER,n.zoneWidth=t.NUMBER,n.zoneHeight=t.NUMBER,n.frequency=t.NUMBER,n.quantity=t.NUMBER,n.repeat=t.NUMBER,n.delay=t.NUMBER,n.lifespan=t.NUMBERS,n.angle=t.NUMBERS,n.blendMode=t.NUMBER,n.srcColorTint=t.COLOR,n.dstColorTint=t.COLOR,n.startAlpha=t.NUMBERS,n.startScale=t.NUMBERS,n.startRotation=t.NUMBERS,n.startVelocity=t.NUMBERS,n.angularVelocity=t.NUMBERS,n.gravity=t.POINT,n.maxParticles=t.NUMBER,n.playOnAwake=t.BOOLEAN,n.enableColorCurve=t.BOOLEAN,n.colorCurve=t.GEOM,n.enableAlphaCurve=t.BOOLEAN,n.alphaCurve=t.GEOM,n.enableScaleCurve=t.BOOLEAN,n.scaleCurve=t.GEOM,n.enableVelocityCurve=t.BOOLEAN,n.velocityCurve=t.GEOM,n.enableAngularVelocityCurve=t.BOOLEAN,n.angularVelocityCurve=t.GEOM,n};var y=qc.ParticleSystem.Transitions.Transform=function(e){this.particle=e,this.particleSystem=e.emitter.owner,this.time=e.emitter.game.time,this.gravity=new Phaser.Point,this.x=0,this.y=0,this.anchor={x:.5,y:.5},this.velocity={x:0,y:0},this.originVelocity={x:0,y:0},this.scale=this.originScale=1,this.rotation=0,this.originAngularVelocity=0};y.prototype.constructor=y,y.prototype.init=function(e,t){this.x=e,this.y=t,this.gravity=this.particleSystem.gravity;var n=qc.ParticleSystem.Util.getRandom(this.particleSystem.angle),r=qc.ParticleSystem.Util.getRandom(this.particleSystem.startVelocity),i=n*Math.PI/180;this.velocity.x=this.originVelocity.x=r*Math.cos(i),this.velocity.y=this.originVelocity.y=r*Math.sin(i),this.scale=this.originScale=qc.ParticleSystem.Util.getRandom(this.particleSystem.startScale),this.rotation=qc.ParticleSystem.Util.getRandom(this.particleSystem.startRotation)*Math.PI/180,this.originAngularVelocity=qc.ParticleSystem.Util.getRandom(this.particleSystem.angularVelocity)*Math.PI/180},y.prototype.update=function(e,t){var n=t;this.originVelocity.x+=this.gravity.x*e,this.originVelocity.y+=this.gravity.y*e;if(this.particleSystem.enableVelocityCurve){var r=this.particleSystem.velocityCurve.evaluate(n);this.velocity.x=this.originVelocity.x*r,this.velocity.y=this.originVelocity.y*r}else this.velocity.x=this.originVelocity.x,this.velocity.y=this.originVelocity.y;this.x+=this.velocity.x*e,this.y+=this.velocity.y*e;if(this.particleSystem.enableScaleCurve){var i=this.particleSystem.scaleCurve.evaluate(n);this.scale=this.originScale*i}if(this.originAngularVelocity!==0){var s=this.originAngularVelocity;this.particleSystem.enableAngularVelocityCurve&&(s*=this.particleSystem.angularVelocityCurve.evaluate(n)),this.rotation+=s*e}};var b=qc.ParticleSystem.Zones.Zone=function(){this.geometry=null,this._random=new qc.Point};b.prototype.constructor=b,b.POINT=1,b.LINE=2,b.RECTANGLE=3,b.CIRCLE=4,b.prototype.getRandom=function(){return this._random},b.prototype.emit=function(e,t){for(var n=0;n<t;n++)this.getRandom(),e.emitParticle(this._random.x,this._random.y,e)};var w=qc.ParticleSystem.Particle=function(e){this.emitter=e,this.particleSystem=e.owner,this.renderer=e.renderer,this.game=this.emitter.owner.game,this.manualDisplayChanged=this.game.phaser.renderType===Phaser.CANVAS&&this.game.dirtyRectangle.enable,this.alive=!0,this.life=0,this.sprite=null,this.transform=new qc.ParticleSystem.Transitions.Transform(this),this.color=new qc.ParticleSystem.Transitions.Color(this)};w.prototype.constructor=w,w.prototype.init=function(e,t){this.life=0,this.alive=!0,this.lifespan=qc.ParticleSystem.Util.getRandom(this.particleSystem.lifespan),this.create(e,t),this.cacheParentWorldTransform(),this.sprite.updateTransform=w.updateTransform},w.prototype.create=function(e,t){var n=this.particleSystem.textures;this.transform.init(e,t),this.color.init();if(this.alive){var r=this.renderer.add(this,n);this.renderer.update(this)}this.transform.update(0,0),this.color.update(0,0),this.manualDisplayChanged&&this.sprite.displayChanged(qc.DisplayChangeStatus.SHOW)},w.prototype.update=function(e){this.life+=e,this.life<this.delay?this.sprite.visible=!1:this.sprite.visible=!0,this.renderer.update(this);var t=Phaser.Math.clamp(this.life/this.lifespan,0,1);this.transform.update(e,t),this.color.update(e,t);if(this.life>=this.lifespan){this.terminate();return}},w.prototype.terminate=function(){this.alive=!1,this.sprite.kill(),this.manualDisplayChanged&&this.sprite.displayChanged(qc.DisplayChangeStatus.HIDE)},w.prototype.cacheParentWorldTransform=function(){if(!this.sprite)return;var e=this.emitter.owner.phaser.worldTransform,t=this.sprite._parentWorldTransform=new qc.Matrix;t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t.tx=e.tx,t.ty=e.ty},w.updateTransform=function(){if(!this.parent||!this.visible)return;var e=this._parentWorldTransform;if(!e)return;var t=this.worldTransform,n,r,i,s,o,u;if(this.rotation%PIXI.PI_2){this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation)),n=this._cr*this.scale.x,r=this._sr*this.scale.x,i=-this._sr*this.scale.y,s=this._cr*this.scale.y,o=this.position.x,u=this.position.y;if(this.pivot.x||this.pivot.y)o-=this.pivot.x*n+this.pivot.y*i,u-=this.pivot.x*r+this.pivot.y*s;t.a=n*e.a+r*e.c,t.b=n*e.b+r*e.d,t.c=i*e.a+s*e.c,t.d=i*e.b+s*e.d,t.tx=o*e.a+u*e.c+e.tx,t.ty=o*e.b+u*e.d+e.ty}else n=this.scale.x,s=this.scale.y,o=this.position.x-this.pivot.x*n,u=this.position.y-this.pivot.y*s,t.a=n*e.a,t.b=n*e.b,t.c=s*e.c,t.d=s*e.d,t.tx=o*e.a+u*e.c+e.tx,t.ty=o*e.b+u*e.d+e.ty;this.worldAlpha=this.alpha,this.transformCallback&&this.transformCallback.call(this.transformCallbackContext,t,e)};var E=qc.ParticleSystem.Renderer.Sprite=function(e){this.emitter=e,this.display=e.owner.phaser};E.prototype.constructor=E,E.prototype.add=function(e,t){var n=this.emitter.game.rnd.pick(t),r=n.atlas.url,i=n.frame,s=e.sprite;return s?(s.reset(e.transform.x,e.transform.y),s.key!==r?s.loadTexture(r,i):s.frameName=i):s=this.display.create(e.transform.x,e.transform.y,r,i),s.anchor.set(e.transform.anchor.x,e.transform.anchor.y),s.blendMode=e.color.blendMode,e.sprite=s,s},E.prototype.update=function(e){var t=0,n=e.sprite;if(n.x!==e.transform.x||n.y!==e.transform.y)t|=qc.DisplayChangeStatus.OFFSET,n.x=e.transform.x,n.y=e.transform.y;n.scale.x!==e.transform.scale&&(t|=qc.DisplayChangeStatus.SCALE,n.scale.x=e.transform.scale,n.scale.y=e.transform.scale),n.rotation!==e.transform.rotation&&(t|=qc.DisplayChangeStatus.ROTATION,n.rotation=e.transform.rotation),n.tint!==e.color.hexColor&&(t|=qc.DisplayChangeStatus.TINT,n.tint=e.color.hexColor),n.alpha!==e.color.alpha&&(t|=qc.DisplayChangeStatus.ALPHA,n.alpha=e.color.alpha),e.manualDisplayChanged&&n.displayChanged(t)};var S=qc.ParticleSystem.Transitions.Color=function(e){this.particle=e,this.particleSystem=e.emitter.owner,this.time=e.emitter.game.time,this.blendMode=Phaser.blendModes.NORMAL,this.colorTint=new qc.Color(16777215),this.hexColor=this.colorTint.toNumber(),this.alpha=this.originAlpha=1};S.prototype.constructor=S,S.prototype.init=function(){this.alpha=this.originAlpha=qc.ParticleSystem.Util.getRandom(this.particleSystem.startAlpha),this.colorTint=new qc.Color(this.particleSystem.srcColorTint.toNumber()),this.hexColor=this.colorTint.toNumber(),this.blendMode=this.particleSystem.blendMode},S.prototype.update=function(e,t){var n=t,r=this.particleSystem.srcColorTint.rgb,i=this.particleSystem.dstColorTint.rgb;if(r[0]!==i[0]||r[1]!==i[1]||r[2]!==i[2]){var s;this.particleSystem.enableColorCurve?s=this.particleSystem.colorCurve.evaluate(n):s=n,r[0]!==i[0]&&(this.colorTint.r=Phaser.Math.clamp(Math.round(r[0]+s*(i[0]-r[0])),0,255)),r[1]!==i[1]&&(this.colorTint.g=Phaser.Math.clamp(Math.round(r[1]+s*(i[1]-r[1])),0,255)),r[2]!==i[2]&&(this.colorTint.b=Phaser.Math.clamp(Math.round(r[2]+s*(i[2]-r[2])),0,255)),this.hexColor=this.colorTint.toNumber()}if(this.particleSystem.enableAlphaCurve){var o=this.particleSystem.alphaCurve.evaluate(n);this.alpha=this.originAlpha*o}};var x=qc.defineBehaviour("qc.EmitterViewer",qc.Behaviour,function(){var e=this;e.now=e.game.time.now,e.runInEditor=!0,e.debugOn=!0,e.duration=1},{debugOn:qc.Serializer.BOOLEAN,particleSystem:qc.Serializer.NODE});x.__menu="Debug/EmitterViewer",t.defineProperties(x.prototype,{debugOn:{get:function(){return this._debugOn},set:function(e){this._debugOn=e}},particleSystem:{get:function(){return this._particleSystem},set:function(e){this._particleSystem=e}}}),x.prototype.postUpdate=function(){if(!this.particleSystem)return;if(!this.debugOn)return;var e=this.game.time.now;if(e-this.now>=this.duration*1e3){var t=this.particleSystem.emitter;if(t===null)return;var n=qc.Util.formatString("\n\n({0})\nAlive:{1}\nDead:{2}\nTotal:{3}",this.particleSystem.name,t.list.length,t.pool.length,t.list.length+t.pool.length);this.gameObject instanceof qc.UIText?this.gameObject.text=n:this.gameObject instanceof qc.Dom&&(n=n.replace(/\n/g,"<br/>"),this.gameObject.innerHTML=n)}},qc.ParticleSystem.Util={getRandom:function(e){if(!Array.isArray(e)||e.length<2)return 0;var t=e[0]||0,n=e[1]||0,r=Math.random(),i=t+r*(n-t);return i}};var T=qc.ParticleSystem.Zones.Circle=function(e){qc.ParticleSystem.Zones.Zone.call(this),this.geometry=new qc.Circle(0,0,e*2)};T.prototype=t.create(qc.ParticleSystem.Zones.Zone.prototype),T.prototype.constructor=T,T.prototype.getRandom=function(){var e=2*Math.PI*Math.random();this._random.x=this.geometry.x+this.geometry.radius*Math.random()*Math.cos(e),this._random.y=this.geometry.y+this.geometry.radius*Math.random()*Math.sin(e)};var N=qc.ParticleSystem.Zones.Line=function(e,t){qc.ParticleSystem.Zones.Zone.call(this);var n=t*Math.PI/180,r=e/2*Math.cos(n),i=e/2*Math.sin(n),s=-r,o=-i;this.geometry=new qc.Line(r,i,s,o)};N.prototype=t.create(qc.ParticleSystem.Zones.Zone.prototype),N.prototype.constructor=N,N.prototype.getRandom=function(){var e=Math.random();this._random.x=this.geometry.start.x+e*(this.geometry.end.x-this.geometry.start.x),this._random.y=this.geometry.start.y+e*(this.geometry.end.y-this.geometry.start.y)};var C=qc.ParticleSystem.Zones.Point=function(){qc.ParticleSystem.Zones.Zone.call(this),this.geometry=new qc.Point};C.prototype=t.create(qc.ParticleSystem.Zones.Zone.prototype),C.prototype.constructor=C,C.prototype.getRandom=function(){this._random=this.geometry};var k=qc.ParticleSystem.Zones.Rectangle=function(e,t){qc.ParticleSystem.Zones.Zone.call(this);var n=-e/2,r=-t/2;this.geometry=new qc.Rectangle(n,r,e,t)};k.prototype=t.create(qc.ParticleSystem.Zones.Zone.prototype),k.prototype.constructor=k,k.prototype.getRandom=function(){var e=Math.random(),t=Math.random();this._random.x=this.geometry.x+e*this.geometry.width,this._random.y=this.geometry.y+t*this.geometry.height};var L=qc.ParticleSystem.Emitter=function(e){this.game=e.game.phaser,this.owner=e,this.particleClass=qc.ParticleSystem.Particle,this.list=[],this.pool=[],this.paused=!1};L.prototype.constructor=L,L.prototype.init=function(){this.renderer=this.createRenderer(this.owner.rendererType),this.zone=this.createZone(),this.timer=this.game.time.create(!1)},L.prototype.start=function(){this.paused=!1;if(!this.timer.running){var e=this.owner.repeat,t=this.owner.frequency*1e3;e===-1?this.timer.loop(t,this.emitImp,this):e>0&&this.timer.repeat(t,e,this.emitImp,this),this.timer.start(this.owner.delay*1e3)}else this.timer.resume()},L.prototype.pause=function(){this.paused=!0,this.timer.pause()},L.prototype.update=function(e){for(var t=this.list.length-1;t>=0;t--){var n=this.list[t];n.update(e),n.alive||(this.pool.push(n),this.list.splice(t,1))}},L.prototype.clear=function(){for(var e=0;e<this.list.length;e++){var t=this.list[e];t.terminate()}this.list=[],this.pool=[]},L.prototype.reset=function(){this.clear(),this.renderer=null,this.zone=null,this.timer.destroy(),this.init()},L.prototype.destroy=function(){this.clear(),this.renderer=null,this.zone=null,this.timer.destroy(),this.timer=null},L.prototype.emitParticle=function(e,t,n){if(this.list.length>=this.owner.maxParticles)return;var r=this.pool.pop();r||(r=new this.particleClass(this)),r.init(e,t),r.alive?this.list.push(r):this.pool.push(r)},L.prototype.emitImp=function(){var e=this.owner.quantity;this.zone&&this.zone.emit(this,e)},L.prototype.createRenderer=function(e){e=e||qc.ParticleSystem.RENDER_TYPE_SPRITE;var t;switch(e){case qc.ParticleSystem.Renderer.SPRITE:t=new qc.ParticleSystem.Renderer.Sprite(this);break;default:console.error("Invalid renderer type "+e)}return t},L.prototype.createZone=function(){var e=this.owner.zoneType,t;switch(e){case qc.ParticleSystem.Zones.Zone.POINT:t=new qc.ParticleSystem.Zones.Point;break;case qc.ParticleSystem.Zones.Zone.LINE:var n=this.owner.zoneLength,r=this.owner.zoneRotation;t=new qc.ParticleSystem.Zones.Line(n,r);break;case qc.ParticleSystem.Zones.Zone.CIRCLE:var i=this.owner.zoneRadius;t=new qc.ParticleSystem.Zones.Circle(i);break;case qc.ParticleSystem.Zones.Zone.RECTANGLE:var s=this.owner.zoneWidth,o=this.owner.zoneHeight;t=new qc.ParticleSystem.Zones.Rectangle(s,o);break;default:console.error("Invalid zone type "+zoneType)}return t},qc.Box2D={};var A=Phaser.Physics.BOX2D=function(e){this.game=e._qc,e._qc.box2d=this,B2ObjectProxy.init();var t,r=this.game.config.customSettings.Box2D||{},i=function(e,t){var i=r[e];return i===n?t:i};this._gravity=i("gravity",10),this.velocityIterations=i("velocityIterations",3),this.positionIterations=i("positionIterations",2),this.PTM=i("PTM",20),this.useElapsedTime=i("useElapsedTime",!1),this._rawFrameRate=i("frameRate",30),this._rawFrameRate?this.frameRate=this._rawFrameRate:this.frameRate=e.desiredFps||60,this.maxSimulatePerFrame=i("maxSimulatePerFrame",3),this._gravityVec2=new Box2D.b2Vec2(0,1*this.gravity),this.b2World=new Box2D.b2World(this._gravityVec2),this.contactListener=new qc.Box2D.ContactListener(this),this._debugDrawHandler=new qc.Box2D.DebugDraw(this),this.debugDraw=i("debugDraw",!1),this.debugFlags=i("debugFlags",_.FlagShapeBit|_.FlagJointBit|_.FlagAabbBit|_.FlagPairBit|_.FlagCenterOfMassBit),this.allowSleeping=i("allowSleeping",!0),this.paused=!1,this.flatten=i("flatten",!1),this.bodyStrictOrder=i("strictOrder",!1),this.raycastHandler=new qc.Box2D.Raycast(this),this.queryAABBHandler=new qc.Box2D.QueryAABB(this),this.game.onStart.add(this.onGameStart,this)};A.prototype={},A.prototype.constructor=A,t.defineProperties(A.prototype,{gravity:{get:function(){return this._gravity},set:function(e){this._gravity=e,this._gravityVec2&&Box2D.destroy(this._gravityVec2),this._gravityVec2=new Box2D.b2Vec2(0,1*this.gravity),this.b2World.SetGravity(this._gravityVec2)}},velocityIterations:{get:function(){return this._velocityIterations},set:function(e){this._velocityIterations=e}},positionIterations:{get:function(){return this._positionIterations},set:function(e){this._positionIterations=e}},allowSleeping:{get:function(){return this._allowSleeping},set:function(e){this._allowSleeping=e,this.b2World.SetAllowSleeping(e)}},autoClearForces:{get:function(){return this.b2World.GetAutoClearForces()},set:function(){this.b2World.SetAutoClearForces()}},PTM:{get:function(){return this._ptm},set:function(e){this._ptm=e,this._mtp=1/e}},frameRate:{get:function(){return this._frameRate},set:function(e){e=e||1,this._stepFrameMS=1/e,this._frameRate=e}},useElapsedTime:{get:function(){return this._useElapsedTime},set:function(e){this._useElapsedTime=e}},debugDraw:{get:function(){return this._debugDrawHandler.enabled},set:function(e){this._debugDrawHandler.enabled=e}},debugFlags:{get:function(){return this._debugDrawHandler.flags},set:function(e){this._debugDrawHandler.flags=e}}}),A.prototype.preUpdate=function(){if(this.paused)return;if(!this.game.time)return;var e=this.b2World,t,n,r,i=this._useElapsedTime;if(i){var s=this._lastElapseRest||0,o=.001*this.game.time.deltaTime+s,u=this._stepFrameMS;this._lastElapseRest=o%u;var a=Math.floor(o/u);a>this.maxSimulatePerFrame&&(a=this.maxSimulatePerFrame);if(a<1)return}else a=1;var f,l=Date.now(),c=this.getBodyList();for(n=0,r=c.length;n<r;n++)t=c[n],t.behaviour.bodyPreUpdate();f=Date.now(),this.game.debug.a+=f-l,l=f;for(n=0;n<a;n++)this.step();f=Date.now(),this.game.debug.b+=f-l,l=f,c=this.getBodyList();for(n=0,r=c.length;n<r;n++)t=c[n],t.behaviour.bodyPostUpdate();f=Date.now(),this.game.debug.c+=f-l,this._debugDrawHandler.render()},A.prototype.update=function(){},A.prototype.pixelToMeter=function(e){return e*this._mtp},A.prototype.meterToPixel=function(e){return e*this._ptm},A.prototype.setBoundsToWorld=function(){},A.prototype.clear=function(){},A.prototype.reset=function(){},A.prototype.destroy=function(){},A.prototype.onFrameRateChanged=function(){this._rawFrameRate||(this.frameRate=this.game.time.frameRate)},A.prototype.onGameStart=function(){this._rawFrameRate||(this.frameRate=this.game.time.frameRate),this.game.time.onFrameRateChanged.add(this.onFrameRateChanged,this)},A.prototype.step=function(){this.b2World.Step(this._stepFrameMS,this._velocityIterations,this._positionIterations)},A.prototype.drawDebugData=function(){this.b2World.DrawDebugData()},A.prototype.setContactListener=function(e){this.b2World.SetContactListener(e)},A.prototype.setDebugDraw=function(e){this.b2World.SetDebugDraw(e)},A.prototype.pause=function(){this.paused=!0},A.prototype.resume=function(){this.paused=!1},A.prototype.createBody=function(e){return this.bodyList=null,this.b2World.CreateBody(e)},A.prototype.destroyBody=function(e){this.bodyList=null;var t=e.b2Body;if(!t)return;return this.b2World.DestroyBody(t)},A.prototype.getBodyByGameWorld=function(e,t){var n=e.b2Body;n&&t.push(n);var r=e.children;for(var i=0,s=r.length;i<s;i++)this.getBodyByGameWorld(r[i],t)},A.prototype.getBodyList=function(){var e;if(this.bodyStrictOrder)return e=[],this.getBodyByGameWorld(this.game.world,e),e;if(this.bodyList)return this.bodyList;var t=this.b2World,n=t.GetBodyCount();if(!n)return n;e=new Array(n);var r=0,i;for(i=t.GetBodyList();i.e;i=i.GetNext())e[r++]=i;return this.bodyList=e,e},A.prototype.raycast=function(e,t,n,r,i,s){return Math.abs(e-n)+Math.abs(t-r)<.01?[]:this.raycastHandler.check(e,t,n,r,i,s)},A.prototype.queryAABB=function(e,t,n,r,i,s){return this.queryAABBHandler.check(e,t,n,r,i,s)},A.prototype.queryFixtureAtPoint=function(e,t,n,r){var i=.1,s=new Box2D.b2Vec2(this.pixelToMeter(e),this.pixelToMeter(t)),o=function(e,t){return t.TestPoint(s)?r&&!r.call(this,e,t)?!1:!0:!1},u=this.queryAABBHandler.check(e-i,t-i,i*2,i*2,n,o);return Box2D.destroy(s),u},A.prototype._parseVector2=function(e){return e?new Box2D.b2Vec2(e.x||0,e.y||0):new Box2D.b2Vec2(0,0)},A.prototype._initJoinLength=function(e,t,n,r,i){if(typeof e=="number")return this.pixelToMeter(e);var s=t.GetWorldPoint(r),o=s.get_x(),u=s.get_y(),a=n.GetWorldPoint(i),f=a.get_x(),l=a.get_y(),c=f-o,h=l-u;return Math.sqrt(c*c+h*h)},A.prototype.createDistanceJoint=function(e,t,n,r,i,s,o,u){if(!e.b2Body||!t.b2Body)return null;n=this._parseVector2(n),r=this._parseVector2(r),typeof s!="number"&&(s=0),typeof o!="number"&&(o=0),typeof u!="boolean"&&(u=!1),i=this._initJoinLength(i,e.b2Body,t.b2Body,n,r);var a=new Box2D.b2DistanceJointDef;a.set_bodyA(e.b2Body),a.set_bodyB(t.b2Body),a.set_collideConnected(u),a.set_localAnchorA(n),a.set_localAnchorB(r),a.set_dampingRatio(s),a.set_frequencyHz(o),a.set_length(i);var f=this.b2World.CreateJoint(a);return Box2D.destroy(n),Box2D.destroy(r),f},A.prototype.createRevoluteJoint=function(e,t,n,r,i,s,o,u,a,f,l){if(!e.b2Body||!t.b2Body)return null;n=this._parseVector2(n),r=this._parseVector2(r),typeof l!="boolean"&&(l=!1),typeof i!="boolean"&&(i=!1),typeof u!="boolean"&&(u=!1);var c=new Box2D.b2RevoluteJointDef;c.set_bodyA(e.b2Body),c.set_bodyB(t.b2Body),c.set_collideConnected(l),c.set_localAnchorA(n),c.set_localAnchorB(r),c.set_enableLimit(i),c.set_enableMotor(u),c.set_lowerAngle(s||0),c.set_upperAngle(o||0),c.set_maxMotorTorque(a||0),c.set_motorSpeed(f||0);var h=this.b2World.CreateJoint(c);return Box2D.destroy(n),Box2D.destroy(r),h},A.prototype.createRopeJoint=function(e,t,n,r,i,s){if(!e.b2Body||!t.b2Body)return null;n=this._parseVector2(n),r=this._parseVector2(r),i=this._initJoinLength(i,e.b2Body,t.b2Body,n,r);var o=new Box2D.b2RopeJointDef;o.set_bodyA(e.b2Body),o.set_bodyB(t.b2Body),o.set_collideConnected(!!s),o.set_localAnchorA(n),o.set_localAnchorB(r),o.set_maxLength(i);var u=this.b2World.CreateJoint(o);return Box2D.destroy(n),Box2D.destroy(r),u},A.prototype.createPrismaticJoint=function(e,t,n,r,i,s,o,u,a,f,l,c,h){if(!e.b2Body||!t.b2Body)return null;n=this._parseVector2(n),r=this._parseVector2(r),s=this._parseVector2(s);var p=new Box2D.b2PrismaticJointDef;p.set_bodyA(e.b2Body),p.set_bodyB(t.b2Body),p.set_collideConnected(!!h),p.set_localAnchorA(n),p.set_localAnchorB(r),p.set_enableLimit(i),p.set_enableMotor(f),p.set_localAxisA(s),p.set_lowerTranslation(o||0),p.set_maxMotorForce(maxMotorForce||0),p.set_motorSpeed(l||0),p.set_referenceAngle(a||0),p.set_upperTranslation(u||0);var d=this.b2World.CreateJoint(p);return Box2D.destroy(n),Box2D.destroy(r),Box2D.destroy(s),d},A.prototype.createWheelJoint=function(e,t,n,r,i,s,o,u,a,f,l){if(!e.b2Body||!t.b2Body)return null;anchorA=this._parseVector2(anchorA),anchorB=this._parseVector2(anchorB),s=this._parseVector2(s);var c=new Box2D.b2WheelJointDef;c.set_bodyA(e.b2Body),c.set_bodyB(t.b2Body),c.set_collideConnected(!!l),c.set_localAnchorA(anchorA),c.set_localAnchorB(anchorB),c.set_enableMotor(i||!1),c.set_localAxisA(s),c.set_maxMotorTorque(o||0),c.set_motorSpeed(u||0),c.set_dampingRatio(a||0),c.set_frequencyHz(f||0);var h=this.b2World.CreateJoint(c);return Box2D.destroy(anchorA),Box2D.destroy(anchorB),Box2D.destroy(s),h},A.prototype.createMotorJoint=function(e,t,n,r,i,s,o,u,a){if(!e.b2Body||!t.b2Body)return null;var f=new Box2D.b2MotorJointDef;f.set_bodyA(e.b2Body),f.set_bodyB(t.b2Body),f.set_collideConnected(!!a);var l=new Box2D.b2Vec2(this.pixelToMeter(n||0),this.pixelToMeter(r||0));f.set_linearOffset(l),f.set_angularOffset(i||0),f.set_maxForce(s||0),f.set_maxTorque(o||0),f.set_correctionFactor(u||0);var c=this.b2World.CreateJoint(f);return Box2D.destory(l),c},A.prototype.createFrictionJoint=function(e,t,n,r,i,s,o){if(!e.b2Body||!t.b2Body)return null;n=this._parseVector2(n),r=this._parseVector2(r);var u=new Box2D.b2FrictionJointDef;u.set_bodyA(e.b2Body),u.set_bodyB(t.b2Body),u.set_collideConnected(!!o),u.set_localAnchorA(n),u.set_localAnchorB(r),u.set_maxForce(i||0),u.set_maxTorque(s||0);var a=this.b2World.CreateJoint(u);return Box2D.destroy(n),Box2D.destroy(r),a},A.prototype.createWeldJoint=function(e,t,n,r,i,s,o,u){if(!e.b2Body||!t.b2Body)return null;n=this._parseVector2(n),r=this._parseVector2(r);var a=new Box2D.b2WeldJointDef;a.set_bodyA(e.b2Body),a.set_bodyB(t.b2Body),a.set_collideConnected(!!u),a.set_localAnchorA(n),a.set_localAnchorB(r),a.set_referenceAngle(i||0),a.set_dampingRatio(s||0),a.set_frequencyHz(o||0);var f=this.b2World.CreateJoint(a);return Box2D.destroy(n),Box2D.destroy(r),f},A.prototype.debugInfo=function(){var e=this.b2World,t=this.getBodyList(),n=[];n.push("Box2D world Info:"),n.push("    gravity : "+this.gravity),n.push("    allowSleeping : "+e.GetAllowSleeping()),n.push("    autoClearForces : "+e.GetAutoClearForces()),n.push("    bodyCount : "+e.GetBodyCount()),n.push("    contactCount : "+e.GetContactCount()),n.push("    jointCount : "+e.GetJointCount());var r=this.game.world,i=function(e){var t=e.name,n;while((n=e.parent)&&n!==r)e=n,t=e.name+"/"+t;return t};for(var s=0,o=t.length;s<o;s++){var u=t[s],a=u.behaviour;n.push("  Body "+(s+1)),n.push("    name : "+i(u.gameObject));var f;switch(a.type){case qc.Box2D.Body.TYPE.DYNAMIC:f="dynamic";break;case qc.Box2D.Body.TYPE.KINEMATIC:f="kinematic";break;default:f="static"}n.push("    type : "+f),n.push("    awake : "+a.isAwake),n.push("    bullet : "+a.bullet),n.push("    fixedRotation : "+a.fixedRotation),n.push("    gravityScale : "+a.gravityScale),n.push("    linearVelocity : ("+a.linearVelocity.x+","+a.linearVelocity.y+")"),n.push("    linearDamping : "+a.linearDamping),n.push("    angularVelocity : "+a.angularVelocity),n.push("    angularDamping : "+a.angularDamping);var l;switch(a.fixtureType){case qc.Box2D.Body.FIXTURE_TYPE.CIRCLE:l="circle";break;case qc.Box2D.Body.FIXTURE_TYPE.CHAIN:l="chain";break;default:l="polygon"}n.push("   *fixture Type : "+l),n.push("    density : "+a.density),n.push("    friction : "+a.friction),n.push("    restitution : "+a.restitution),n.push("    sensor : "+a.sensor)}console.log(n.join("\n"))},B2ObjectProxy={},B2ObjectProxy.init=function(){B2ObjectProxy.vec2=new Box2D.b2Vec2(0,0),B2ObjectProxy.fixtureDef=new Box2D.b2FixtureDef,B2ObjectProxy.circleShape=new Box2D.b2CircleShape,B2ObjectProxy.polygonShape=new Box2D.b2PolygonShape,B2ObjectProxy.chainShape=new Box2D.b2ChainShape,B2ObjectProxy.verticesBuffer={4:Box2D.allocate(32,"float",Box2D.ALLOC_STACK)}},Box2D.Vec2Proxy=function(e,t){var n=B2ObjectProxy.vec2;return n.set_x(e),n.set_y(t),n},Box2D.b2FixtureDefProxy=function(){return B2ObjectProxy.fixtureDef},Box2D.b2CircleShapeProxy=function(){return B2ObjectProxy.circleShape},Box2D.b2PolygonShapeProxy=function(){return B2ObjectProxy.polygonShape},Box2D.b2ChainShapeProxy=function(){return B2ObjectProxy.chainShape},Box2D.b2VerticesBufferProxy=function(e){var t=B2ObjectProxy.verticesBuffer[e];return t?t:(B2ObjectProxy.verticesBuffer[e]=t=Box2D.allocate(e*8,"float",Box2D.ALLOC_STACK),t)};var O=qc.defineBehaviour("qc.Box2D.Body",qc.Behaviour,function(){this.gameObject.body=this,this.gameObject.world=this.game.phaser.physics.box2d;var e=this.gameObject._body;e||(e=this.gameObject._body={}),e.fixture=[{type:qc.Box2D.Body.FIXTURE_TYPE.POLYGON,density:1,friction:.1,restitution:.2,sensor:!1}],e.type=qc.Box2D.Body.TYPE.STATIC,e.isAwake=!0,e.bullet=!1,e.fixedRotation=!1,e.angularVelocity=0,e.angularDamping=0,e.linearVelocity=new qc.Point(0,0),e.linearDamping=0,e.gravityScale=1,this.onContact=new qc.Signal,this.onPreSolve=new qc.Signal,this.onPostSolve=new qc.Signal,this.onBodyCreated=new qc.Signal,this.onFixtureChanged=new qc.Signal},{type:qc.Serializer.INT,isAwake:qc.Serializer.BOOLEAN,bullet:qc.Serializer.BOOLEAN,angularVelocity:qc.Serializer.NUMBER,angularDamping:qc.Serializer.NUMBER,fixedRotation:qc.Serializer.BOOLEAN,linearDamping:qc.Serializer.BOOLEAN,linearVelocity:qc.Serializer.POINT,gravityScale:qc.Serializer.NUMBER,fixture:{get:function(e,t){var n=e.gameObject._body,r=n.fixture.length,i=new Array(r);for(var s=0;s<r;s++){var o=n.fixture[s];i[s]={type:o.type,density:o.density,friction:o.friction,restitution:o.restitution,sensor:o.sensor}}return i},set:function(e,t){var n=e.gameObject._body,r=t.length,i=n.fixture=new Array(r);for(var s=0;s<r;s++){var o=t[s];i[s]={type:o.type,density:o.density,friction:o.friction,restitution:o.restitution,sensor:o.sensor}}}}});O.TYPE={},O.TYPE.STATIC=0,O.TYPE.KINEMATIC=1,O.TYPE.DYNAMIC=2,O.FIXTURE_TYPE={},O.FIXTURE_TYPE.POLYGON=0,O.FIXTURE_TYPE.CIRCLE=1,O.FIXTURE_TYPE.CHAIN=2,O.prototype.awake=function(){},O.prototype.update=function(){if(!this.enable)return;this.gameObject.b2Body||this.createBody()},O.prototype._serializeFixtureShape=function(e){var t,n;switch(e.type){case qc.Box2D.Body.FIXTURE_TYPE.CIRCLE:return[e.radius,e.center.x,e.center.y];case qc.Box2D.Body.FIXTURE_TYPE.POLYGON:case qc.Box2D.Body.FIXTURE_TYPE.CHAIN:n=e.vertices.length;var r=new Array(n*2);for(t=0;t<n;t++)r[t*2]=e.vertices[t].x,r[t*2+1]=e.vertices[t].y;return r}return[]},O.prototype._restoreFixtureShape=function(e,t){var n,r;switch(e.type){case qc.Box2D.Body.FIXTURE_TYPE.CIRCLE:e.radius=t[0],e.center=new qc.Point(t[1],t[2]);break;case qc.Box2D.Body.FIXTURE_TYPE.POLYGON:case qc.Box2D.Body.FIXTURE_TYPE.CHAIN:r=t.length/2,e.vertices=new Array(r);for(n=0;n<r;n++)e.vertices[n]=new qc.Point(verts[n*2],verts[n*2+1])}},O.prototype.onEnable=function(){},O.prototype.onDisable=function(){this.removeBody()},O.prototype.createBody=function(){var e=new Box2D.b2BodyDef,t=this,n=t.gameObject,r=n._body;switch(r.type){case qc.Box2D.Body.TYPE.DYNAMIC:e.set_type(Box2D.b2_dynamicBody);break;case qc.Box2D.Body.TYPE.KINEMATIC:e.set_type(Box2D.b2_kinematicBody);break;default:e.set_type(Box2D.b2_staticBody)}e.set_awake(r.isAwake),e.set_bullet(r.bullet),e.set_angularVelocity(r.angularVelocity),e.set_angularDamping(r.angularDamping),e.set_fixedRotation(r.fixedRotation),e.set_linearDamping(r.linearDamping),e.set_linearVelocity(Box2D.Vec2Proxy(r.linearVelocity.x,r.linearVelocity.y)),e.set_gravityScale(r.gravityScale);var i,s,o;if(t.game.box2d.flatten)i=n.x,s=n.y,o=n.rotation;else{var u=n.getWorldPosition();i=u.x,s=u.y,o=n.getWorldRotation()}e.set_position(Box2D.Vec2Proxy(t.game.box2d.pixelToMeter(u.x),t.game.box2d.pixelToMeter(u.y))),e.set_angle(o),r.lastTransform={rotation:o,x:i,y:s};var a=t.game.box2d.createBody(e);n.b2Body=a,a.behaviour=t,a.gameObject=n,t.resetFixtureShape(),t.onBodyCreated.dispatch(n)},O.prototype.removeBody=function(){this.gameObject.world.destroyBody(this.gameObject),this.gameObject.b2Body=null},O.prototype.loadFixtures=function(){var e=this.gameObject,t=e.b2Body;if(!t)return;var n=e._body.fixture;if(!n||!n.length)return;var r=n.length;for(var i=0;i<r;i++)this._loadFixture(e.world,t,n[i]);this.onFixtureChanged.dispatch(e)},O.prototype.setPolygonVertices=function(e,t){var n=e.length;if(!n)return;var r,i,s=e[0];if(typeof s.x=="number"&&typeof s.y=="number")r=e;else{r=new Array(n/2);for(i=0;i<n/2;i++)r[i]={x:e[i*2],y:e[i*2+1]}}if(!t){var o=this.gameObject.getWorldScale();for(i=0,n=r.length;i<n;i++)r[i].x/=o.x,r[i].y/=o.y}this.gameObject.body.customPolygon=r,this.resetFixtureShape()},O.prototype.resetFixtureShape=function(){this.clearFixtures();var e=this.gameObject,t=e.b2Body,n=e.getWorldScale(),r=e._body.fixture[0],i=e.body.customPolygon,s,o,u;if(i){u=i.length,s=new Array(i.length);for(o=0;o<u;o++)s[o]=new qc.Point(i[o].x*n.x,i[o].y*n.y)}else{s=qc.Bounds.getCorners(e,0,!1,0,e);for(o=0,u=s.length;o<u;o++)s[o].x*=n.x,s[o].y*=n.y}if(r.type===qc.Box2D.Body.FIXTURE_TYPE.POLYGON)r.vertices=s;else if(r.type===qc.Box2D.Body.FIXTURE_TYPE.CIRCLE){var a=s[0],f=s[2];r.center=new qc.Point((a.x+f.x)/2,(a.y+f.y)/2),r.radius=Math.max(Math.abs(a.x-f.x)/2,Math.abs(a.y-f.y)/2)}this.loadFixtures(),e._body.pivotX=e.pivotX,e._body.pivotY=e.pivotY,e._body.width=e.width,e._body.height=e.height;if(!e.parent||e.parent===e.game.world||e.game.box2d.flatten)e._body.scaleSqrX=e.scaleX*e.scaleX,e._body.scaleSqrY=e.scaleY*e.scaleY;else{var l=e.worldTransform;e._body.scaleSqrX=l.a*l.a+l.b*l.b,e._body.scaleSqrY=l.c*l.c+l.d*l.d}},O.prototype.bodyPreUpdate=function(){var e=this.gameObject;if(!e.worldVisible&&this.gameObject.b2Body){this.removeBody();return}var t=e._body,n=t.lastTransform,r,i,s,o,u;if(!e.parent||e.parent===e.game.world||e.game.box2d.flatten)s=e.rotation,r=e.x,i=e.y,o=e.scaleX*e.scaleX,u=e.scaleY*e.scaleY;else{var a=e.worldTransform;s=Math.atan2(a.b,a.a),r=a.tx,i=a.ty,o=a.a*a.a+a.b*a.b,u=a.c*a.c+a.d*a.d}var f=Math.abs(r-n.x)>.01||Math.abs(i-n.y)>.01,l=Math.abs(s-n.rotation)>1e-4,c=Math.abs(o-t.scaleSqrX)>.001||Math.abs(u-t.scaleSqrY)>.001,h=e.phaser.anchor||{},p=h.x!==t.pivotX||h.y!==t.pivotY,d=e._width!==t.width||e._height!==t.height;(c||p||d)&&this.resetFixtureShape();if(f||l)e._body.lastTransform={rotation:s,x:r,y:i},e.b2Body.SetTransform(Box2D.Vec2Proxy(e.game.box2d.pixelToMeter(r),e.game.box2d.pixelToMeter(i)),s)},O.prototype.bodyPostUpdate=function(){var e=this.gameObject.b2Body;if(!e)return;if(this.gameObject._body.type===qc.Box2D.Body.TYPE.STATIC)return;var t=e.GetPosition(),n=t.get_x(),r=t.get_y();if(isNaN(n)||isNaN(r))return;var i=this.gameObject,s=i.world,o=s.meterToPixel(n),u=s.meterToPixel(r),a=e.GetAngle();i._body.lastTransform={rotation:a,x:o,y:u};var f=i.parent;if(!f||f===i.game.world||s.flatten){i.x=o,i.y=u,i.rotation=a;return}var l=i.phaser.worldTransform,c=Math.cos(a),h=Math.sin(a),p=i.parent.worldTransform,d,v;if(Math.abs(l.b/l.a-h/c)<1e-4)d=p.toArray(!0),v=[],this.game.math.invert(v,d),this.game.math.multiply(v,v,[l.a,l.b,0,l.c,l.d,0,o,u,1]),i.x=v[6],i.y=v[7];else{var m=i.getWorldScale(),g=m.x,y=m.y;d=p.toArray(!0),v=[],this.game.math.invert(v,d),this.game.math.multiply(v,v,[c*g,h*g,0,-h*y,c*y,0,o,u,1]),i.rotation=Math.atan2(v[1],v[0]),i.x=v[6],i.y=v[7]}},O.prototype.applyForce=function(e,t){var n=this.gameObject.b2Body;n.ApplyForce(Box2D.Vec2Proxy(-e,-t),n.GetWorldCenter(),!0)},O.prototype.contains=function(e,t){var n=Box2D.Vec2Proxy(this.gameObject.world.pixelToMeter(e),this.gameObject.world.pixelToMeter(t)),r=this.gameObject.b2Body;for(var i=r.GetFixtureList();i.e;i=i.GetNext())if(i.TestPoint(n))return!0;return!1},O.prototype._loadFixture=function(e,t,n){var r=Box2D.b2FixtureDefProxy();r.set_density(1*n.density||0),r.set_friction(n.friction||0),r.set_restitution(n.restitution||0),r.set_isSensor(n.sensor||!1);var i;switch(n.type){case qc.Box2D.Body.FIXTURE_TYPE.CIRCLE:i=Box2D.b2CircleShapeProxy(),i.set_m_radius(e.pixelToMeter(n.radius||0)),n.center?i.set_m_p(Box2D.Vec2Proxy(e.pixelToMeter(n.center.x),e.pixelToMeter(n.center.y))):i.set_m_p(Box2D.Vec2Proxy(0,0));break;case qc.Box2D.Body.FIXTURE_TYPE.POLYGON:case qc.Box2D.Body.FIXTURE_TYPE.CHAIN:n.type===qc.Box2D.Body.FIXTURE_TYPE.POLYGON?i=Box2D.b2PolygonShapeProxy():i=Box2D.b2ChainShapeProxy();var s=n.vertices,o=Box2D.b2VerticesBufferProxy(s.length),u=0;for(var a=0,f=s.length;a<f;a++)Box2D.setValue(o+u,e.pixelToMeter(s[a].x),"float"),Box2D.setValue(o+(u+4),e.pixelToMeter(s[a].y),"float"),u+=8;var l=Box2D.wrapPointer(o,Box2D.b2Vec2);n.type===qc.Box2D.Body.FIXTURE_TYPE.POLYGON?i.Set(l,s.length):i.CreateChain(l,s.length)}r.set_shape(i),t.CreateFixture(r)},O.prototype.clearFixtures=function(){var e=[],t,n=this.gameObject.b2Body;for(t=n.GetFixtureList();t.e;t=t.GetNext())e.push(t);var r,i=e.length;for(r=0;r<i;r++)n.DestroyFixture(e[r])},O.prototype._getBox2DFilter=function(){var e=this.gameObject.b2Body;if(!e)return null;var t=e.GetFixtureList();return t?t.GetFilterData():null},O.prototype._getBox2DFilters=function(){var e=this.gameObject.b2Body;if(!e)return null;var t=[],n;for(n=e.GetFixtureList();n.e;n=n.GetNext())t.push(n.GetFilterData());return t},O.prototype.removeFixture=function(e){var t=this.gameObject.b2Body;return e.GetBody()!==t?!1:(t.DestroyFixture(e),!0)},t.defineProperties(O.prototype,{type:{get:function(){return this.gameObject._body.type},set:function(e){this.gameObject._body.type=e;var t=this.gameObject.b2Body;if(!t)return;switch(e){case qc.Box2D.Body.TYPE.DYNAMIC:t.SetType(Box2D.b2_dynamicBody);break;case qc.Box2D.Body.TYPE.KINEMATIC:t.SetType(Box2D.b2_kinematicBody);break;default:t.SetType(Box2D.b2_staticBody)}}},isAwake:{get:function(){return this.gameObject._body.isAwake},set:function(e){this.gameObject._body.isAwake=e;var t=this.gameObject.b2Body;t&&t.SetAwake(e)}},bullet:{get:function(){return this.gameObject._body.bullet},set:function(e){this.gameObject._body.bullet=e;var t=this.gameObject.b2Body;t&&t.SetBullet(e)}},angularVelocity:{get:function(){return this.gameObject.b2Body?this.gameObject.b2Body.GetAngularVelocity():this.gameObject._body.angularVelocity},set:function(e){this.gameObject._body.angularVelocity=e;var t=this.gameObject.b2Body;t&&t.SetAngularVelocity(e)}},angularDamping:{get:function(){return this.gameObject._body.angularDamping},set:function(e){this.gameObject._body.angularDamping=e;var t=this.gameObject.b2Body;t&&t.SetAngularDamping(e)}},fixedRotation:{get:function(){return this.gameObject._body.fixedRotation},set:function(e){this.gameObject._body.fixedRotation=e;var t=this.gameObject.b2Body;t&&t.SetFixedRotation(e)}},linearDamping:{get:function(){return this.gameObject._body.linearDamping},set:function(e){this.gameObject._body.linearDamping=e;var t=this.gameObject.b2Body;t&&t.SetLinearDamping(e)}},linearVelocity:{get:function(){var e=this.gameObject.b2Body;if(e){var t=e.GetLinearVelocity();return new qc.Point(t.get_x(),t.get_y())}return this.gameObject._body.linearVelocity},set:function(e){this.gameObject._body.linearVelocity=e;var t=this.gameObject.b2Body;t&&t.SetLinearVelocity(Box2D.Vec2Proxy(e.x,e.y))}},gravityScale:{get:function(){return this.gameObject._body.gravityScale},set:function(e){this.gameObject._body.gravityScale=e;var t=this.gameObject.b2Body;t&&t.SetGravityScale(e)}},density:{get:function(){var e=this.gameObject._body.fixture;return!e||!e.length?0:e[0].density},set:function(e){var t=this.gameObject._body.fixture,n,r=t.length;for(n=0;n<r;n++)t[n].density=e;var i,s=this.gameObject.b2Body;for(i=s.GetFixtureList();i.e;i=i.GetNext())i.SetDensity(e);s.ResetMassData()}},friction:{get:function(){var e=this.gameObject._body.fixture;return!e||!e.length?0:e[0].friction},set:function(e){var t=this.gameObject._body.fixture,n,r=t.length;for(n=0;n<r;n++)t[n].friction=e;var i,s=this.gameObject.b2Body;for(i=s.GetFixtureList();i.e;i=i.GetNext())i.SetFriction(e),i.Refilter()}},restitution:{get:function(){var e=this.gameObject._body.fixture;return!e||!e.length?0:e[0].restitution},set:function(e){var t=this.gameObject._body.fixture,n,r=t.length;for(n=0;n<r;n++)t[n].restitution=e;var i,s=this.gameObject.b2Body;for(i=s.GetFixtureList();i.e;i=i.GetNext())i.SetRestitution(e),i.Refilter()}},sensor:{get:function(){var e=this.gameObject._body.fixture;return!e||!e.length?0:e[0].sensor},set:function(e){var t=this.gameObject._body.fixture,n,r=t.length;for(n=0;n<r;n++)t[n].sensor=e;var i,s=this.gameObject.b2Body;for(i=s.GetFixtureList();i.e;i=i.GetNext())i.SetSensor(e),i.Refilter()}},fixtureType:{get:function(){var e=this.gameObject._body.fixture;return!e||!e.length?0:e[0].type},set:function(e){var t=this.gameObject._body.fixture,n,r=t.length;for(n=0;n<r;n++)t[n].type=e;this.resetFixtureShape()}},categoryBits:{get:function(){var e=this._getBox2DFilter();if(!e)return 1;e.get_categoryBits()},set:function(e){var t=this._getBox2DFilters();for(var n=0,r=t.length;n<r;n++){var i=t[n];i.set_categoryBits(e)}}},maskBits:{get:function(){var e=this._getBox2DFilter();if(!e)return-1;e.get_maskBits()},set:function(e){var t=this._getBox2DFilters();for(var n=0,r=t.length;n<r;n++){var i=t[n];i.set_maskBits(e)}}},groupIndex:{get:function(){var e=this._getBox2DFilter();if(!e)return 0;e.get_groupIndex()},set:function(e){var t=this._getBox2DFilters();for(var n=0,r=t.length;n<r;n++){var i=t[n];i.set_groupIndex(e)}}}});var M=qc.Box2D.ContactListener=function(e){var t=this;t.b2Listener=new Box2D.JSContactListener,this.b2Listener.BeginContact=function(e){t.handleContact(e,!0)},this.b2Listener.EndContact=function(e){t.handleContact(e,!1)},this.b2Listener.PreSolve=function(e,n){t.preSolve(e,n)},this.b2Listener.PostSolve=function(e,n){t.postSolve(e,n)},e.setContactListener(this.b2Listener)};M.prototype={},M.prototype.constructor=M,M.prototype.handleContact=function(e,t){e=Box2D.wrapPointer(e,Box2D.b2Contact);var n=e.GetFixtureA(),r=e.GetFixtureB(),i=n.GetBody(),s=r.GetBody(),o=i.gameObject,u=s.gameObject;if(!o||!u)return;var a={fixtureA:n,fixtureB:r,gameObjectA:o,gameObjectB:u,contact:e,isBeginning:t};o.body.onContact.dispatch(a),u.body.onContact.dispatch(a)},M.prototype.preSolve=function(e,t){e=Box2D.wrapPointer(e,Box2D.b2Contact);var n=e.GetFixtureA(),r=e.GetFixtureB(),i=n.GetBody(),s=r.GetBody(),o=i.gameObject,u=s.gameObject;if(!o||!u)return;var a={fixtureA:n,fixtureB:r,gameObjectA:o,gameObjectB:u,contact:e,oldManifold:t};o.body.onPreSolve.dispatch(a),u.body.onPreSolve.dispatch(a)},M.prototype.postSolve=function(e,t){e=Box2D.wrapPointer(e,Box2D.b2Contact);var n=e.GetFixtureA(),r=e.GetFixtureB(),i=n.GetBody(),s=r.GetBody(),o=i.gameObject,u=s.gameObject;if(!o||!u)return;var a={fixtureA:n,fixtureB:r,gameObjectA:o,gameObjectB:u,contact:e,impulse:t};o.body.onPostSolve.dispatch(a),u.body.onPostSolve.dispatch(a)};var _=qc.Box2D.DebugDraw=function(e){var t=this;t.b2Draw=new Box2D.JSDraw,t.world=e,t.enabled=!1,t.flags=_.FlagShapeBit|_.FlagJointBit|_.FlagAabbBit|_.FlagPairBit|_.FlagCenterOfMassBit,t.implementDraw(),e.setDebugDraw(t.b2Draw)};_.prototype={},_.prototype.constructor=_,_.FlagShapeBit=1,_.FlagJointBit=2,_.FlagAabbBit=4,_.FlagPairBit=8,_.FlagCenterOfMassBit=16,t.defineProperties(_.prototype,{enabled:{get:function(){return this._enabled},set:function(e){if(this._enabled===e)return;this._enabled=e,e||this._releaseCanvas()}},flags:{get:function(){return this.b2Draw.GetFlags()},set:function(e){this.b2Draw.SetFlags(e)}}}),_.prototype.render=function(){var e=this;if(!e._enabled)return;if(!e._initCanvas())return;var t=e._context,n=e._canvas;t.clearRect(0,0,n.width,n.height),t.save();var r=this.world.PTM,i=r*e.world.game.resolution;t.scale(i,i),t.lineWidth/=i,t.fillStyle="rgb(255, 255, 0)",e.world.drawDebugData(),t.restore()},_.prototype._initCanvas=function(){var e=this,t=e.world.game.canvas;if(!t)return!1;var n=e._canvas;n||(n=e._canvas=document.createElement("canvas"),e._context=e._canvas.getContext("2d"),t.parentNode.insertBefore(e._canvas,t),n.style.left=n.style.top="0px",n.style.position="absolute");if(n.style.width!==t.style.width||n.style.height!==t.style.height||n.width!==t.width||n.height!==t.height)n.width=t.width,n.height=t.height,n.style.width=t.style.width,n.style.height=t.style.height;return!0},_.prototype._releaseCanvas=function(){var e=this,t=e._canvas;if(!t)return;e._context=null,e._canvas=null,t.parentElement&&t.parentElement.removeChild(t)},_.prototype.setColorFromDebugDrawCallback=function(e){var t=Box2D.wrapPointer(e,Box2D.b2Color),n=t.get_r()*255|0,r=t.get_g()*255|0,i=t.get_b()*255|0,s=n+","+r+","+i,o=this._context;o.fillStyle="rgba("+s+",0.5)",o.strokeStyle="rgb("+s+")"},_.prototype.drawSegment=function(e,t){var n=Box2D.wrapPointer(e,Box2D.b2Vec2),r=Box2D.wrapPointer(t,Box2D.b2Vec2),i=this._context;i.beginPath(),i.moveTo(n.get_x(),n.get_y()),i.lineTo(r.get_x(),r.get_y()),i.stroke()},_.prototype.drawPolygon=function(e,t,n){var r=this._context,i,s;r.beginPath();for(i=0;i<t;i++)s=Box2D.wrapPointer(e+i*8,Box2D.b2Vec2),i===0?r.moveTo(s.get_x(),s.get_y()):r.lineTo(s.get_x(),s.get_y());r.closePath(),n&&r.fill(),r.stroke()},_.prototype.drawCircle=function(e,t,n,r){var i=Box2D.wrapPointer(e,Box2D.b2Vec2),s=i.get_x(),o=i.get_y(),u=Box2D.wrapPointer(n,Box2D.b2Vec2),a=this._context;a.beginPath(),a.arc(s,o,t,0,2*Math.PI,!1),r&&a.fill(),a.stroke();if(r){var f=Box2D.Vec2Proxy(s,o);u.set_x(u.get_x()*t),u.set_y(u.get_y()*t),f.op_add(u),a.beginPath(),a.moveTo(s,o),a.lineTo(f.get_x(),f.get_y()),a.stroke()}},_.prototype.drawTransform=function(e){var t=Box2D.wrapPointer(e,Box2D.b2Transform),n=t.get_p(),r=t.get_q(),i=this._context;i.save(),i.translate(n.get_x(),n.get_y()),i.scale(.5,.5),i.rotate(r.GetAngle()),i.lineWidth*=3,i.strokeStyle="rgb(192,0,0)",i.beginPath(),i.moveTo(0,0),i.lineTo(2,0),i.stroke(),i.strokeStyle="rgb(0,192,0)",i.beginPath(),i.moveTo(0,0),i.lineTo(0,2),i.stroke(),i.restore()},_.prototype.implementDraw=function(){var e=this,t=e.b2Draw;t.DrawSegment=function(t,n,r){e.setColorFromDebugDrawCallback(r),e.drawSegment(t,n)},t.DrawPolygon=function(t,n,r){e.setColorFromDebugDrawCallback(r),e.drawPolygon(t,n,!1)},t.DrawSolidPolygon=function(t,n,r){e.setColorFromDebugDrawCallback(r),e.drawPolygon(t,n,!0)},t.DrawCircle=function(t,n,r){e.setColorFromDebugDrawCallback(r);var i=Box2D.Vec2Proxy(0,0);e.drawCircle(t,n,i,!1)},t.DrawSolidCircle=function(t,n,r,i){e.setColorFromDebugDrawCallback(i),e.drawCircle(t,n,r,!0)},t.DrawTransform=function(t){e.drawTransform(t)}};var D=qc.Box2D.QueryAABB=function(e){var t=this;t.world=e,t.b2Callback=new Box2D.JSQueryCallback,t.hits=[],t.b2Callback.ReportFixture=function(e){return t.reportFixture(e)}};D.prototype={},D.prototype.constructor=D,D.prototype.reportFixture=function(e){var t=Box2D.wrapPointer(e,Box2D.b2Fixture),n=t.GetBody().gameObject;if(this.filter&&!this.filter.call(this.world,n,t))return!0;var r={fixture:t,gameObject:n};return this.findAll?(this.hits.push(r),!0):(this.hits=[r],!1)},D.prototype.check=function(e,t,n,r,i,s){var o=this;typeof i=="undefined"&&(i=!0),o.findAll=i,o.filter=s,o.hits=[];var u=o.world;e=u.pixelToMeter(e),t=u.pixelToMeter(t),n=u.pixelToMeter(n),r=u.pixelToMeter(r);var a=new Box2D.b2AABB,f=new Box2D.b2Vec2(e,t),l=new Box2D.b2Vec2(e+n,t+r);return a.set_lowerBound(f),a.set_upperBound(l),u.b2World.QueryAABB(o.b2Callback,a),Box2D.destroy(l),Box2D.destroy(f),Box2D.destroy(a),o.hits};var P=qc.Box2D.Raycast=function(e){var t=this;t.world=e,t.b2Callback=new Box2D.JSRayCastCallback,t.hits=[],t.closest=!0,t.b2Callback.ReportFixture=function(e,n,r,i){return t.reportFixture(e,n,r,i)}};P.prototype={},P.prototype.constructor=P,P.prototype.reportFixture=function(e,t,n,r){var i=Box2D.wrapPointer(e,Box2D.b2Fixture),s=i.GetBody().gameObject,o=this.world,u=Box2D.wrapPointer(t,Box2D.b2Vec2),a=new qc.Point(o.meterToPixel(u.get_x()),o.meterToPixel(u.get_y())),f=Box2D.wrapPointer(n,Box2D.b2Vec2),l=new qc.Point(f.get_x(),f.get_y());if(this.filter&&!this.filter.call(o,s,a,l,i))return-1;var c={fixture:i,point:a,normal:l,fraction:r,gameObject:s};return this.closest?(this.hits=[c],r):(this.hits.push(c),1)},P.prototype.check=function(e,t,n,r,i,s){var o=this;typeof i=="undefined"&&(i=!0),o.closest=i,o.filter=s,o.hits=[];var u=o.world;e=u.pixelToMeter(e),t=u.pixelToMeter(t),n=u.pixelToMeter(n),r=u.pixelToMeter(r);var a=new Box2D.b2Vec2(e,t),f=new Box2D.b2Vec2(n,r);return u.b2World.RayCast(o.b2Callback,a,f),Box2D.destroy(a),Box2D.destroy(f),o.hits};var H=Phaser.Physics.Arcade=function(e){this.game=e,this.gravity=new Phaser.Point,this.bounds=new Phaser.Rectangle(0,0,e.world.width,e.world.height),this.checkCollision={up:!0,down:!0,left:!0,right:!0},this.maxObjects=10,this.maxLevels=4,this.OVERLAP_BIAS=10,this.forceX=!1,this.sortDirection=Phaser.Physics.Arcade.LEFT_RIGHT,this.skipQuadTree=!0,this.isPaused=!1,this.quadTree=new Phaser.QuadTree(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels),this._total=0,this.setBoundsToWorld()};H.prototype={},H.prototype.constructor=H,H.SORT_NONE=0,H.LEFT_RIGHT=1,H.RIGHT_LEFT=2,H.TOP_BOTTOM=3,H.BOTTOM_TOP=4,H.prototype.gatherBody=function(e,t){e.body&&t.push(e.body);var n=e.children;if(n)for(var r=0,i=n.length;r<i;r++)this.gatherBody(n[r],t)},H.prototype.preUpdate=function(){var e=this.game,t=[];this.gatherBody(this.game.world,t);var n,r=t.length,i,s;for(n=0;n<r;n++)t[n].preUpdate();for(n=0;n<r;n++){s=t[n].qc;if(!s)continue;i=t[n].qc.getScript("qc.arcade.RigidBody"),i&&i.updateRigidbody()}for(n=0;n<r;n++)t[n].postUpdate()},H.prototype.setBounds=function(e,t,n,r){this.bounds.setTo(e,t,n,r)},H.prototype.setBoundsToWorld=function(){this.bounds.setTo(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height)},H.prototype.enable=function(e,t){typeof t=="undefined"&&(t=!0);var n=1;if(Array.isArray(e)){n=e.length;while(n--)e[n]instanceof Phaser.Group?this.enable(e[n].children,t):(this.enableBody(e[n]),t&&e[n].hasOwnProperty("children")&&e[n].children.length>0&&this.enable(e[n],!0))}else e instanceof Phaser.Group?this.enable(e.children,t):(this.enableBody(e),t&&e.hasOwnProperty("children")&&e.children.length>0&&this.enable(e.children,!0))},H.prototype.enableBody=function(e){e.hasOwnProperty("body")&&e.body===null&&(e.body=new Phaser.Physics.Arcade.Body(e))},H.prototype.updateMotion=function(e){var t=this.computeVelocity(0,e,e.angularVelocity,e.angularAcceleration,e.angularDrag,e.maxAngular)-e.angularVelocity;e.angularVelocity+=t,e.rotation+=e.angularVelocity*this.game.time.physicsElapsed,e.velocity.x=this.computeVelocity(1,e,e.velocity.x,e.acceleration.x,e.drag.x,e.maxVelocity.x),e.velocity.y=this.computeVelocity(2,e,e.velocity.y,e.acceleration.y,e.drag.y,e.maxVelocity.y)},H.prototype.computeVelocity=function(e,t,n,r,i,s){return typeof s=="undefined"&&(s=1e4),e===1&&t.allowGravity?n+=(this.gravity.x+t.gravity.x)*this.game.time.physicsElapsed:e===2&&t.allowGravity&&(n+=(this.gravity.y+t.gravity.y)*this.game.time.physicsElapsed),r?n+=r*this.game.time.physicsElapsed:i&&(i*=this.game.time.physicsElapsed,n-i>0?n-=i:n+i<0?n+=i:n=0),n>s?n=s:n<-s&&(n=-s),n},H.prototype.overlap=function(e,t,n,r,i){n=n||null,r=r||null,i=i||n,this._total=0;if(!Array.isArray(e)&&Array.isArray(t))for(var s=0;s<t.length;s++)this.collideHandler(e,t[s],n,r,i,!0);else if(Array.isArray(e)&&!Array.isArray(t))for(var s=0;s<e.length;s++)this.collideHandler(e[s],t,n,r,i,!0);else if(Array.isArray(e)&&Array.isArray(t))for(var s=0;s<e.length;s++)for(var o=0;o<t.length;o++)this.collideHandler(e[s],t[o],n,r,i,!0);else this.collideHandler(e,t,n,r,i,!0);return this._total>0},H.prototype.collide=function(e,t,n,r,i){n=n||null,r=r||null,i=i||n,this._total=0;if(!Array.isArray(e)&&Array.isArray(t))for(var s=0;s<t.length;s++)this.collideHandler(e,t[s],n,r,i,!1);else if(Array.isArray(e)&&!Array.isArray(t))for(var s=0;s<e.length;s++)this.collideHandler(e[s],t,n,r,i,!1);else if(Array.isArray(e)&&Array.isArray(t))for(var s=0;s<e.length;s++)for(var o=0;o<t.length;o++)this.collideHandler(e[s],t[o],n,r,i,!1);else this.collideHandler(e,t,n,r,i,!1);return this._total>0},H.prototype.sort=function(e){this.sortDirection===Phaser.Physics.Arcade.LEFT_RIGHT?e._hash.sort(function(e,t){return!e.body||!t.body?-1:e.body.x-t.body.x}):this.sortDirection===Phaser.Physics.Arcade.RIGHT_LEFT?e._hash.sort(function(e,t){return!e.body||!t.body?-1:t.body.x-e.body.x}):this.sortDirection===Phaser.Physics.Arcade.TOP_BOTTOM?e._hash.sort(function(e,t){return!e.body||!t.body?-1:e.body.y-t.body.y}):this.sortDirection===Phaser.Physics.Arcade.BOTTOM_TOP&&e._hash.sort(function(e,t){return!e.body||!t.body?-1:t.body.y-e.body.y})},H.prototype.collideHandler=function(e,t,n,r,i,s){if(!e||!t||!e.exists||!t.exists)return;this.sortDirection!==Phaser.Physics.Arcade.SORT_NONE&&(e.physicsType===Phaser.GROUP&&this.sort(e),t.physicsType===Phaser.GROUP&&this.sort(t)),this.collideSpriteVsSprite(e,t,n,r,i,s)},H.prototype.collideSpriteVsSprite=function(e,t,n,r,i,s){return!e.body||!t.body?!1:(this.separate(e.body,t.body,r,i,s)&&(n&&n.call(i,e,t),this._total++),!0)},H.prototype.separate=function(e,t,n,r,i){if(!e.enable||!t.enable||!this.intersects(e,t))return!1;if(n&&n.call(r,e.sprite,t.sprite)===!1)return!1;var s=!1;return this.forceX||Math.abs(this.gravity.y+e.gravity.y)<Math.abs(this.gravity.x+e.gravity.x)?s=this.separateX(e,t,i)||this.separateY(e,t,i):s=this.separateY(e,t,i)||this.separateX(e,t,i),i?!0:s},H.prototype.intersects=function(e,t){var n=Math.max(e.ccdIterations,t.ccdIterations);if(n<=0)return!(e.right<=t.x||e.bottom<=t.y||e.x>=t.right||e.y>=t.bottom);var r=e._dx/(n+2),i=t._dx/(n+2),s=e._dy/(n+2),o=t._dy/(n+2),u=Array(n+1),a=Array(n+1);u[n]=[e.x,e.right,e.y,e.bottom],a[n]=[t.x,t.right,t.y,t.bottom];for(var f=n-1;f>=0;f--)u[f]=[u[f+1][0]-r,u[f+1][1]-r,u[f+1][2]-s,u[f+1][3]-s];for(f=n-1;f>=0;f--)a[f]=[a[f+1][0]-i,a[f+1][1]-i,a[f+1][2]-o,a[f+1][3]-o];for(f=0;f<=n;f++){if(u[f][1]<=a[f][0]||u[f][3]<=a[f][2]||u[f][0]>=a[f][1]||u[f][2]>=a[f][3])continue;return e.x=u[f][0],e.y=u[f][2],t.x=a[f][0],t.y=a[f][2],!0}return!1},H.prototype.separateX=function(e,t,n){if(e.immovable&&t.immovable)return!1;var r=0;if(this.intersects(e,t)){var i=e.deltaAbsX()+t.deltaAbsX()+this.OVERLAP_BIAS;e.deltaX()===0&&t.deltaX()===0?(e.embedded=!0,t.embedded=!0):e.deltaX()>t.deltaX()?(r=e.right-t.x,r>i||e.checkCollision.right===!1||t.checkCollision.left===!1?r=0:(e.touching.none=!1,e.touching.right=!0,t.touching.none=!1,t.touching.left=!0)):e.deltaX()<t.deltaX()&&(r=e.x-t.width-t.x,-r>i||e.checkCollision.left===!1||t.checkCollision.right===!1?r=0:(e.touching.none=!1,e.touching.left=!0,t.touching.none=!1,t.touching.right=!0)),e.overlapX=r,t.overlapX=r;if(r!==0){if(n||e.customSeparateX||t.customSeparateX)return!0;var s=e.velocity.x,o=t.velocity.x;if(!e.immovable&&!t.immovable){r*=.5,e.x-=r,t.x+=r;var u=Math.sqrt(o*o*t.mass/e.mass)*(o>0?1:-1),a=Math.sqrt(s*s*e.mass/t.mass)*(s>0?1:-1),f=(u+a)*.5;u-=f,a-=f,e.velocity.x=f+u*e.bounce.x,t.velocity.x=f+a*t.bounce.x}else e.immovable?t.immovable||(t.x+=r,t.velocity.x=s-o*t.bounce.x,e.moves&&(t.y+=(e.y-e.prevY)*e.friction.y)):(e.x-=r,e.velocity.x=o-s*e.bounce.x,t.moves&&(e.y+=(t.y-t.prevY)*t.friction.y));return!0}}return!1},H.prototype.separateY=function(e,t,n){if(e.immovable&&t.immovable)return!1;var r=0;if(this.intersects(e,t)){var i=e.deltaAbsY()+t.deltaAbsY()+this.OVERLAP_BIAS;e.deltaY()===0&&t.deltaY()===0?(e.embedded=!0,t.embedded=!0):e.deltaY()>t.deltaY()?(r=e.bottom-t.y,r>i||e.checkCollision.down===!1||t.checkCollision.up===!1?r=0:(e.touching.none=!1,e.touching.down=!0,t.touching.none=!1,t.touching.up=!0)):e.deltaY()<t.deltaY()&&(r=e.y-t.bottom,-r>i||e.checkCollision.up===!1||t.checkCollision.down===!1?r=0:(e.touching.none=!1,e.touching.up=!0,t.touching.none=!1,t.touching.down=!0)),e.overlapY=r,t.overlapY=r;if(r!==0){if(n||e.customSeparateY||t.customSeparateY)return!0;var s=e.velocity.y,o=t.velocity.y;if(!e.immovable&&!t.immovable){r*=.5,e.y-=r,t.y+=r;var u=Math.sqrt(o*o*t.mass/e.mass)*(o>0?1:-1),a=Math.sqrt(s*s*e.mass/t.mass)*(s>0?1:-1),f=(u+a)*.5;u-=f,a-=f,e.velocity.y=f+u*e.bounce.y,t.velocity.y=f+a*t.bounce.y}else e.immovable?t.immovable||(t.y+=r,t.velocity.y=s-o*t.bounce.y,e.moves&&(t.x+=(e.x-e.prevX)*e.friction.x)):(e.y-=r,e.velocity.y=o-s*e.bounce.y,t.moves&&(e.x+=(t.x-t.prevX)*t.friction.x));return!0}}return!1},H.prototype.moveToObject=function(e,t,n,r){typeof n=="undefined"&&(n=60),typeof r=="undefined"&&(r=0);var i=Math.atan2(t.y-e.y,t.x-e.x);return r>0&&(n=this.distanceBetween(e,t)/(r/1e3)),e.body.velocity.x=Math.cos(i)*n,e.body.velocity.y=Math.sin(i)*n,i},H.prototype.velocityFromAngle=function(e,t,n){return typeof t=="undefined"&&(t=60),n=n||new Phaser.Point,n.setTo(Math.cos(this.game.math.degToRad(e))*t,Math.sin(this.game.math.degToRad(e))*t)},H.prototype.velocityFromRotation=function(e,t,n){return typeof t=="undefined"&&(t=60),n=n||new Phaser.Point,n.setTo(Math.cos(e)*t,Math.sin(e)*t)},H.prototype.accelerateToObject=function(e,t,n,r,i){typeof n=="undefined"&&(n=60),typeof r=="undefined"&&(r=1e3),typeof i=="undefined"&&(i=1e3);var s=this.angleBetween(e,t);return e.body.acceleration.setTo(Math.cos(s)*n,Math.sin(s)*n),e.body.maxVelocity.setTo(r,i),s},H.prototype.distanceBetween=function(e,t){var n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)},H.prototype.angleBetween=function(e,t){var n=t.x-e.x,r=t.y-e.y;return Math.atan2(r,n)},Phaser.Physics.Arcade.Body=function(e){this.sprite=e,this.qc=e._qc,this.game=e.game,this.type=Phaser.Physics.ARCADE,this.enable=!0,this.x=e.world.x,this.prevX=this.x,this.y=e.world.y,this.prevY=this.y,this.width=e.width,this.height=e.height,this.allowRotation=!0,this.rotation=e.rotation,this.preRotation=e.rotation,this.gravity=new Phaser.Point(0,0),this.ccdIterations=0,this.velocity=new Phaser.Point,this.newVelocity=new Phaser.Point(0,0),this.deltaMax=new Phaser.Point(0,0),this.acceleration=new Phaser.Point,this.drag=new Phaser.Point,this.allowGravity=!0,this.bounce=new Phaser.Point,this.maxVelocity=new Phaser.Point(1e4,1e4),this.friction=new Phaser.Point(1,0),this.angularVelocity=0,this.angularAcceleration=0,this.angularDrag=0,this.maxAngular=1e3,this.mass=1,this.angle=0,this.speed=0,this.facing=Phaser.NONE,this.immovable=!1,this.moves=!0,this.customSeparateX=!1,this.customSeparateY=!1,this.overlapX=0,this.overlapY=0,this.embedded=!1,this.collideWorldBounds=!1,this.checkCollision={none:!1,any:!0,up:!0,down:!0,left:!0,right:!0},this.touching={none:!0,up:!1,down:!1,left:!1,right:!1},this.wasTouching={none:!0,up:!1,down:!1,left:!1,right:!1},this.blocked={up:!1,down:!1,left:!1,right:!1},this.dirty=!1,this._reset=!0,this._sx=e.scale.x,this._spx=this._sx,this._sy=e.scale.y,this._spy=this._sy,this._dx=0,this._dy=0};var O=Phaser.Physics.Arcade.Body;O.prototype={},O.prototype.constructor=O,t.defineProperties(O.prototype,{right:{get:function(){return this.x+this.width}},bottom:{get:function(){return this.y+this.height}}}),O.prototype.updateBounds=function(e){var t=this.qc.worldTransform,n=t.a,r=t.d,i=this.qc.parent.worldTransform;this._spx=i.a,this._spy=i.d;if(e||n!==this._sx||r!==this._sy)this._sx=n,this._sy=r,this.width=Math.abs(n*this.qc._width),this.height=Math.abs(r*this.qc._height),this._reset=!0},O.prototype.preUpdate=function(){if(!this.enable||this.game.physics.arcade.isPaused)return;this.dirty=!0,this.wasTouching.none=this.touching.none,this.wasTouching.up=this.touching.up,this.wasTouching.down=this.touching.down,this.wasTouching.left=this.touching.left,this.wasTouching.right=this.touching.right,this.touching.none=!0,this.touching.up=!1,this.touching.down=!1,this.touching.left=!1,this.touching.right=!1,this.blocked.up=!1,this.blocked.down=!1,this.blocked.left=!1,this.blocked.right=!1,this.embedded=!1,this.updateBounds(),this._sx>=0?this.x=this.sprite.world.x-this.sprite.anchor.x*this.width:this.x=this.sprite.world.x-(1-this.sprite.anchor.x)*this.width,this._sy>=0?this.y=this.sprite.world.y-this.sprite.anchor.y*this.height:this.y=this.sprite.world.y-(1-this.sprite.anchor.y)*this.height,this.rotation=this.sprite.angle,this.preRotation=this.rotation;if(this._reset||this.sprite.fresh)this.prevX=this.x,this.prevY=this.y;if(this.moves){this.game.physics.arcade.updateMotion(this),this.newVelocity.set(this.velocity.x*this.game.time.physicsElapsed,this.velocity.y*this.game.time.physicsElapsed),this.x+=this.newVelocity.x*this._spx,this.y+=this.newVelocity.y*this._spy;if(this.x!==this.prevX||this.y!==this.prevY)this.speed=Math.sqrt(this.velocity.x*this.velocity.x+this.velocity.y*this.velocity.y),this.angle=Math.atan2(this.velocity.y,this.velocity.x);this.collideWorldBounds&&this.checkWorldBounds()}this._dx=this.x-this.prevX,this._dy=this.y-this.prevY,this._reset=!1},O.prototype.postUpdate=function(){if(!this.enable||!this.dirty)return;this.dirty=!1;var e=this.x-this.prevX,t=this.y-this.prevY;e<0?this.facing=Phaser.LEFT:e>0&&(this.facing=Phaser.RIGHT),t<0?this.facing=Phaser.UP:t>0&&(this.facing=Phaser.DOWN),this.moves&&(this._dx=e,this._dy=t,this.deltaMax.x!==0&&this._dx!==0&&(this._dx<0&&this._dx<-this.deltaMax.x?(this._dx=-this.deltaMax.x,this.x=this._dx+this.prevX):this._dx>0&&this._dx>this.deltaMax.x&&(this._dx=this.deltaMax.x,this.x=this._dx+this.prevX)),this.deltaMax.y!==0&&this._dy!==0&&(this._dy<0&&this._dy<-this.deltaMax.y?(this._dy=-this.deltaMax.y,this.y=this._dy+this.prevY):this._dy>0&&this._dy>this.deltaMax.y&&(this._dy=this.deltaMax.y,this.y=this._dy+this.prevY)),this._dx!==0&&(this.qc.x+=this._dx/this._spx),this._dy!==0&&(this.qc.y+=this._dy/this._spy),this._reset=!0),this.allowRotation&&(this.sprite.angle+=this.deltaZ()),this.prevX=this.x,this.prevY=this.y},O.prototype.destroy=function(){this.sprite.body=null,this.sprite=null,this.qc=null},O.prototype.checkWorldBounds=function(){if(this.x<this.game.physics.arcade.bounds.x&&this.game.physics.arcade.checkCollision.left&&this._dx<0){var e=this.sprite._qc;this.x=this.game.physics.arcade.bounds.x,this.velocity.x*=-this.bounce.x,this.blocked.left=!0}else if(this.right>this.game.physics.arcade.bounds.right&&this.game.physics.arcade.checkCollision.right&&this._dx>0){var e=this.sprite._qc;this.x=this.game.physics.arcade.bounds.right-this.width,this.velocity.x*=-this.bounce.x,this.blocked.right=!0}if(this.y<this.game.physics.arcade.bounds.y&&this.game.physics.arcade.checkCollision.up&&this._dy<0){var e=this.sprite._qc;this.y=this.game.physics.arcade.bounds.y,this.velocity.y*=-this.bounce.y,this.blocked.up=!0}else if(this.bottom>this.game.physics.arcade.bounds.bottom&&this.game.physics.arcade.checkCollision.down&&this._dy>0){var e=this.sprite._qc;this.y=this.game.physics.arcade.bounds.bottom-this.height,this.velocity.y*=-this.bounce.y,this.blocked.down=!0}},O.prototype.reset=function(e,t){this.velocity.set(0),this.acceleration.set(0),this.speed=0,this.angularVelocity=0,this.angularAcceleration=0,this._reset=!0},O.prototype.onFloor=function(){return this.blocked.down},O.prototype.onWall=function(){return this.blocked.left||this.blocked.right},O.prototype.deltaAbsX=function(){return this.deltaX()>0?this.deltaX():-this.deltaX()},O.prototype.deltaAbsY=function(){return this.deltaY()>0?this.deltaY():-this.deltaY()},O.prototype.deltaX=function(){return this.x-this.prevX},O.prototype.deltaY=function(){return this.y-this.prevY},O.prototype.deltaZ=function(){return this.rotation-this.preRotation};var B=qc.defineBehaviour("qc.arcade.RigidBody",qc.Behaviour,function(){var e=this;e.arcade=e.game.phaser.physics.arcade,e.phaser=e.gameObject.phaser,e._collide=[],e._overlap=[];if(!(e.gameObject instanceof qc.Sprite||e.gameObject instanceof qc.UIImage))throw new Error("Only Sprite or UIImage can attack RigidBody!");e.phaser.enableBody=!1,e.phaser.physicsBodyType=Phaser.Physics.ARCADE,e.arcade.enable(e.phaser,!1),e.phaser.body.enable=!1,e.phaser.body._qc=e},function(){return{mass:qc.Serializer.NUMBER,collideWorldBounds:qc.Serializer.BOOLEAN,allowRotation:qc.Serializer.BOOLEAN,allowGravity:qc.Serializer.BOOLEAN,velocity:qc.Serializer.POINT,maxVelocity:qc.Serializer.POINT,acceleration:qc.Serializer.POINT,drag:qc.Serializer.POINT,gravity:qc.Serializer.POINT,friction:qc.Serializer.POINT,angularVelocity:qc.Serializer.NUMBER,maxAngular:qc.Serializer.NUMBER,angularAcceleration:qc.Serializer.NUMBER,angularDrag:qc.Serializer.NUMBER,bounce:qc.Serializer.POINT,immovable:qc.Serializer.BOOLEAN,moves:qc.Serializer.BOOLEAN,checkCollision:qc.Serializer.MAPPING,tilePadding:qc.Serializer.POINT,collides:qc.Serializer.NODES,overlaps:qc.Serializer.NODES,ccdIterations:qc.Serializer.INT}});B.__menu="Plugins/Arcade/RigidBody",t.defineProperties(B.prototype,{mass:{get:function(){return this.phaser.body.mass},set:function(e){this.phaser.body.mass=e}},collideWorldBounds:{get:function(){return this.phaser.body.collideWorldBounds},set:function(e){this.phaser.body.collideWorldBounds=e}},allowRotation:{get:function(){return this.phaser.body.allowRotation},set:function(e){this.phaser.body.allowRotation=e}},allowGravity:{get:function(){return this.phaser.body.allowGravity},set:function(e){this.phaser.body.allowGravity=e}},velocity:{get:function(){return this.phaser.body.velocity},set:function(e){this.phaser.body.velocity=e}},maxVelocity:{get:function(){return this.phaser.body.maxVelocity},set:function(e){this.phaser.body.maxVelocity=e}},angularAcceleration:{get:function(){return this.phaser.body.angularAcceleration},set:function(e){this.phaser.body.angularAcceleration=e,this.gameObject._isTransformDirty=!0}},acceleration:{get:function(){return this.phaser.body.acceleration},set:function(e){this.phaser.body.acceleration=e}},drag:{get:function(){return this.phaser.body.drag},set:function(e){this.phaser.body.drag=e}},gravity:{get:function(){return this.phaser.body.gravity},set:function(e){this.phaser.body.gravity=e,this.gameObject._isTransformDirty=!0}},bounce:{get:function(){return this.phaser.body.bounce},set:function(e){this.phaser.body.bounce=e,this.gameObject._isTransformDirty=!0}},friction:{get:function(){return this.phaser.body.friction},set:function(e){this.phaser.body.friction=e,this.gameObject._isTransformDirty=!0}},angularVelocity:{get:function(){return this.phaser.body.angularVelocity},set:function(e){this.phaser.body.angularVelocity=e,this.gameObject._isTransformDirty=!0}},angularDrag:{get:function(){return this.phaser.body.angularDrag},set:function(e){this.phaser.body.angularDrag=e,this.gameObject._isTransformDirty=!0}},maxAngular:{get:function(){return this.phaser.body.maxAngular},set:function(e){this.phaser.body.maxAngular=e}},angle:{get:function(){return this.phaser.body.angle}},speed:{get:function(){return this.phaser.body.speed}},immovable:{get:function(){return this.phaser.body.immovable},set:function(e){this.phaser.body.immovable=e}},moves:{get:function(){return this.phaser.body.moves},set:function(e){this.phaser.body.moves=e,this.gameObject._isTransformDirty=!0}},overlapX:{get:function(){return this.phaser.body.overlapX}},overlapY:{get:function(){return this.phaser.body.overlapY}},embedded:{get:function(){return this.phaser.body.embedded},set:function(e){this.phaser.body.embedded=e}},checkCollision:{get:function(){return this.phaser.body.checkCollision},set:function(e){this.phaser.body.checkCollision=e}},touching:{get:function(){return this.phaser.body.touching}},wasTouching:{get:function(){return this.phaser.body.wasTouching}},blocked:{get:function(){return this.phaser.body.blocked},set:function(e){this.phaser.body.blocked=e}},tilePadding:{get:function(){return this.phaser.body.tilePadding},set:function(e){this.phaser.body.tilePadding=e}},onFloor:{get:function(){return this.phaser.body.onFloor()}},onWall:{get:function(){return this.phaser.body.onWall()}},deltaX:{get:function(){return this.phaser.body.deltaX()}},deltaY:{get:function(){return this.phaser.body.deltaY()}},deltaZ:{get:function(){return this.phaser.body.deltaZ()}},collides:{get:function(){return this._collide},set:function(e){this._collide=e}},overlaps:{get:function(){return this._overlap},set:function(e){this._overlap=e}},ccdIterations:{get:function(){return this.phaser.body.ccdIterations},set:function(e){this.phaser.body.ccdIterations=e}}}),B.prototype.awake=function(){var e=this.phaser.body;e.updateBounds(!0)},B.prototype.onEnable=function(){var e=this;e.phaser.enableBody=!0,e.phaser.body.enable=!0},B.prototype.onDisable=function(){var e=this;e.phaser.enableBody=!1,e.phaser.body.enable=!1},B.prototype.updateRigidbody=function(){var e=this;for(var t=0;t<e._collide.length;t++){var r=e._collide[t];if(!r||r._destroy)continue;e.arcade.collide(e.phaser,r.phaser,e._collideCallback,n,e)}for(var t=0;t<e._overlap.length;t++){var r=e._overlap[t];if(!r||r._destroy)continue;e.arcade.overlap(e.phaser,r.phaser,e._overlapCallback,n,e)}},B.prototype.reset=function(){this._collide=[],this._overlap=[],this.phaser.body.reset(this.gameObject.x,this.gameObject.y)},B.prototype.addCollide=function(e){this._collide.indexOf(e)===-1&&this._collide.push(e)},B.prototype.removeCollide=function(e){var t=this._collide.indexOf(e);t!==-1&&this._collide.splice(t,1)},B.prototype.addOverlap=function(e){this._overlap.indexOf(e)===-1&&this._overlap.push(e)},B.prototype.removeOverlap=function(e){var t=this._overlap.indexOf(e);t!==-1&&this._overlap.splice(t,1)},B.prototype.moveToObject=function(e,t,n){return this.arcade.moveToObject(this.phaser,e,t,n)},B.prototype.velocityFromAngle=function(e,t,n){return this.arcade.velocityFromAngle(e,t,n)},B.prototype.velocityFromRotation=function(e,t,n){return this.arcade.velocityFromRotation(e,t,n)},B.prototype.accelerateToObject=function(e,t,n,r){return this.arcade.accelerateToObject(this.phaser,e,t,n,r)},B.prototype.distanceBetween=function(e){return this.arcade.distanceBetween(this.phaser,e)},B.prototype.angleBetween=function(e){return this.arcade.angleBetween(this.phaser,e)},B.prototype._collideCallback=function(e,t){this.gameObject._sendMessage("onCollide",!1,e._qc,t._qc)},B.prototype._overlapCallback=function(e,t){this.gameObject._sendMessage("onOverlap",!1,e._qc,t._qc)};var j=qc.defineBehaviour("qc.WeChat",qc.Behaviour,function(){var e=this;e.shareAppId="",e.wxAppId="",e.webAppId="",e.domain="",e.gameDomain="",e.extendParams="",e.redirectCurrentUrl=!0,e.debug=!1,e.wx=new F,e.onStartLogin=new qc.Signal,e.onLogin=new qc.Signal,e.sessionExpired=new qc.Signal,e.user=null,e.status=""},{shareAppId:qc.Serializer.STRING,wxAppId:qc.Serializer.STRING,webAppId:qc.Serializer.STRING,domain:qc.Serializer.STRING,gameDomain:qc.Serializer.STRING,extendParams:qc.Serializer.STRING,redirectCurrentUrl:qc.Serializer.BOOLEAN,debug:qc.Serializer.BOOLEAN});j.__menu="Plugins/WeChat",j.prototype.awake=function(){var t=this;if(!t.domain)return;var n=t.domain+"index.php?cmd=sign&appid="+t.shareAppId+"&url="+encodeURIComponent(e.location.href);t.game.log.trace("开始请求微信分享的签名信息：{0}",n),qc.AssetUtil.get(n,function(e){t.game.log.trace("获取签名成功："+e),t.parseSign(e)},function(){console.error("获取签名信息失败")}),t.loadWXLib(),t._code=this.getParam("code"),t._state=this.getParam("state"),t._code&&(t.status="loggingIn",t.game.timer.add(1,function(){t.requestToken(t._code)}))},j.prototype.onDestroy=function(){this.timer&&this.game.timer.remove(this.timer)},j.prototype.login=function(){if(this.isWeChat()){this.loginInWX();return}this.loginInWeb()},j.prototype.loginInWX=function(){var t="",n=e.location.origin+e.location.pathname;this.redirectCurrentUrl?t="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+this.wxAppId+"&redirect_uri="+encodeURIComponent(n)+"&response_type=code&scope=snsapi_userinfo&state=weixin#wechat_redirect":t="https://open.weixin.qq.com/connect/oauth2/authorize?appid="+this.wxAppId+"&redirect_uri="+encodeURIComponent(this.domain+"code.php")+"&response_type=code&scope=snsapi_userinfo"+"&state="+encodeURIComponent(n)+"#wechat_redirect",e.location.href=t},j.prototype.loginInWeb=function(){var t="",n=e.location.origin+e.location.pathname;this.redirectCurrentUrl?t="https://open.weixin.qq.com/connect/qrconnect?appid="+this.webAppId+"&redirect_uri="+encodeURIComponent(n)+"&response_type=code&scope=snsapi_login&state=pc#wechat_redirect":t="https://open.weixin.qq.com/connect/qrconnect?appid="+this.webAppId+"&redirect_uri="+encodeURIComponent(this.domain+"code.php")+"&response_type=code&scope=snsapi_login"+"&state="+encodeURIComponent(n)+"#wechat_redirect",e.location.href=t},j.prototype.parseSign=function(e){var t=this,n=JSON.parse(e);t.timeStamp=n.timestamp,t.nonceStr=n.nonceStr,t.signature=n.signature;if(!t.jweixin){t.game.timer.add(500,function(){t.parseSign(e)});return}t.game.log.trace("开始初始化微信接口"),t.wx.debug=t.debug,t.wx.init({timeStamp:t.timeStamp,nonceStr:t.nonceStr,signature:t.signature,appId:t.shareAppId},function(){t.game.log.trace("初始化微信接口完成。")})},j.prototype.loadWXLib=function(){var e=this,t="http://res.wx.qq.com/open/js/jweixin-1.0.0.js",n=document.createElement("script");n.onerror=function(){console.error("加载jweixin库失败")},n.onload=function(){e.game.log.trace("微信接口下载完成"),e.jweixin=!0},n.setAttribute("src",t),n.setAttribute("type","text/javascript"),document.getElementsByTagName("head")[0].appendChild(n)},j.prototype.isWeChat=function(){var t=e.navigator.userAgent.toLowerCase();return t.match(/MicroMessenger/i)=="micromessenger"},j.prototype.getParam=function(e){var t=new RegExp("(\\?|#|&)"+e+"=([^&#]*)(&|#|$)"),n=location.href.match(t);return decodeURIComponent(n?n[2]:"")},j.prototype.requestToken=function(e){var t=this,n=t.gameDomain+"login.php?code="+e;t.isWeChat()||(n+="&web=1"),n+="&extendParams="+t.extendParams,t.onStartLogin.dispatch(),qc.AssetUtil.get(n,function(e){var n=JSON.parse(e);if(n.error){t.game.log.error("换取token失败，重新请求登录"),t.login();return}t.game.log.trace("登录成功：{0}",e),t.status="loggedIn",t.user=n,t.onLogin.dispatch(),t.timer=t.game.timer.loop(3e5,t.refreshToken,t)})},j.prototype.refreshToken=function(){var e=this,t=e.gameDomain+"refresh.php";e.isWeChat()||(t+="?web=1"),qc.AssetUtil.get(t,function(t){var n=JSON.parse(t);if(n.error){e.status="expired",e.game.timer.remove(e.timer),delete e.timer,e.sessionExpired.dispatch();return}e.game.log.trace("刷新Access Token成功。")})};var F=qc.WX=function(){var e=this;e.title="",e.imgUrl="",e.desc="",e.url="",e.sign=null,e.ready=!1,e.debug=!1};F.prototype={},F.prototype.constructor=F,F.prototype.init=function(t,n){var r=this;r.sign=t;if(!e.wx)return;wx.config({debug:r.debug,appId:t.appId,timestamp:t.timeStamp,nonceStr:t.nonceStr,signature:t.signature,jsApiList:["onMenuShareTimeline","onMenuShareQQ","onMenuShareQZone","onMenuShareAppMessage","onMenuShareWeibo","startRecord","stopRecord","onVoiceRecordEnd","playVoice","pauseVoice","stopVoice","onVoicePlayEnd","uploadVoice","downloadVoice","chooseImage","previewImage","uploadImage","downloadImage","translateVoice","getNetworkType","openLocation","getLocation","closeWindow","scanQRCode"]}),wx.ready(function(){r.ready=!0,n&&n()})},F.prototype.share=function(e,t,n,r,i){var s=this;s.title=e,s.imgUrl=t,s.desc=n,s.url=r,s.callback=i;if(!s.ready){console.error("尚未初始化完成");return}var o={title:s.title,desc:s.desc,link:s.url,imgUrl:s.imgUrl,success:function(){i&&i()},cancel:function(){}};wx.onMenuShareTimeline(o),wx.onMenuShareAppMessage(o),wx.onMenuShareQQ(o),wx.onMenuShareWeibo(o),wx.onMenuShareQZone(o)},F.prototype.chooseImage=function(e,t,n,r){var i=this;if(!i.ready){console.error("尚未初始化完成");return}t||(t=["original","compressed"]),n||(n=["album","camera"]),wx.chooseImage({count:e,sizeType:t,sourceType:n,success:function(e){r&&r(e.localIds)}})},F.prototype.previewImage=function(e,t){var n=this;if(!n.ready){console.error("尚未初始化完成");return}e=e||"",t=t||[],wx.previewImage({current:e,urls:t})},F.prototype.uploadImage=function(e,t,n){var r=this;if(!r.ready){console.error("尚未初始化完成");return}wx.uploadImage({localId:e,isShowProgressTips:t?1:0,success:function(e){n&&n(e.serverId)}})},F.prototype.downloadImage=function(e,t,n){var r=this;if(!r.ready){console.error("尚未初始化完成");return}wx.downloadImage({serverId:e,isShowProgressTips:t?1:0,success:function(e){n&&n(e.localId)}})},F.prototype.startRecord=function(){var e=this;if(!e.ready){console.error("尚未初始化完成");return}wx.startRecord()},F.prototype.stopRecord=function(e){var t=this;if(!t.ready){console.error("尚未初始化完成");return}wx.stopRecord({success:function(t){e&&e(t.localId)}})},F.prototype.onVoiceRecordEnd=function(e){var t=this;if(!t.ready){console.error("尚未初始化完成");return}wx.onVoiceRecordEnd({complete:function(t){e&&e(t.localId)}})},F.prototype.playVoice=function(e){var t=this;if(!t.ready){console.error("尚未初始化完成");return}wx.playVoice({localId:e})},F.prototype.pauseVoice=function(e){var t=this;if(!t.ready){console.error("尚未初始化完成");return}wx.pauseVoice({localId:e})},F.prototype.stopVoice=function(e){var t=this;if(!t.ready){console.error("尚未初始化完成");return}wx.stopVoice({localId:e})},F.prototype.onVoicePlayEnd=function(e){var t=this;if(!t.ready){console.error("尚未初始化完成");return}wx.onVoicePlayEnd({success:function(t){e&&e(t.localId)}})},F.prototype.uploadVoice=function(e,t,n){var r=this;if(!r.ready){console.error("尚未初始化完成");return}wx.uploadVoice({localId:e,isShowProgressTips:t?1:0,success:function(e){n&&n(e.serverId)}})},F.prototype.downloadVoice=function(e,t,n){var r=this;if(!r.ready){console.error("尚未初始化完成");return}wx.downloadVoice({serverId:e,isShowProgressTips:t?1:0,success:function(e){n&&n(e.localId)}})},F.prototype.translateVoice=function(e,t,n){var r=this;if(!r.ready){console.error("尚未初始化完成");return}wx.translateVoice({localId:e,isShowProgressTips:t?1:0,success:function(e){n&&n(e.translateResult)}})},F.prototype.getNetworkType=function(e){var t=this;if(!t.ready){console.error("尚未初始化完成");return}wx.getNetworkType({success:function(t){e&&e(t.networkType)}})},F.prototype.openLocation=function(e,t,n,r,i,s){var o=this;if(!o.ready){console.error("尚未初始化完成");return}e=e||0,t=t||0,i=i||1,n=n||"",r=r||"",s=s||"",wx.openLocation({latitude:e,longitude:t,name:n,address:r,scale:i,infoUrl:s})},F.prototype.getLocation=function(e,t){var n=this;if(!n.ready){console.error("尚未初始化完成");return}e=e||"wgs84",wx.getLocation({type:e,success:t})},F.prototype.scanQRCode=function(e,t){var n=this;if(!n.ready){console.error("尚未初始化完成");return}wx.scanQRCode({needResult:e,scanType:["qrCode","barCode"],success:function(e){t&&t(e.resultStr)}})},F.prototype.closeWindow=function(){var e=this;if(!e.ready){console.error("尚未初始化完成");return}wx.closeWindow()},F.prototype.chooseWXPay=function(){};var I=0,q="",R=8,at=qc.defineBehaviour("qc.ServerCommunicate",qc.Behaviour,function(){this.url="",this._socketCmdMap={},this.socket=null,this.isConnected=!1,this.onConnect=new Phaser.Signal,this.onDisconnect=new Phaser.Signal,this.onError=new Phaser.Signal},{url:qc.Serializer.STRING});at.__menu="Plugins/ServerCommunicate",at.prototype.receiveResponse=function(t,n,r){if(t.status==0){this.game.log.trace("消息{0}没有收到回复。",n),r({ret:!1,reason:"no response"});return}if(t.status!=200){this.game.log.trace("消息{0}发送出错。",n),r({ret:!1,reason:t.statusText});return}var i=e.JSON.parse(t.responseText);i=i||{},this.game.log.trace("消息{0}收到回复:",n),this.game.log.trace(i),r(i)},at.prototype.sendMessage=function(t,n,r){var i=qc.AssetUtil.getXHR(),s=this.url+"/cmd";i.open("POST",s,!0),i.setRequestHeader("Content-Type","application/json;charset=UTF-8"),n.cmd=t,i.send(e.JSON.stringify(n));var o=this;i.onload=function(){return o.receiveResponse(i,t,r)},i.onerror=function(){return o.receiveResponse(i,t,r)}},at.sendMessage=function(e,t,n,r){var i=e.getScript("qc.ServerCommunicate");i.sendMessage(t,n,r)},at.login=function(e,t,n,r,i){r=r||{},r.username=t,r.password=U(n+"sdf1!@3fdd8*(+3dfFdkO%$@ffdln"),console.log(r),at.sendMessage(e,"LOGIN",r,i)},at.logout=function(t,n,r,i,s,o){i=i||{},i.username=n,i.password=U(r+"sdf1!@3fdd8*(+3dfFdkO%$@ffdln"),i.saveData=e.JSON.stringify(s),console.log(i),at.sendMessage(t,"LOGOUT",i,o)},at.prototype.registerSocketCmdIO=function(e,t){var n=this;t.on(e,function(){n.dispatchSocketCommand(e,arguments)})},at.prototype.registerSocketCmd=function(e,t){this._socketCmdMap[e]&&this.game.log.error("socket消息({0})重复注册",e),this._socketCmdMap[e]=t},at.prototype.dispatchSocketCommand=function(e,t){var n=this._socketCmdMap[e];if(!n){this.game.log.error("找不到 socket msg({0})的处理函数",e);return}var r=[this];for(var i=0;i<t.length;i++)r.push(t[i]);n.apply(null,r)},at.prototype.socketConnect=function(e){var t=this;t.socket&&(t.socket.close(),t.socket=null),t.socket=io.connect(t.url,e),t.socket.on("connect",function(){t.game.log.trace("connect {0} ok.",t.url),t.isConnected=!0,t.socket=this;if(!t.socket.registerDone){for(var e in t._socketCmdMap)t.registerSocketCmdIO(e,t.socket);t.socket.registerDone=!0}t.onConnect.dispatch(t)}),t.socket.on("disconnect",function(){t.game.log.trace("connection {0} disconnect.",t.url),t.socket=null,t.isConnected=!1,t.onDisconnect.dispatch(t)}),t.socket.on("error",function(e){t.game.log.trace("connection {0} error: {1}.",t.url,e),t.onError.dispatch(t,e)})},at.prototype.sendSocketMessage=function(e){return!this.socket||!this.isConnected?!1:(this.socket.emit.apply(this.socket,arguments),!0)},at.socketConnect=function(e,t){var n=e.getScript("qc.ServerCommunicate");n.socketConnect(t)},at.registerSocketCmd=function(e,t,n){var r=e.getScript("qc.ServerCommunicate");r.registerSocketCmd(t,n),r.isConnected&&r.registerSocketCmdIO(t,r.socket)},at.sendSocketMessage=function(e,t){var n=e.getScript("qc.ServerCommunicate"),r=[];for(var i=1;i<arguments.length;i++)r.push(arguments[i]);return n.sendSocketMessage.apply(n,r)},!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n;"undefined"!=typeof e?n=e:"undefined"!=typeof global?n=global:"undefined"!=typeof self&&(n=self),n.io=t()}}(function(){var r,i,s;return function o(e,t,n){function r(s,u){if(!t[s]){if(!e[s]){var a=typeof require=="function"&&require;if(!u&&a)return a(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+s+"'")}var f=t[s]={exports:{}};e[s][0].call(f.exports,function(t){var n=e[s][1][t];return r(n?n:t)},f,f.exports,o,e,t,n)}return t[s].exports}var i=typeof require=="function"&&require;for(var s=0;s<n.length;s++)r(n[s]);return r}({1:[function(e,t,n){t.exports=e("./lib/")},{"./lib/":2}],2:[function(e,t,r){function f(e,t){typeof e=="object"&&(t=e,e=n),t=t||{};var r=i(e),s=r.source,f=r.id,l;return t.forceNew||t["force new connection"]||!1===t.multiplex?(u("ignoring socket cache for %s",s),l=o(s,t)):(a[f]||(u("new io instance for %s",s),a[f]=o(s,t)),l=a[f]),l.socket(r.path)}var i=e("./url"),s=e("socket.io-parser"),o=e("./manager"),u=e("debug")("socket.io-client");t.exports=r=f;var a=r.managers={};r.protocol=s.protocol,r.connect=f,r.Manager=e("./manager"),r.Socket=e("./socket")},{"./manager":3,"./socket":5,"./url":6,debug:10,"socket.io-parser":46}],3:[function(e,t,r){function v(e,t){if(!(this instanceof v))return new v(e,t);e&&"object"==typeof e&&(t=e,e=n),t=t||{},t.path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||Infinity),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new d({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connected=[],this.encoding=!1,this.packetBuffer=[],this.encoder=new a.Encoder,this.decoder=new a.Decoder,this.autoConnect=t.autoConnect!==!1,this.autoConnect&&this.open()}var i=e("./url"),s=e("engine.io-client"),o=e("./socket"),u=e("component-emitter"),a=e("socket.io-parser"),f=e("./on"),l=e("component-bind"),c=e("object-component"),h=e("debug")("socket.io-client:manager"),p=e("indexof"),d=e("backo2");t.exports=v,v.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var e in this.nsps)this.nsps[e].emit.apply(this.nsps[e],arguments)},v.prototype.updateSocketIds=function(){for(var e in this.nsps)this.nsps[e].id=this.engine.id},u(v.prototype),v.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},v.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},v.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},v.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},v.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},v.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},v.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()},v.prototype.open=v.prototype.connect=function(e){h("readyState %s",this.readyState);if(~this.readyState.indexOf("open"))return this;h("opening %s",this.uri),this.engine=s(this.uri,this.opts);var t=this.engine,n=this;this.readyState="opening",this.skipReconnect=!1;var r=f(t,"open",function(){n.onopen(),e&&e()}),i=f(t,"error",function(t){h("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",t);if(e){var r=new Error("Connection error");r.data=t,e(r)}else n.maybeReconnectOnOpen()});if(!1!==this._timeout){var o=this._timeout;h("connect attempt will timeout after %d",o);var u=setTimeout(function(){h("connect attempt timed out after %d",o),r.destroy(),t.close(),t.emit("error","timeout"),n.emitAll("connect_timeout",o)},o);this.subs.push({destroy:function(){clearTimeout(u)}})}return this.subs.push(r),this.subs.push(i),this},v.prototype.onopen=function(){h("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(f(e,"data",l(this,"ondata"))),this.subs.push(f(this.decoder,"decoded",l(this,"ondecoded"))),this.subs.push(f(e,"error",l(this,"onerror"))),this.subs.push(f(e,"close",l(this,"onclose")))},v.prototype.ondata=function(e){this.decoder.add(e)},v.prototype.ondecoded=function(e){this.emit("packet",e)},v.prototype.onerror=function(e){h("error",e),this.emitAll("error",e)},v.prototype.socket=function(e){var t=this.nsps[e];if(!t){t=new o(this,e),this.nsps[e]=t;var n=this;t.on("connect",function(){t.id=n.engine.id,~p(n.connected,t)||n.connected.push(t)})}return t},v.prototype.destroy=function(e){var t=p(this.connected,e);~t&&this.connected.splice(t,1);if(this.connected.length)return;this.close()},v.prototype.packet=function(e){h("writing packet %j",e);var t=this;t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(e){for(var n=0;n<e.length;n++)t.engine.write(e[n]);t.encoding=!1,t.processPacketQueue()}))},v.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},v.prototype.cleanup=function(){var e;while(e=this.subs.shift())e.destroy();this.packetBuffer=[],this.encoding=!1,this.decoder.destroy()},v.prototype.close=v.prototype.disconnect=function(){this.skipReconnect=!0,this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},v.prototype.onclose=function(e){h("close"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},v.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)h("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();h("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){if(e.skipReconnect)return;h("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts);if(e.skipReconnect)return;e.open(function(t){t?(h("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(h("reconnect success"),e.onreconnect())})},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},v.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},{"./on":4,"./socket":5,"./url":6,backo2:7,"component-bind":8,"component-emitter":9,debug:10,"engine.io-client":11,indexof:42,"object-component":43,"socket.io-parser":46}],4:[function(e,t,n){function r(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}t.exports=r},{}],5:[function(e,t,n){function h(e,t){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.io.autoConnect&&this.open(),this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0}var r=e("socket.io-parser"),i=e("component-emitter"),s=e("to-array"),o=e("./on"),u=e("component-bind"),a=e("debug")("socket.io-client:socket"),f=e("has-binary");t.exports=n=h;var l={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},c=i.prototype.emit;i(h.prototype),h.prototype.subEvents=function(){if(this.subs)return;var e=this.io;this.subs=[o(e,"open",u(this,"onopen")),o(e,"packet",u(this,"onpacket")),o(e,"close",u(this,"onclose"))]},h.prototype.open=h.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen(),this)},h.prototype.send=function(){var e=s(arguments);return e.unshift("message"),this.emit.apply(this,e),this},h.prototype.emit=function(e){if(l.hasOwnProperty(e))return c.apply(this,arguments),this;var t=s(arguments),n=r.EVENT;f(t)&&(n=r.BINARY_EVENT);var i={type:n,data:t};return"function"==typeof t[t.length-1]&&(a("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),i.id=this.ids++),this.connected?this.packet(i):this.sendBuffer.push(i),this},h.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},h.prototype.onopen=function(){a("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:r.CONNECT})},h.prototype.onclose=function(e){a("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},h.prototype.onpacket=function(e){if(e.nsp!=this.nsp)return;switch(e.type){case r.CONNECT:this.onconnect();break;case r.EVENT:this.onevent(e);break;case r.BINARY_EVENT:this.onevent(e);break;case r.ACK:this.onack(e);break;case r.BINARY_ACK:this.onack(e);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",e.data)}},h.prototype.onevent=function(e){var t=e.data||[];a("emitting event %j",t),null!=e.id&&(a("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?c.apply(this,t):this.receiveBuffer.push(t)},h.prototype.ack=function(e){var t=this,n=!1;return function(){if(n)return;n=!0;var i=s(arguments);a("sending ack %j",i);var o=f(i)?r.BINARY_ACK:r.ACK;t.packet({type:o,id:e,data:i})}},h.prototype.onack=function(e){a("calling ack %s with %j",e.id,e.data);var t=this.acks[e.id];t.apply(this,e.data),delete this.acks[e.id]},h.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},h.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)c.apply(this,this.receiveBuffer[e]);this.receiveBuffer=[];for(e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},h.prototype.ondisconnect=function(){a("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},h.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},h.prototype.close=h.prototype.disconnect=function(){return this.connected&&(a("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{"./on":4,"component-bind":8,"component-emitter":9,debug:10,"has-binary":38,"socket.io-parser":46,"to-array":50}],6:[function(t,n,r){(function(e){function s(t,n){var s=t,n=n||e.location;return null==t&&(t=n.protocol+"//"+n.host),"string"==typeof t&&("/"==t.charAt(0)&&("/"==t.charAt(1)?t=n.protocol+t:t=n.hostname+t),/^(https?|wss?):\/\//.test(t)||(i("protocol-less url %s",t),"undefined"!=typeof n?t=n.protocol+"//"+t:t="https://"+t),i("parse %s",t),s=r(t)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/",s.id=s.protocol+"://"+s.host+":"+s.port,s.href=s.protocol+"://"+s.host+(n&&n.port==s.port?"":":"+s.port),s}var r=t("parseuri"),i=t("debug")("socket.io-client:url");n.exports=s}).call(this,typeof self!="undefined"?self:typeof e!="undefined"?e:{})},{debug:10,parseuri:44}],7:[function(e,t,n){function r(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}t.exports=r,r.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=(Math.floor(t*10)&1)==0?e-n:e+n}return Math.min(e,this.max)|0},r.prototype.reset=function(){this.attempts=0},r.prototype.setMin=function(e){this.ms=e},r.prototype.setMax=function(e){this.max=e},r.prototype.setJitter=function(e){this.jitter=e}},{}],8:[function(e,t,n){var r=[].slice;t.exports=function(e,t){"string"==typeof t&&(t=e[t]);if("function"!=typeof t)throw new Error("bind() requires a function");var n=r.call(arguments,2);return function(){return t.apply(e,n.concat(r.call(arguments)))}}},{}],9:[function(e,t,n){function r(e){if(e)return i(e)}function i(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}t.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},r.prototype.once=function(e,t){function r(){n.off(e,r),t.apply(this,arguments)}var n=this;return this._callbacks=this._callbacks||{},r.fn=t,this.on(e,r),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){this._callbacks=this._callbacks||{};if(0==arguments.length)return this._callbacks={},this;var n=this._callbacks[e];if(!n)return this;if(1==arguments.length)return delete this._callbacks[e],this;var r;for(var i=0;i<n.length;i++){r=n[i];if(r===t||r.fn===t){n.splice(i,1);break}}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n){n=n.slice(0);for(var r=0,i=n.length;r<i;++r)n[r].apply(this,t)}return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],10:[function(t,n,r){function i(t){return i.enabled(t)?function(n){n=s(n);var r=new Date,o=r-(i[t]||r);i[t]=r,n=t+" "+n+" +"+i.humanize(o),e.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function s(e){return e instanceof Error?e.stack||e.message:e}n.exports=i,i.names=[],i.skips=[],i.enable=function(e){try{localStorage.debug=e}catch(t){}var n=(e||"").split(/[\s,]+/),r=n.length;for(var s=0;s<r;s++)e=n[s].replace("*",".*?"),e[0]==="-"?i.skips.push(new RegExp("^"+e.substr(1)+"$")):i.names.push(new RegExp("^"+e+"$"))},i.disable=function(){i.enable("")},i.humanize=function(e){var t=1e3,n=6e4,r=60*n;return e>=r?(e/r).toFixed(1)+"h":e>=n?(e/n).toFixed(1)+"m":e>=t?(e/t|0)+"s":e+"ms"},i.enabled=function(e){for(var t=0,n=i.skips.length;t<n;t++)if(i.skips[t].test(e))return!1;for(var t=0,n=i.names.length;t<n;t++)if(i.names[t].test(e))return!0;return!1};try{e.localStorage&&i.enable(localStorage.debug)}catch(o){}},{}],11:[function(e,t,n){t.exports=e("./lib/")},{"./lib/":12}],12:[function(e,t,n){t.exports=e("./socket"),t.exports.parser=e("engine.io-parser")},{"./socket":13,"engine.io-parser":25}],13:[function(t,n,r){(function(e){function c(){}function h(t,n){if(!(this instanceof h))return new h(t,n);n=n||{},t&&"object"==typeof t&&(n=t,t=null),t&&(t=a(t),n.host=t.host,n.secure=t.protocol=="https"||t.protocol=="wss",n.port=t.port,t.query&&(n.query=t.query)),this.secure=null!=n.secure?n.secure:e.location&&"https:"==location.protocol;if(n.host){var r=n.host.split(":");n.hostname=r.shift(),r.length?n.port=r.pop():n.port||(n.port=this.secure?"443":"80")}this.agent=n.agent||!1,this.hostname=n.hostname||(e.location?location.hostname:"localhost"),this.port=n.port||(e.location&&location.port?location.port:this.secure?443:80),this.query=n.query||{},"string"==typeof this.query&&(this.query=l.decode(this.query)),this.upgrade=!1!==n.upgrade,this.path=(n.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!n.forceJSONP,this.jsonp=!1!==n.jsonp,this.forceBase64=!!n.forceBase64,this.enablesXDR=!!n.enablesXDR,this.timestampParam=n.timestampParam||"t",this.timestampRequests=n.timestampRequests,this.transports=n.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.callbackBuffer=[],this.policyPort=n.policyPort||843,this.rememberUpgrade=n.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=n.onlyBinaryUpgrades,this.pfx=n.pfx||null,this.key=n.key||null,this.passphrase=n.passphrase||null,this.cert=n.cert||null,this.ca=n.ca||null,this.ciphers=n.ciphers||null,this.rejectUnauthorized=n.rejectUnauthorized||null,this.open()}function p(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var r=t("./transports"),i=t("component-emitter"),s=t("debug")("engine.io-client:socket"),o=t("indexof"),u=t("engine.io-parser"),a=t("parseuri"),f=t("parsejson"),l=t("parseqs");n.exports=h,h.priorWebsocketSuccess=!1,i(h.prototype),h.protocol=u.protocol,h.Socket=h,h.Transport=t("./transport"),h.transports=t("./transports"),h.parser=t("engine.io-parser"),h.prototype.createTransport=function(e){s('creating transport "%s"',e);var t=p(this.query);t.EIO=u.protocol,t.transport=e,this.id&&(t.sid=this.id);var n=new r[e]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:t,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized});return n},h.prototype.open=function(){var e;if(this.rememberUpgrade&&h.priorWebsocketSuccess&&this.transports.indexOf("websocket")!=-1)e="websocket";else{if(0==this.transports.length){var t=this;setTimeout(function(){t.emit("error","No transports available")},0);return}e=this.transports[0]}this.readyState="opening";var e;try{e=this.createTransport(e)}catch(n){this.transports.shift(),this.open();return}e.open(),this.setTransport(e)},h.prototype.setTransport=function(e){s("setting transport %s",e.name);var t=this;this.transport&&(s("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},h.prototype.probe=function(e){function i(){if(r.onlyBinaryUpgrades){var i=!this.supportsBinary&&r.transport.supportsBinary;n=n||i}if(n)return;s('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",function(i){if(n)return;if("pong"==i.type&&"probe"==i.data){s('probe transport "%s" pong',e),r.upgrading=!0,r.emit("upgrading",t);if(!t)return;h.priorWebsocketSuccess="websocket"==t.name,s('pausing current transport "%s"',r.transport.name),r.transport.pause(function(){if(n)return;if("closed"==r.readyState)return;s("changing transport and sending upgrade packet"),c(),r.setTransport(t),t.send([{type:"upgrade"}]),r.emit("upgrade",t),t=null,r.upgrading=!1,r.flush()})}else{s('probe transport "%s" failed',e);var o=new Error("probe error");o.transport=t.name,r.emit("upgradeError",o)}})}function o(){if(n)return;n=!0,c(),t.close(),t=null}function u(n){var i=new Error("probe error: "+n);i.transport=t.name,o(),s('probe transport "%s" failed because of error: %s',e,n),r.emit("upgradeError",i)}function a(){u("transport closed")}function f(){u("socket closed")}function l(e){t&&e.name!=t.name&&(s('"%s" works - aborting "%s"',e.name,t.name),o())}function c(){t.removeListener("open",i),t.removeListener("error",u),t.removeListener("close",a),r.removeListener("close",f),r.removeListener("upgrading",l)}s('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,r=this;h.priorWebsocketSuccess=!1,t.once("open",i),t.once("error",u),t.once("close",a),this.once("close",f),this.once("upgrading",l),t.open()},h.prototype.onOpen=function(){s("socket open"),this.readyState="open",h.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush();if("open"==this.readyState&&this.upgrade&&this.transport.pause){s("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},h.prototype.onPacket=function(e){if("opening"==this.readyState||"open"==this.readyState){s('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat");switch(e.type){case"open":this.onHandshake(f(e.data));break;case"pong":this.setPing();break;case"error":var t=new Error("server error");t.code=e.data,this.emit("error",t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}}else s('packet received with socket readyState "%s"',this.readyState)},h.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen();if("closed"==this.readyState)return;this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat)},h.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){if("closed"==t.readyState)return;t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},h.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){s("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},h.prototype.ping=function(){this.sendPacket("ping")},h.prototype.onDrain=function(){for(var e=0;e<this.prevBufferLen;e++)this.callbackBuffer[e]&&this.callbackBuffer[e]();this.writeBuffer.splice(0,this.prevBufferLen),this.callbackBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,this.writeBuffer.length==0?this.emit("drain"):this.flush()},h.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(s("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},h.prototype.write=h.prototype.send=function(e,t){return this.sendPacket("message",e,t),this},h.prototype.sendPacket=function(e,t,n){if("closing"==this.readyState||"closed"==this.readyState)return;var r={type:e,data:t};this.emit("packetCreate",r),this.writeBuffer.push(r),this.callbackBuffer.push(n),this.flush()},h.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var e=this;function t(){e.onClose("forced close"),s("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function r(){e.once("upgrade",n),e.once("upgradeError",n)}this.writeBuffer.length?this.once("drain",function(){this.upgrading?r():t()}):this.upgrading?r():t()}return this},h.prototype.onError=function(e){s("socket error %j",e),h.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},h.prototype.onClose=function(e,t){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){s('socket close with reason: "%s"',e);var n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),setTimeout(function(){n.writeBuffer=[],n.callbackBuffer=[],n.prevBufferLen=0},0),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t)}},h.prototype.filterUpgrades=function(e){var t=[];for(var n=0,r=e.length;n<r;n++)~o(this.transports,e[n])&&t.push(e[n]);return t}}).call(this,typeof self!="undefined"?self:typeof e!="undefined"?e:{})},{"./transport":14,"./transports":15,"component-emitter":9,debug:22,"engine.io-parser":25,indexof:42,parsejson:34,parseqs:35,parseuri:36}],14:[function(e,t,n){function s(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized}var r=e("engine.io-parser"),i=e("component-emitter");t.exports=s,i(s.prototype),s.timestamps=0,s.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},s.prototype.open=function(){if("closed"==this.readyState||""==this.readyState)this.readyState="opening",this.doOpen();return this},s.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState)this.doClose(),this.onClose();return this},s.prototype.send=function(e){if("open"!=this.readyState)throw new Error("Transport not open");this.write(e)},s.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},s.prototype.onData=function(e){var t=r.decodePacket(e,this.socket.binaryType);this.onPacket(t)},s.prototype.onPacket=function(e){this.emit("packet",e)},s.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},{"component-emitter":9,"engine.io-parser":25}],15:[function(t,n,r){(function(e){function u(t){var r,o=!1,u=!1,a=!1!==t.jsonp;if(e.location){var f="https:"==location.protocol,l=location.port;l||(l=f?443:80),o=t.hostname!=location.hostname||l!=t.port,u=t.secure!=f}t.xdomain=o,t.xscheme=u,r=new n(t);if("open"in r&&!t.forceJSONP)return new i(t);if(!a)throw new Error("JSONP disabled");return new s(t)}var n=t("xmlhttprequest"),i=t("./polling-xhr"),s=t("./polling-jsonp"),o=t("./websocket");r.polling=u,r.websocket=o}).call(this,typeof self!="undefined"?self:typeof e!="undefined"?e:{})},{"./polling-jsonp":16,"./polling-xhr":17,"./websocket":19,xmlhttprequest:20}],16:[function(t,n,r){(function(e){function f(){}function l(t){r.call(this,t),this.query=this.query||{},u||(e.___eio||(e.___eio=[]),u=e.___eio),this.index=u.length;var n=this;u.push(function(e){n.onData(e)}),this.query.j=this.index,e.document&&e.addEventListener&&e.addEventListener("beforeunload",function(){n.script&&(n.script.onerror=f)},!1)}var r=t("./polling"),i=t("component-inherit");n.exports=l;var s=/\n/g,o=/\\n/g,u,a=0;i(l,r),l.prototype.supportsBinary=!1,l.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},l.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n),this.script=t;var r="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);r&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},l.prototype.doWrite=function(e,t){function f(){l(),t()}function l(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{var t='<iframe src="javascript:0" name="'+n.iframeId+'">';a=document.createElement(t)}catch(e){a=document.createElement("iframe"),a.name=n.iframeId,a.src="javascript:0"}a.id=n.iframeId,n.form.appendChild(a),n.iframe=a}var n=this;if(!this.form){var r=document.createElement("form"),i=document.createElement("textarea"),u=this.iframeId="eio_iframe_"+this.index,a;r.className="socketio",r.style.position="absolute",r.style.top="-1000px",r.style.left="-1000px",r.target=u,r.method="POST",r.setAttribute("accept-charset","utf-8"),i.name="d",r.appendChild(i),document.body.appendChild(r),this.form=r,this.area=i}this.form.action=this.uri(),l(),e=e.replace(o,"\\\n"),this.area.value=e.replace(s,"\\n");try{this.form.submit()}catch(c){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){n.iframe.readyState=="complete"&&f()}:this.iframe.onload=f}}).call(this,typeof self!="undefined"?self:typeof e!="undefined"?e:{})},{"./polling":18,"component-inherit":21}],17:[function(t,r,i){(function(e){function f(){}function l(t){s.call(this,t);if(e.location){var n="https:"==location.protocol,r=location.port;r||(r=n?443:80),this.xd=t.hostname!=e.location.hostname||r!=t.port,this.xs=t.secure!=n}}function c(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=n!=e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.create()}function h(){for(var e in c.requests)c.requests.hasOwnProperty(e)&&c.requests[e].abort()}var i=t("xmlhttprequest"),s=t("./polling"),o=t("component-emitter"),u=t("component-inherit"),a=t("debug")("engine.io-client:polling-xhr");r.exports=l,r.exports.Request=c,u(l,s),l.prototype.supportsBinary=!0,l.prototype.request=function(e){return e=e||{},e.uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,new c(e)},l.prototype.doWrite=function(e,t){var r=typeof e!="string"&&e!==n,i=this.request({method:"POST",data:e,isBinary:r}),s=this;i.on("success",t),i.on("error",function(e){s.onError("xhr post error",e)}),this.sendXhr=i},l.prototype.doPoll=function(){a("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},o(c.prototype),c.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var n=this.xhr=new i(t),r=this;try{a("xhr open %s: %s",this.method,this.uri),n.open(this.method,this.uri,this.async),this.supportsBinary&&(n.responseType="arraybuffer");if("POST"==this.method)try{this.isBinary?n.setRequestHeader("Content-type","application/octet-stream"):n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(s){}"withCredentials"in n&&(n.withCredentials=!0),this.hasXDR()?(n.onload=function(){r.onLoad()},n.onerror=function(){r.onError(n.responseText)}):n.onreadystatechange=function(){if(4!=n.readyState)return;200==n.status||1223==n.status?r.onLoad():setTimeout(function(){r.onError(n.status)},0)},a("xhr data %s",this.data),n.send(this.data)}catch(s){setTimeout(function(){r.onError(s)},0);return}e.document&&(this.index=c.requestsCount++,c.requests[this.index]=this)},c.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},c.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},c.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},c.prototype.cleanup=function(t){if("undefined"==typeof this.xhr||null===this.xhr)return;this.hasXDR()?this.xhr.onload=this.xhr.onerror=f:this.xhr.onreadystatechange=f;if(t)try{this.xhr.abort()}catch(n){}e.document&&delete c.requests[this.index],this.xhr=null},c.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(n){}t==="application/octet-stream"?e=this.xhr.response:this.supportsBinary?e="ok":e=this.xhr.responseText}catch(n){this.onError(n)}null!=e&&this.onData(e)},c.prototype.hasXDR=function(){return"undefined"!=typeof e.XDomainRequest&&!this.xs&&this.enablesXDR},c.prototype.abort=function(){this.cleanup()},e.document&&(c.requestsCount=0,c.requests={},e.attachEvent?e.attachEvent("onunload",h):e.addEventListener&&e.addEventListener("beforeunload",h,!1))}).call(this,typeof self!="undefined"?self:typeof e!="undefined"?e:{})},{"./polling":18,"component-emitter":9,"component-inherit":21,debug:22,xmlhttprequest:20}],18:[function(e,t,n){function f(e){var t=e&&e.forceBase64;if(!a||t)this.supportsBinary=!1;r.call(this,e)}var r=e("../transport"),i=e("parseqs"),s=e("engine.io-parser"),o=e("component-inherit"),u=e("debug")("engine.io-client:polling");t.exports=f;var a=function(){var t=e("xmlhttprequest"),n=new t({xdomain:!1});return null!=n.responseType}();o(f,r),f.prototype.name="polling",f.prototype.doOpen=function(){this.poll()},f.prototype.pause=function(e){function r(){u("paused"),n.readyState="paused",e()}var t=0,n=this;this.readyState="pausing";if(this.polling||!this.writable){var i=0;this.polling&&(u("we are currently polling - waiting to pause"),i++,this.once("pollComplete",function(){u("pre-pause polling complete"),--i||r()})),this.writable||(u("we are currently writing - waiting to pause"),i++,this.once("drain",function(){u("pre-pause writing complete"),--i||r()}))}else r()},f.prototype.poll=function(){u("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},f.prototype.onData=function(e){var t=this;u("polling got data %s",e);var n=function(e,n,r){"opening"==t.readyState&&t.onOpen();if("close"==e.type)return t.onClose(),!1;t.onPacket(e)};s.decodePayload(e,this.socket.binaryType,n),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():u('ignoring poll - transport state "%s"',this.readyState))},f.prototype.doClose=function(){function t(){u("writing close packet"),e.write([{type:"close"}])}var e=this;"open"==this.readyState?(u("transport open - closing"),t()):(u("transport not open - deferring close"),this.once("open",t))},f.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")},t=this;s.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},f.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=+(new Date)+"-"+r.timestamps++),!this.supportsBinary&&!e.sid&&(e.b64=1),e=i.encode(e),this.port&&("https"==t&&this.port!=443||"http"==t&&this.port!=80)&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+this.hostname+n+this.path+e}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:35,xmlhttprequest:20}],19:[function(e,t,r){function l(e){var t=e&&e.forceBase64;t&&(this.supportsBinary=!1),i.call(this,e)}var i=e("../transport"),s=e("engine.io-parser"),o=e("parseqs"),u=e("component-inherit"),a=e("debug")("engine.io-client:websocket"),f=e("ws");t.exports=l,u(l,i),l.prototype.name="websocket",l.prototype.supportsBinary=!0,l.prototype.doOpen=function(){if(!this.check())return;var e=this,t=this.uri(),r=void 0,i={agent:this.agent};i.pfx=this.pfx,i.key=this.key,i.passphrase=this.passphrase,i.cert=this.cert,i.ca=this.ca,i.ciphers=this.ciphers,i.rejectUnauthorized=this.rejectUnauthorized,this.ws=new f(t,r,i),this.ws.binaryType===n&&(this.supportsBinary=!1),this.ws.binaryType="arraybuffer",this.addEventListeners()},l.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(l.prototype.onData=function(e){var t=this;setTimeout(function(){i.prototype.onData.call(t,e)},0)}),l.prototype.write=function(e){function i(){t.writable=!0,t.emit("drain")}var t=this;this.writable=!1;for(var n=0,r=e.length;n<r;n++)s.encodePacket(e[n],this.supportsBinary,function(e){try{t.ws.send(e)}catch(n){a("websocket closed before onclose event")}});setTimeout(i,0)},l.prototype.onClose=function(){i.prototype.onClose.call(this)},l.prototype.doClose=function(){typeof this.ws!="undefined"&&this.ws.close()},l.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"==t&&this.port!=443||"ws"==t&&this.port!=80)&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=+(new Date)),this.supportsBinary||(e.b64=1),e=o.encode(e),e.length&&(e="?"+e),t+"://"+this.hostname+n+this.path+e},l.prototype.check=function(){return!!f&&!("__initialize"in f&&this.name===l.prototype.name)}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:35,ws:37}],20:[function(e,t,n){var r=e("has-cors");t.exports=function(e){var t=e.xdomain,n=e.xscheme,i=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(s){}try{if("undefined"!=typeof XDomainRequest&&!n&&i)return new XDomainRequest}catch(s){}if(!t)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(s){}}},{"has-cors":40}],21:[function(e,t,n){t.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],22:[function(t,n,r){function i(){return"WebkitAppearance"in document.documentElement.style||e.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function s(){var e=arguments,t=this.useColors;e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+r.humanize(this.diff);if(!t)return e;var n="color: "+this.color;e=[e[0],n,"color: inherit"].concat(Array.prototype.slice.call(e,1));var i=0,s=0;return e[0].replace(/%[a-z%]/g,function(e){if("%"===e)return;i++,"%c"===e&&(s=i)}),e.splice(s,0,n),e}function o(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)}function u(e){try{null==e?localStorage.removeItem("debug"):localStorage.debug=e}catch(t){}}function a(){var e;try{e=localStorage.debug}catch(t){}return e}r=n.exports=t("./debug"),r.log=o,r.formatArgs=s,r.save=u,r.load=a,r.useColors=i,r.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],r.formatters.j=function(e){return JSON.stringify(e)},r.enable(a())},{"./debug":23}],23:[function(e,t,n){function s(){return n.colors[r++%n.colors.length]}function o(e){function t(){}function r(){var e=r,t=+(new Date),o=t-(i||t);e.diff=o,e.prev=i,e.curr=t,i=t,null==e.useColors&&(e.useColors=n.useColors()),null==e.color&&e.useColors&&(e.color=s());var u=Array.prototype.slice.call(arguments);u[0]=n.coerce(u[0]),"string"!=typeof u[0]&&(u=["%o"].concat(u));var a=0;u[0]=u[0].replace(/%([a-z%])/g,function(t,r){if(t==="%")return t;a++;var i=n.formatters[r];if("function"==typeof i){var s=u[a];t=i.call(e,s),u.splice(a,1),a--}return t}),"function"==typeof n.formatArgs&&(u=n.formatArgs.apply(e,u));var f=r.log||n.log||console.log.bind(console);f.apply(e,u)}t.enabled=!1,r.enabled=!0;var o=n.enabled(e)?r:t;return o.namespace=e,o}function u(e){n.save(e);var t=(e||"").split(/[\s,]+/),r=t.length;for(var i=0;i<r;i++){if(!t[i])continue;e=t[i].replace(/\*/g,".*?"),e[0]==="-"?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$"))}}function a(){n.enable("")}function f(e){var t,r;for(t=0,r=n.skips.length;t<r;t++)if(n.skips[t].test(e))return!1;for(t=0,r=n.names.length;t<r;t++)if(n.names[t].test(e))return!0;return!1}function l(e){return e instanceof Error?e.stack||e.message:e}n=t.exports=o,n.coerce=l,n.disable=a,n.enable=u,n.enabled=f,n.humanize=e("ms"),n.names=[],n.skips=[],n.formatters={};var r=0,i},{ms:24}],24:[function(e,t,n){function a(e){var t=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(e);if(!t)return;var n=parseFloat(t[1]),a=(t[2]||"ms").toLowerCase();switch(a){case"years":case"year":case"y":return n*u;case"days":case"day":case"d":return n*o;case"hours":case"hour":case"h":return n*s;case"minutes":case"minute":case"m":return n*i;case"seconds":case"second":case"s":return n*r;case"ms":return n}}function f(e){return e>=o?Math.round(e/o)+"d":e>=s?Math.round(e/s)+"h":e>=i?Math.round(e/i)+"m":e>=r?Math.round(e/r)+"s":e+"ms"}function l(e){return c(e,o,"day")||c(e,s,"hour")||c(e,i,"minute")||c(e,r,"second")||e+" ms"}function c(e,t,n){if(e<t)return;return e<t*1.5?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var r=1e3,i=r*60,s=i*60,o=s*24,u=o*365.25;t.exports=function(e,t){return t=t||{},"string"==typeof e?a(e):t.long?l(e):f(e)}},{}],25:[function(t,r,i){(function(e){function g(e,t){var n="b"+i.packets[e.type]+e.data.data;return t(n)}function y(e,t,n){if(!t)return i.encodeBase64Packet(e,n);var r=e.data,s=new Uint8Array(r),o=new Uint8Array(1+r.byteLength);o[0]=p[e.type];for(var u=0;u<s.length;u++)o[u+1]=s[u];return n(o.buffer)}function b(e,t,n){if(!t)return i.encodeBase64Packet(e,n);var r=new FileReader;return r.onload=function(){e.data=r.result,i.encodePacket(e,t,!0,n)},r.readAsArrayBuffer(e.data)}function w(e,t,n){if(!t)return i.encodeBase64Packet(e,n);if(h)return b(e,t,n);var r=new Uint8Array(1);r[0]=p[e.type];var s=new m([r.buffer,e.data]);return n(s)}function E(e,t,n){var r=new Array(e.length),i=a(e.length,n),s=function(e,n,i){t(n,function(t,n){r[e]=n,i(t,r)})};for(var o=0;o<e.length;o++)s(o,e[o],i)}var r=t("./keys"),s=t("has-binary"),o=t("arraybuffer.slice"),u=t("base64-arraybuffer"),a=t("after"),f=t("utf8"),l=navigator.userAgent.match(/Android/i),c=/PhantomJS/i.test(navigator.userAgent),h=l||c;i.protocol=3;var p=i.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},d=r(p),v={type:"error",data:"parser error"},m=t("blob");i.encodePacket=function(t,r,i,s){"function"==typeof r&&(s=r,r=!1),"function"==typeof i&&(s=i,i=null);var o=t.data===n?n:t.data.buffer||t.data;if(e.ArrayBuffer&&o instanceof ArrayBuffer)return y(t,r,s);if(m&&o instanceof e.Blob)return w(t,r,s);if(o&&o.base64)return g(t,s);var u=p[t.type];return n!==t.data&&(u+=i?f.encode(String(t.data)):String(t.data)),s(""+u)},i.encodeBase64Packet=function(t,n){var r="b"+i.packets[t.type];if(m&&t.data instanceof m){var s=new FileReader;return s.onload=function(){var e=s.result.split(",")[1];n(r+e)},s.readAsDataURL(t.data)}var o;try{o=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(u){var a=new Uint8Array(t.data),f=new Array(a.length);for(var l=0;l<a.length;l++)f[l]=a[l];o=String.fromCharCode.apply(null,f)}return r+=e.btoa(o),n(r)},i.decodePacket=function(e,t,r){if(typeof e=="string"||e===n){if(e.charAt(0)=="b")return i.decodeBase64Packet(e.substr(1),t);if(r)try{e=f.decode(e)}catch(s){return v}var u=e.charAt(0);return Number(u)!=u||!d[u]?v:e.length>1?{type:d[u],data:e.substring(1)}:{type:d[u]}}var a=new Uint8Array(e),u=a[0],l=o(e,1);return m&&t==="blob"&&(l=new m([l])),{type:d[u],data:l}},i.decodeBase64Packet=function(t,n){var r=d[t.charAt(0)];if(!e.ArrayBuffer)return{type:r,data:{base64:!0,data:t.substr(1)}};var i=u.decode(t.substr(1));return n==="blob"&&m&&(i=new m([i])),{type:r,data:i}},i.encodePayload=function(e,t,n){function o(e){return e.length+":"+e}function u(e,n){i.encodePacket(e,r?t:!1,!0,function(e){n(null,o(e))})}typeof t=="function"&&(n=t,t=null);var r=s(e);if(t&&r)return m&&!h?i.encodePayloadAsBlob(e,n):i.encodePayloadAsArrayBuffer(e,n);if(!e.length)return n("0:");E(e,u,function(e,t){return n(t.join(""))})},i.decodePayload=function(e,t,n){if(typeof e!="string")return i.decodePayloadAsBinary(e,t,n);typeof t=="function"&&(n=t,t=null);var r;if(e=="")return n(v,0,1);var s="",o,u;for(var a=0,f=e.length;a<f;a++){var l=e.charAt(a);if(":"!=l)s+=l;else{if(""==s||s!=(o=Number(s)))return n(v,0,1);u=e.substr(a+1,o);if(s!=u.length)return n(v,0,1);if(u.length){r=i.decodePacket(u,t,!0);if(v.type==r.type&&v.data==r.data)return n(v,0,1);var c=n(r,a+o,f);if(!1===c)return}a+=o,s=""}}if(s!="")return n(v,0,1)},i.encodePayloadAsArrayBuffer=function(e,t){function n(e,t){i.encodePacket(e,!0,!0,function(e){return t(null,e)})}if(!e.length)return t(new ArrayBuffer(0));E(e,n,function(e,n){var r=n.reduce(function(e,t){var n;return typeof t=="string"?n=t.length:n=t.byteLength,e+n.toString().length+n+2},0),i=new Uint8Array(r),s=0;return n.forEach(function(e){var t=typeof e=="string",n=e;if(t){var r=new Uint8Array(e.length);for(var o=0;o<e.length;o++)r[o]=e.charCodeAt(o);n=r.buffer}t?i[s++]=0:i[s++]=1;var u=n.byteLength.toString();for(var o=0;o<u.length;o++)i[s++]=parseInt(u[o]);i[s++]=255;var r=new Uint8Array(n);for(var o=0;o<r.length;o++)i[s++]=r[o]}),t(i.buffer)})},i.encodePayloadAsBlob=function(e,t){function n(e,t){i.encodePacket(e,!0,!0,function(e){var n=new Uint8Array(1);n[0]=1;if(typeof e=="string"){var r=new Uint8Array(e.length);for(var i=0;i<e.length;i++)r[i]=e.charCodeAt(i);e=r.buffer,n[0]=0}var s=e instanceof ArrayBuffer?e.byteLength:e.size,o=s.toString(),u=new Uint8Array(o.length+1);for(var i=0;i<o.length;i++)u[i]=parseInt(o[i]);u[o.length]=255;if(m){var a=new m([n.buffer,u.buffer,e]);t(null,a)}})}E(e,n,function(e,n){return t(new m(n))})},i.decodePayloadAsBinary=function(e,t,n){typeof t=="function"&&(n=t,t=null);var r=e,s=[],u=!1;while(r.byteLength>0){var a=new Uint8Array(r),f=a[0]===0,l="";for(var c=1;;c++){if(a[c]==255)break;if(l.length>310){u=!0;break}l+=a[c]}if(u)return n(v,0,1);r=o(r,2+l.length),l=parseInt(l);var h=o(r,0,l);if(f)try{h=String.fromCharCode.apply(null,new Uint8Array(h))}catch(p){var d=new Uint8Array(h);h="";for(var c=0;c<d.length;c++)h+=String.fromCharCode(d[c])}s.push(h),r=o(r,l)}var m=s.length;s.forEach(function(e,r){n(i.decodePacket(e,t,!0),r,m)})}}).call(this,typeof self!="undefined"?self:typeof e!="undefined"?e:{})},{"./keys":26,after:27,"arraybuffer.slice":28,"base64-arraybuffer":29,blob:30,"has-binary":31,utf8:33}],26:[function(e,n,r){n.exports=t.keys||function(n){var r=[],i=t.prototype.hasOwnProperty;for(var s in n)i.call(n,s)&&r.push(s);return r}},{}],27:[function(e,t,n){function r(e,t,n){function s(e,i){if(s.count<=0)throw new Error("after called too many times");--s.count,e?(r=!0,t(e),t=n):s.count===0&&!r&&t(null,i)}var r=!1;return n=n||i,s.count=e,e===0?t():s}function i(){}t.exports=r},{}],28:[function(e,t,n){t.exports=function(e,t,n){var r=e.byteLength;t=t||0,n=n||r;if(e.slice)return e.slice(t,n);t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r);if(t>=r||t>=n||r===0)return new ArrayBuffer(0);var i=new Uint8Array(e),s=new Uint8Array(n-t);for(var o=t,u=0;o<n;o++,u++)s[u]=i[o];return s.buffer}},{}],29:[function(e,t,n){(function(e){"use strict";n.encode=function(t){var n=new Uint8Array(t),r,i=n.length,s="";for(r=0;r<i;r+=3)s+=e[n[r]>>2],s+=e[(n[r]&3)<<4|n[r+1]>>4],s+=e[(n[r+1]&15)<<2|n[r+2]>>6],s+=e[n[r+2]&63];return i%3===2?s=s.substring(0,s.length-1)+"=":i%3===1&&(s=s.substring(0,s.length-2)+"=="),s},n.decode=function(t){var n=t.length*.75,r=t.length,i,s=0,o,u,a,f;t[t.length-1]==="="&&(n--,t[t.length-2]==="="&&n--);var l=new ArrayBuffer(n),c=new Uint8Array(l);for(i=0;i<r;i+=4)o=e.indexOf(t[i]),u=e.indexOf(t[i+1]),a=e.indexOf(t[i+2]),f=e.indexOf(t[i+3]),c[s++]=o<<2|u>>4,c[s++]=(u&15)<<4|a>>2,c[s++]=(a&3)<<6|f&63;return l}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],30:[function(t,r,i){(function(e){function o(e,n){n=n||{};var r=new t;for(var i=0;i<e.length;i++)r.append(e[i]);return n.type?r.getBlob(n.type):r.getBlob()}var t=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder,i=function(){try{var e=new Blob(["hi"]);return e.size==2}catch(t){return!1}}(),s=t&&t.prototype.append&&t.prototype.getBlob;r.exports=function(){return i?e.Blob:s?o:n}()}).call(this,typeof self!="undefined"?self:typeof e!="undefined"?e:{})},{}],31:[function(t,n,r){(function(e){function i(t){function n(t){if(!t)return!1;if(e.Buffer&&e.Buffer.isBuffer(t)||e.ArrayBuffer&&t instanceof ArrayBuffer||e.Blob&&t instanceof Blob||e.File&&t instanceof File)return!0;if(r(t)){for(var i=0;i<t.length;i++)if(n(t[i]))return!0}else if(t&&"object"==typeof t){t.toJSON&&(t=t.toJSON());for(var s in t)if(t.hasOwnProperty(s)&&n(t[s]))return!0}return!1}return n(t)}var r=t("isarray");n.exports=i}).call(this,typeof self!="undefined"?self:typeof e!="undefined"?e:{})},{isarray:32}],32:[function(e,n,r){n.exports=Array.isArray||function(e){return t.prototype.toString.call(e)=="[object Array]"}},{}],33:[function(t,n,i){(function(e){(function(t){function f(e){var t=[],n=0,r=e.length,i,s;while(n<r)i=e.charCodeAt(n++),i>=55296&&i<=56319&&n<r?(s=e.charCodeAt(n++),(s&64512)==56320?t.push(((i&1023)<<10)+(s&1023)+65536):(t.push(i),n--)):t.push(i);return t}function l(e){var t=e.length,n=-1,r,i="";while(++n<t)r=e[n],r>65535&&(r-=65536,i+=a(r>>>10&1023|55296),r=56320|r&1023),i+=a(r);return i}function c(e,t){return a(e>>t&63|128)}function h(e){if((e&4294967168)==0)return a(e);var t="";return(e&4294965248)==0?t=a(e>>6&31|192):(e&4294901760)==0?(t=a(e>>12&15|224),t+=c(e,6)):(e&4292870144)==0&&(t=a(e>>18&7|240),t+=c(e,12),t+=c(e,6)),t+=a(e&63|128),t}function p(e){var t=f(e),n=t.length,r=-1,i,s="";while(++r<n)i=t[r],s+=h(i);return s}function d(){if(y>=g)throw Error("Invalid byte index");var e=m[y]&255;y++;if((e&192)==128)return e&63;throw Error("Invalid continuation byte")}function v(){var e,t,n,r,i;if(y>g)throw Error("Invalid byte index");if(y==g)return!1;e=m[y]&255,y++;if((e&128)==0)return e;if((e&224)==192){var t=d();i=(e&31)<<6|t;if(i>=128)return i;throw Error("Invalid continuation byte")}if((e&240)==224){t=d(),n=d(),i=(e&15)<<12|t<<6|n;if(i>=2048)return i;throw Error("Invalid continuation byte")}if((e&248)==240){t=d(),n=d(),r=d(),i=(e&15)<<18|t<<12|n<<6|r;if(i>=65536&&i<=1114111)return i}throw Error("Invalid UTF-8 detected")}function b(e){m=f(e),g=m.length,y=0;var t=[],n;while((n=v())!==!1)t.push(n);return l(t)}var s=typeof i=="object"&&i,o=typeof n=="object"&&n&&n.exports==s&&n,u=typeof e=="object"&&e;if(u.global===u||u.window===u)t=u;var a=String.fromCharCode,m,g,y,w={version:"2.0.0",encode:p,decode:b};if(typeof r=="function"&&typeof r.amd=="object"&&r.amd)r(function(){return w});else if(s&&!s.nodeType)if(o)o.exports=w;else{var E={},S=E.hasOwnProperty;for(var x in w)S.call(w,x)&&(s[x]=w[x])}else t.utf8=w})(this)}).call(this,typeof self!="undefined"?self:typeof e!="undefined"?e:{})},{}],34:[function(t,n,r){(function(e){var t=/^[\],:{}\s]*$/,r=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,i=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,s=/(?:^|:|,)(?:\s*\[)+/g,o=/^\s+/,u=/\s+$/;n.exports=function(a){if("string"!=typeof a||!a)return null;a=a.replace(o,"").replace(u,"");if(e.JSON&&JSON.parse)return JSON.parse(a);if(t.test(a.replace(r,"@").replace(i,"]").replace(s,"")))return(new Function("return "+a))()}}).call(this,typeof self!="undefined"?self:typeof e!="undefined"?e:{})},{}],35:[function(e,t,n){n.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},n.decode=function(e){var t={},n=e.split("&");for(var r=0,i=n.length;r<i;r++){var s=n[r].split("=");t[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return t}},{}],36:[function(e,t,n){var r=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var n=t,s=t.indexOf("["),o=t.indexOf("]");s!=-1&&o!=-1&&(t=t.substring(0,s)+t.substring(s,o).replace(/:/g,";")+t.substring(o,t.length));var u=r.exec(t||""),a={},f=14;while(f--)a[i[f]]=u[f]||"";return s!=-1&&o!=-1&&(a.source=n,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},{}],37:[function(e,t,n){function s(e,t,n){var r;return t?r=new i(e,t):r=new i(e),r}var r=function(){return this}(),i=r.WebSocket||r.MozWebSocket;t.exports=i?s:null,i&&(s.prototype=i.prototype)},{}],38:[function(n,r,i){(function(e){function s(n){function r(n){if(!n)return!1;if(e.Buffer&&e.Buffer.isBuffer(n)||e.ArrayBuffer&&n instanceof ArrayBuffer||e.Blob&&n instanceof Blob||e.File&&n instanceof File)return!0;if(i(n)){for(var s=0;s<n.length;s++)if(r(n[s]))return!0}else if(n&&"object"==typeof n){n.toJSON&&(n=n.toJSON());for(var o in n)if(t.prototype.hasOwnProperty.call(n,o)&&r(n[o]))return!0}return!1}return r(n)}var i=n("isarray");r.exports=s}).call(this,typeof self!="undefined"?self:typeof e!="undefined"?e:{})},{isarray:39}],39:[function(e,t,n){t.exports=e(32)},{}],40:[function(e,t,n){var r=e("global");try{t.exports="XMLHttpRequest"in r&&"withCredentials"in new r.XMLHttpRequest}catch(i){t.exports=!1}},{global:41}],41:[function(e,t,n){t.exports=function(){return this}()},{}],42:[function(e,t,n){var r=[].indexOf;t.exports=function(e,t){if(r)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}},{}],43:[function(e,n,r){var i=t.prototype.hasOwnProperty;r.keys=t.keys||function(e){var t=[];for(var n in e)i.call(e,n)&&t.push(n);return t},r.values=function(e){var t=[];for(var n in e)i.call(e,n)&&t.push(e[n]);return t},r.merge=function(e,t){for(var n in t)i.call(t,n)&&(e[n]=t[n]);return e},r.length=function(e){return r.keys(e).length},r.isEmpty=function(e){return 0==r.length(e)}},{}],44:[function(e,t,n){var r=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var n=r.exec(t||""),s={},o=14;while(o--)s[i[o]]=n[o]||"";return s}},{}],45:[function(t,r,i){(function(e){var r=t("isarray"),s=t("./is-buffer");i.deconstructPacket=function(e){function i(e){if(!e)return e;if(s(e)){var n={_placeholder:!0,num:t.length};return t.push(e),n}if(r(e)){var o=new Array(e.length);for(var u=0;u<e.length;u++)o[u]=i(e[u]);return o}if("object"!=typeof e||e instanceof Date)return e;var o={};for(var a in e)o[a]=i(e[a]);return o}var t=[],n=e.data,o=e;return o.data=i(n),o.attachments=t.length,{packet:o,buffers:t}},i.reconstructPacket=function(e,t){function s(e){if(e&&e._placeholder){var n=t[e.num];return n}if(r(e)){for(var i=0;i<e.length;i++)e[i]=s(e[i]);return e}if(e&&"object"==typeof e){for(var o in e)e[o]=s(e[o]);return e}return e}var i=0;return e.data=s(e.data),e.attachments=n,e},i.removeBlobs=function(t,n){function i(t,a,f){if(!t)return t;if(e.Blob&&t instanceof Blob||e.File&&t instanceof File){o++;var l=new FileReader;l.onload=function(){f?f[a]=this.result:u=this.result,--o||n(u)},l.readAsArrayBuffer(t)}else if(r(t))for(var c=0;c<t.length;c++)i(t[c],c,t);else if(t&&"object"==typeof t&&!s(t))for(var h in t)i(t[h],h,t)}var o=0,u=t;i(u),o||n(u)}}).call(this,typeof self!="undefined"?self:typeof e!="undefined"?e:{})},{"./is-buffer":47,isarray:48}],46:[function(e,t,n){function f(){}function l(e){var t="",s=!1;t+=e.type;if(n.BINARY_EVENT==e.type||n.BINARY_ACK==e.type)t+=e.attachments,t+="-";return e.nsp&&"/"!=e.nsp&&(s=!0,t+=e.nsp),null!=e.id&&(s&&(t+=",",s=!1),t+=e.id),null!=e.data&&(s&&(t+=","),t+=i.stringify(e.data)),r("encoded %j as %s",e,t),t}function c(e,t){function n(e){var n=u.deconstructPacket(e),r=l(n.packet),i=n.buffers;i.unshift(r),t(i)}u.removeBlobs(e,n)}function h(){this.reconstructor=null}function p(e){var t={},s=0;t.type=Number(e.charAt(0));if(null==n.types[t.type])return v();if(n.BINARY_EVENT==t.type||n.BINARY_ACK==t.type){var o="";while(e.charAt(++s)!="-"){o+=e.charAt(s);if(s==e.length)break}if(o!=Number(o)||e.charAt(s)!="-")throw new Error("Illegal attachments");t.attachments=Number(o)}if("/"==e.charAt(s+1)){t.nsp="";while(++s){var u=e.charAt(s);if(","==u)break;t.nsp+=u;if(s==e.length)break}}else t.nsp="/";var a=e.charAt(s+1);if(""!==a&&Number(a)==a){t.id="";while(++s){var u=e.charAt(s);if(null==u||Number(u)!=u){--s;break}t.id+=e.charAt(s);if(s==e.length)break}t.id=Number(t.id)}if(e.charAt(++s))try{t.data=i.parse(e.substr(s))}catch(f){return v()}return r("decoded %s as %j",e,t),t}function d(e){this.reconPack=e,this.buffers=[]}function v(e){return{type:n.ERROR,data:"parser error"}}var r=e("debug")("socket.io-parser"),i=e("json3"),s=e("isarray"),o=e("component-emitter"),u=e("./binary"),a=e("./is-buffer");n.protocol=4,n.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"],n.CONNECT=0,n.DISCONNECT=1,n.EVENT=2,n.ACK=3,n.ERROR=4,n.BINARY_EVENT=5,n.BINARY_ACK=6,n.Encoder=f,n.Decoder=h,f.prototype.encode=function(e,t){r("encoding packet %j",e);if(n.BINARY_EVENT==e.type||n.BINARY_ACK==e.type)c(e,t);else{var i=l(e);t([i])}},o(h.prototype),h.prototype.add=function(e){var t;if("string"==typeof e)t=p(e),n.BINARY_EVENT==t.type||n.BINARY_ACK==t.type?(this.reconstructor=new d(t),this.reconstructor.reconPack.attachments===0&&this.emit("decoded",t)):this.emit("decoded",t);else{if(!a(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,this.emit("decoded",t))}},h.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},d.prototype.takeBinaryData=function(e){this.buffers.push(e);if(this.buffers.length==this.reconPack.attachments){var t=u.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},d.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},{"./binary":45,"./is-buffer":47,"component-emitter":9,debug:10,isarray:48,json3:49}],47:[function(t,n,r){(function(e){function t(t){return e.Buffer&&e.Buffer.isBuffer(t)||e.ArrayBuffer&&t instanceof ArrayBuffer}n.exports=t}).call(this,typeof self!="undefined"?self:typeof e!="undefined"?e:{})},{}],48:[function(e,t,n){t.exports=e(32)},{}],49:[function(e,t,n){(function(e){function h(e){if(h[e]!==o)return h[e];var n;if(e=="bug-string-char-index")n="a"[0]!="a";else if(e=="json")n=h("json-stringify")&&h("json-parse");else{var r,i='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if(e=="json-stringify"){var s=f.stringify,u=typeof s=="function"&&l;if(u){(r=function(){return 1}).toJSON=r;try{u=s(0)==="0"&&s(new Number)==="0"&&s(new String)=='""'&&s(t)===o&&s(o)===o&&s()===o&&s(r)==="1"&&s([r])=="[1]"&&s([o])=="[null]"&&s(null)=="null"&&s([o,t,null])=="[null,null,null]"&&s({a:[r,true,false,null,"\0\b\n\f\r	"]})==i&&s(null,r)==="1"&&s([1,2],null,1)=="[\n 1,\n 2\n]"&&s(new Date(-864e13))=='"-271821-04-20T00:00:00.000Z"'&&s(new Date(864e13))=='"+275760-09-13T00:00:00.000Z"'&&s(new Date(-621987552e5))=='"-000001-01-01T00:00:00.000Z"'&&s(new Date(-1))=='"1969-12-31T23:59:59.999Z"'}catch(a){u=!1}}n=u}if(e=="json-parse"){var c=f.parse;if(typeof c=="function")try{if(c("0")===0&&!c(!1)){r=c(i);var p=r["a"].length==5&&r.a[0]===1;if(p){try{p=!c('"	"')}catch(a){}if(p)try{p=c("01")!==1}catch(a){}if(p)try{p=c("1.")!==1}catch(a){}}}}catch(a){p=!1}n=p}}return h[e]=!!n}var t={}.toString,i,s,o,u=typeof r=="function"&&r.amd,a=typeof JSON=="object"&&JSON,f=typeof n=="object"&&n&&!n.nodeType&&n;f&&a?(f.stringify=a.stringify,f.parse=a.parse):f=e.JSON=a||{};var l=new Date(-0xc782b5b800cec);try{l=l.getUTCFullYear()==-109252&&l.getUTCMonth()===0&&l.getUTCDate()===1&&l.getUTCHours()==10&&l.getUTCMinutes()==37&&l.getUTCSeconds()==6&&l.getUTCMilliseconds()==708}catch(c){}if(!h("json")){var p="[object Function]",d="[object Date]",v="[object Number]",m="[object String]",g="[object Array]",y="[object Boolean]",b=h("bug-string-char-index");if(!l)var w=Math.floor,E=[0,31,59,90,120,151,181,212,243,273,304,334],S=function(e,t){return E[t]+365*(e-1970)+w((e-1969+(t=+(t>1)))/4)-w((e-1901+t)/100)+w((e-1601+t)/400)};(i={}.hasOwnProperty)||(i=function(e){var n={},r;return(n.__proto__=null,n.__proto__={toString:1},n).toString!=t?i=function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(r=n.constructor,i=function(e){var t=(this.constructor||r).prototype;return e in this&&!(e in t&&this[e]===t[e])}),n=null,i.call(this,e)});var x={"boolean":1,number:1,string:1,"undefined":1},T=function(e,t){var n=typeof e[t];return n=="object"?!!e[t]:!x[n]};s=function(e,n){var r=0,o,u,a;(o=function(){this.valueOf=0}).prototype.valueOf=0,u=new o;for(a in u)i.call(u,a)&&r++;return o=u=null,r?r==2?s=function(e,n){var r={},s=t.call(e)==p,o;for(o in e)(!s||o!="prototype")&&!i.call(r,o)&&(r[o]=1)&&i.call(e,o)&&n(o)}:s=function(e,n){var r=t.call(e)==p,s,o;for(s in e)(!r||s!="prototype")&&i.call(e,s)&&!(o=s==="constructor")&&n(s);(o||i.call(e,s="constructor"))&&n(s)}:(u=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],s=function(e,n){var r=t.call(e)==p,s,o,a=!r&&typeof e.constructor!="function"&&T(e,"hasOwnProperty")?e.hasOwnProperty:i;for(s in e)(!r||s!="prototype")&&a.call(e,s)&&n(s);for(o=u.length;s=u[--o];a.call(e,s)&&n(s));}),s(e,n)};if(!h("json-stringify")){var N={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},C="000000",k=function(e,t){return(C+(t||0)).slice(-e)},L="\\u00",A=function(e){var t='"',n=0,r=e.length,i=r>10&&b,s;i&&(s=e.split(""));for(;n<r;n++){var o=e.charCodeAt(n);switch(o){case 8:case 9:case 10:case 12:case 13:case 34:case 92:t+=N[o];break;default:if(o<32){t+=L+k(2,o.toString(16));break}t+=i?s[n]:b?e.charAt(n):e[n]}}return t+'"'},O=function(e,n,r,u,a,f,l){var c,h,p,b,E,x,T,N,C,L,M,_,D,P,H,B;try{c=n[e]}catch(j){}if(typeof c=="object"&&c){h=t.call(c);if(h==d&&!i.call(c,"toJSON"))if(c>-1/0&&c<1/0){if(S){E=w(c/864e5);for(p=w(E/365.2425)+1970-1;S(p+1,0)<=E;p++);for(b=w((E-S(p,0))/30.42);S(p,b+1)<=E;b++);E=1+E-S(p,b),x=(c%864e5+864e5)%864e5,T=w(x/36e5)%24,N=w(x/6e4)%60,C=w(x/1e3)%60,L=x%1e3}else p=c.getUTCFullYear(),b=c.getUTCMonth(),E=c.getUTCDate(),T=c.getUTCHours(),N=c.getUTCMinutes(),C=c.getUTCSeconds(),L=c.getUTCMilliseconds();c=(p<=0||p>=1e4?(p<0?"-":"+")+k(6,p<0?-p:p):k(4,p))+"-"+k(2,b+1)+"-"+k(2,E)+"T"+k(2,T)+":"+k(2,N)+":"+k(2,C)+"."+k(3,L)+"Z"}else c=null;else typeof c.toJSON=="function"&&(h!=v&&h!=m&&h!=g||i.call(c,"toJSON"))&&(c=c.toJSON(e))}r&&(c=r.call(n,e,c));if(c===null)return"null";h=t.call(c);if(h==y)return""+c;if(h==v)return c>-1/0&&c<1/0?""+c:"null";if(h==m)return A(""+c);if(typeof c=="object"){for(P=l.length;P--;)if(l[P]===c)throw TypeError();l.push(c),M=[],H=f,f+=a;if(h==g){for(D=0,P=c.length;D<P;D++)_=O(D,c,r,u,a,f,l),M.push(_===o?"null":_);B=M.length?a?"[\n"+f+M.join(",\n"+f)+"\n"+H+"]":"["+M.join(",")+"]":"[]"}else s(u||c,function(e){var t=O(e,c,r,u,a,f,l);t!==o&&M.push(A(e)+":"+(a?" ":"")+t)}),B=M.length?a?"{\n"+f+M.join(",\n"+f)+"\n"+H+"}":"{"+M.join(",")+"}":"{}";return l.pop(),B}};f.stringify=function(e,n,r){var i,s,o,u;if(typeof n=="function"||typeof n=="object"&&n)if((u=t.call(n))==p)s=n;else if(u==g){o={};for(var a=0,f=n.length,l;a<f;l=n[a++],(u=t.call(l),u==m||u==v)&&(o[l]=1));}if(r)if((u=t.call(r))==v){if((r-=r%1)>0)for(i="",r>10&&(r=10);i.length<r;i+=" ");}else u==m&&(i=r.length<=10?r:r.slice(0,10));return O("",(l={},l[""]=e,l),s,o,i,"",[])}}if(!h("json-parse")){var M=String.fromCharCode,_={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},D,P,H=function(){throw D=P=null,SyntaxError()},B=function(){var e=P,t=e.length,n,r,i,s,o;while(D<t){o=e.charCodeAt(D);switch(o){case 9:case 10:case 13:case 32:D++;break;case 123:case 125:case 91:case 93:case 58:case 44:return n=b?e.charAt(D):e[D],D++,n;case 34:for(n="@",D++;D<t;){o=e.charCodeAt(D);if(o<32)H();else if(o==92){o=e.charCodeAt(++D);switch(o){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:n+=_[o],D++;break;case 117:r=++D;for(i=D+4;D<i;D++)o=e.charCodeAt(D),o>=48&&o<=57||o>=97&&o<=102||o>=65&&o<=70||H();n+=M("0x"+e.slice(r,D));break;default:H()}}else{if(o==34)break;o=e.charCodeAt(D),r=D;while(o>=32&&o!=92&&o!=34)o=e.charCodeAt(++D);n+=e.slice(r,D)}}if(e.charCodeAt(D)==34)return D++,n;H();default:r=D,o==45&&(s=!0,o=e.charCodeAt(++D));if(o>=48&&o<=57){o==48&&(o=e.charCodeAt(D+1),o>=48&&o<=57)&&H(),s=!1;for(;D<t&&(o=e.charCodeAt(D),o>=48&&o<=57);D++);if(e.charCodeAt(D)==46){i=++D;for(;i<t&&(o=e.charCodeAt(i),o>=48&&o<=57);i++);i==D&&H(),D=i}o=e.charCodeAt(D);if(o==101||o==69){o=e.charCodeAt(++D),(o==43||o==45)&&D++;for(i=D;i<t&&(o=e.charCodeAt(i),o>=48&&o<=57);i++);i==D&&H(),D=i}return+e.slice(r,D)}s&&H();if(e.slice(D,D+4)=="true")return D+=4,!0;if(e.slice(D,D+5)=="false")return D+=5,!1;if(e.slice(D,D+4)=="null")return D+=4,null;H()}}return"$"},j=function(e){var t,n;e=="$"&&H();if(typeof e=="string"){if((b?e.charAt(0):e[0])=="@")return e.slice(1);if(e=="["){t=[];for(;;n||(n=!0)){e=B();if(e=="]")break;n&&(e==","?(e=B(),e=="]"&&H()):H()),e==","&&H(),t.push(j(e))}return t}if(e=="{"){t={};for(;;n||(n=!0)){e=B();if(e=="}")break;n&&(e==","?(e=B(),e=="}"&&H()):H()),(e==","||typeof e!="string"||(b?e.charAt(0):e[0])!="@"||B()!=":")&&H(),t[e.slice(1)]=j(B())}return t}H()}return e},F=function(e,t,n){var r=I(e,t,n);r===o?delete e[t]:e[t]=r},I=function(e,n,r){var i=e[n],o;if(typeof i=="object"&&i)if(t.call(i)==g)for(o=i.length;o--;)F(i,o,r);else s(i,function(e){F(i,e,r)});return r.call(e,n,i)};f.parse=function(e,n){var r,i;return D=0,P=""+e,r=j(B()),B()!="$"&&H(),D=P=null,n&&t.call(n)==p?I((i={},i[""]=r,i),"",n):r}}}u&&r(function(){return f})})(this)},{}],50:[function(e,t,n){function r(e,t){var n=[];t=t||0;for(var r=t||0;r<e.length;r++)n[r-t]=e[r];return n}t.exports=r},{}]},{},[1])(1)});var ft=qc.defineBehaviour("qc.Plugins.BannerAd",qc.Behaviour,function(){var e=this;e.urlPC="",e.urlMobile="",e.height=48,e.location=ft.AD_LOCATION_BOTTOM},{urlPC:qc.Serializer.STRING,urlMobile:qc.Serializer.STRING,height:qc.Serializer.NUMBER,location:qc.Serializer.NUMBER});ft.__menu="Plugins/BannerAd",ft.AD_LOCATION_TOP=0,ft.AD_LOCATION_BOTTOM=1,ft.prototype.awake=function(){this.display()},ft.prototype.display=function(){var e=this;if(document.getElementById("bannerAdDiv")!==null)return;var t=document.getElementById("gameDiv"),n=document.createElement("div"),r=e.location===ft.AD_LOCATION_TOP?-e.game.height:-e.height,i=qc.Util.formatString("position:relative;top:{0}px;height:{1}px",r,e.height);n.setAttribute("style",i),n.setAttribute("id","bannerAdDiv"),t.appendChild(n),frame=document.createElement("iframe");var s=e.game.device.desktop?e.urlPC:e.urlMobile;s=s+"?valign="+(e.location===ft.AD_LOCATION_TOP?"top":"bottom"),frame.setAttribute("src",s),frame.setAttribute("width","100%"),frame.setAttribute("height","100%"),frame.setAttribute("frameborder","0"),frame.setAttribute("scrolling","no"),n.appendChild(frame)},ft.prototype.hide=function(){var e=this,t=document.getElementById("bannerAdDiv");t!==null&&t.parentElement.removeChild(t)};var lt=qc.defineBehaviour("qc.Plugins.PopupAd",qc.Behaviour,function(){var e=this;e.urlPC="",e.urlMobile="",e.widthPC=100,e.heightPC=100,e.closeImgUrl="",e.closeImgWidth=0,e.closeImgHeight=0,e.onAccessAd=new qc.Signal,e.adTimer=n},{urlPC:qc.Serializer.STRING,urlMobile:qc.Serializer.STRING,widthPC:qc.Serializer.NUMBER,heightPC:qc.Serializer.NUMBER,closeImgUrl:qc.Serializer.STRING,closeImgWidth:qc.Serializer.NUMBER,closeImgHeight:qc.Serializer.NUMBER});lt.__menu="Plugins/PopupAd",lt.prototype.display=function(){var e=this;if(document.getElementById("popupAdDiv")!==null)return;var t=document.getElementById("gameDiv");t.style.pointerEvents="none";var n=document.createElement("div"),r,i;e.game.device.desktop?(r=e.widthPC,i=e.heightPC):r=i=Math.min(e.game.width,e.game.height);var s=(e.game.height-i)/2,o=(e.game.width-r)/2,u=qc.Util.formatString("position:absolute;top:{0}px;left:{1}px;width:{2}px;height:{3}px",s,o,r,i);n.setAttribute("style",u),n.setAttribute("id","popupAdDiv"),t.parentElement.appendChild(n),frame=document.createElement("iframe"),frame.setAttribute("src",e.game.device.desktop?e.urlPC:e.urlMobile),frame.setAttribute("width","100%"),frame.setAttribute("height","100%"),frame.setAttribute("frameborder","0"),frame.setAttribute("scrolling","no"),n.appendChild(frame);var a=document.createElement("div");a.setAttribute("style","position:absolute;top:0px;right:0px;"),n.appendChild(a);var f=document.createElement("img");f.setAttribute("src",e.closeImgUrl),f.setAttribute("width",e.closeImgWidth),f.setAttribute("height",e.closeImgHeight),e.game.device.desktop?f.addEventListener("click",e.hide.bind(e),!0):f.addEventListener("touchend",e.hide.bind(e),!0),a.appendChild(f),e.adTimer=e.game.timer.loop(500,function(){document.activeElement===frame&&(e.game.timer.remove(e.adTimer),e.onAccessAd.dispatch())})},lt.prototype.hide=function(){var e=this,t=document.getElementById("gameDiv");t.style.pointerEvents="auto";var n=document.getElementById("popupAdDiv");n!==null&&n.parentElement.removeChild(n),e.game.timer.remove(e.adTimer)};var r=function(t){var n=t.split("."),r=e;for(var i=0;i<n.length;i++)r[n[i]]||(r[n[i]]={}),r=r[n[i]]};r("com.qici.extraUI");var ct=qc.ScrollView,ht=com.qici.extraUI.ScrollSupport=function(e,t,n,r,i){this.game=e,this.node=t,this._getViewRect=n,this._getContentRect=r,this._setContentPosition=i,this.canHorizontal=!0,this.canVertical=!0,this.movementType=ct.MOVEMENT_ELASTIC,this.elasticity=1,this.inertia=!0,this.decelerationRate=.03,this.scrollSensitivity=1,this.propagationScroll=!1,this.onValueChange=new Phaser.Signal,this._preContentPosition=null,this._preContentRect=null,this._preViewRect=null,this._velocity=new qc.Point(0,0),this._isDragging=!1,this.pivotX=0,this.pivotY=0,this.node&&(this.node.onWheel.add(this._doWheel,this),this.node.onDragStart.add(this._doDragStart,this),this.node.onDrag.add(this._doDrag,this),this.node.onDragEnd.add(this._doDragEnd,this))};ht.prototype={},ht.prototype.constructor=ht,t.defineProperties(ht.prototype,{horizontalScrollBar:{get:function(){return this._horizontalScrollBar&&this._horizontalScrollBar._destroy&&(this._horizontalScrollBar=null),this._horizontalScrollBar},set:function(e){this._horizontalScrollBar&&this._horizontalScrollBar.onValueChange.remove(this._setHorizontalNormalizedPosition,this),this._horizontalScrollBar=e,this._horizontalScrollBar&&this._horizontalScrollBar.onValueChange.add(this._setHorizontalNormalizedPosition,this)}},verticalScrollBar:{get:function(){return this._verticalScrollBar&&this._verticalScrollBar._destroy&&(this._verticalScrollBar=null),this._verticalScrollBar},set:function(e){this._verticalScrollBar&&this._verticalScrollBar.onValueChange.remove(this._setVerticalNormalizedPosition,this),this._verticalScrollBar=e,this._verticalScrollBar&&this._verticalScrollBar.onValueChange.add(this._setVerticalNormalizedPosition,this)}},horizontalNormalizedPosition:{get:function(){return this._updateBounds(),this._contentRect.width<=this._viewRect.width?this._viewRect.x>this._contentRect.x?1:0:(this._viewRect.x-this._contentRect.x)/(this._contentRect.width-this._viewRect.width)},set:function(e){this.setNormalizedPosition(e,0)}},verticalNormalizedPosition:{get:function(){return this._updateBounds(),this._contentRect.height<=this._viewRect.height?this._viewRect.y>this._contentRect.y?1:0:(this._viewRect.y-this._contentRect.y)/(this._contentRect.height-this._viewRect.height)},set:function(e){this.setNormalizedPosition(e,1)}}}),ht.prototype.destroy=function(){this.node&&(this.node.onWheel.remove(this._doWheel,this),this.node.onDragStart.remove(this._doDragStart,this),this.node.onDrag.remove(this._doDrag,this),this.node.onDragEnd.remove(this._doDragEnd,this)),this.node=null,this._setContentPosition=null,this._getContentRect=null,this._getViewRect=null,this.horizontalScrollBar=null,this.verticalScrollBar=null},ht.prototype.update=function(e){this._updateVelocity(e)},ht.prototype.getViewRect=function(){return this._getViewRect?this._getViewRect():new qc.Rectangle(0,0,0,0)},ht.prototype.getContentRect=function(){return this._getContentRect?this._getContentRect():new qc.Rectangle(0,0,0,0)},ht.prototype.setContentPosition=function(e,t){this._setContentPosition&&this._setContentPosition(e,t)},ht.prototype._setHorizontalNormalizedPosition=function(e){this.setNormalizedPosition(e,0)},ht.prototype._setVerticalNormalizedPosition=function(e){this.setNormalizedPosition(e,1)},ht.prototype._calculateOffset=function(e,t){var n=new qc.Point(0,0);if(this.movementType===ct.MOVEMENT_UNRESTRICTED)return n;var r=this.getViewRect(),i=this._contentRect,s=new qc.Point(i.x,i.y),o=new qc.Point(i.x+i.width,i.y+i.height);return this.canHorizontal&&(s.x+=e,o.x+=e,s.x>r.x?n.x=r.x-s.x:o.x<r.x+r.width&&(n.x=r.x+r.width-o.x)),this.canVertical&&(s.y+=t,o.y+=t,s.y>r.y?n.y=r.y-s.y:o.y<r.y+r.height&&(n.y=r.y+r.height-o.y)),n},ht.prototype._calcVelocityEffect=function(e,t,n,r){if(this.movementType===ct.MOVEMENT_ELASTIC&&t[r]!==0){var i=this["_lastOffset_"+r]||0;Math.abs(i)<Math.abs(t[r])?(this["_lastOffset_"+r]=t[r],this._currSmoothetTime=n):(this["_lastOffset_"+r]=t[r],this._currSmoothetTime+=n);var s=this.elasticity<=0?n:this.elasticity,o=this.game.math.smoothDamp(e[r],e[r]+t[r],this._velocity[r],this.elasticity,Number.MAX_VALUE,n/100);Math.abs(e[r]+t[r]-o[0])<1e-4?(e[r]=e[r]+t[r],this._velocity[r]=0):(e[r]=o[0],this._velocity[r]=o[1])}else if(this.movementType===ct.MOVEMENT_CLAMPED&&t[r]!==0)e[r]=e[r]+t[r];else if(this.inertia){var u=this._velocity[r]*Math.pow(Math.abs(this.decelerationRate),n/1e3);Math.abs(u)<1&&(u=0),this._velocity[r]=u,e[r]=e[r]+u*n/1e3}else this._velocity[r]=0},ht.prototype._rubberDelta=function(e,t){return(1-1/(Math.abs(e)*.55/t+1))*t*this.game.math.sign(e)},ht.prototype._updateVelocity=function(e){var t,n;this._updateBounds();var r=this._calculateOffset(0,0);!this._isDragging&&(r.x!==0||r.y!==0||this._velocity.x!==0||this._velocity.y!==0)&&(t=this.getContentRect(),n=new qc.Point(t.x,t.y),this._calcVelocityEffect(n,r,e,"x"),this._calcVelocityEffect(n,r,e,"y"),(this._velocity.x!==0||this._velocity.y!==0)&&this.movementType===ct.MOVEMENT_CLAMPED&&(r=this._calculateOffset(n.x-t.x,n.y-t.y),n.x+=r.x,n.y+=r.y),this.setContentPosition(n.x,n.y));if(this._isDragging&&this.inertia){t=this.getContentRect();var i=t.x-this._preContentPosition.x,s=t.y-this._preContentPosition.y,o=this.game.math.clamp(e/1e3,0,1);this._velocity.x=i/o,this._velocity.y=s/o}if(!this._preViewRect||!qc.Rectangle.equals(this._viewRect,this._preViewRect)||!this._preContentRect||!qc.Rectangle.equals(this._contentRect,this._preContentRect))this._updateScrollBars(r.x,r.y),this.onValueChange.dispatch(new qc.Point(this.horizontalNormalizedPosition,this.verticalNormalizedPosition)),this._updatePrevData()},ht.prototype.setNormalizedPosition=function(e,t){this._updateBounds();if(!this._contentRect)return;var n=this.getContentRect(),r=t?"height":"width",i=t?"y":"x",s=this._contentRect[r]-this._viewRect[r],o=this._viewRect[i]-e*s,u=n[i]+o-this._contentRect[i],a=n[i];Math.abs(a-u)>1&&(n[i]=u,this.setContentPosition(n.x,n.y),this._velocity[i]=0,this._updateBounds())},ht.prototype._updatePrevData=function(){var e=this.getContentRect();this._preContentPosition=new qc.Point(e.x,e.y),this._preContentRect=this._contentRect,this._preViewRect=this._viewRect},ht.prototype._updateScrollBars=function(e,t){var n;this.horizontalScrollBar&&(this._contentRect.width>0?(n=(this._viewRect.width-Math.abs(e))/this._contentRect.width,this.horizontalScrollBar.size=Phaser.Math.clamp(n,0,1)):this.horizontalScrollBar.size=1,this.horizontalScrollBar.value=this.horizontalNormalizedPosition),this.verticalScrollBar&&(this._contentRect.height>0?(n=(this._viewRect.height-Math.abs(t))/this._contentRect.height,this.verticalScrollBar.size=Phaser.Math.clamp(n,0,1)):this.verticalScrollBar.size=1,this.verticalScrollBar.value=this.verticalNormalizedPosition)},ht.prototype._updateBounds=function(){var e=this._viewRect=this.getViewRect();this._updateContentBounds();if(!this._getContentRect)return;var t=e.width-this._contentRect.width,n=e.height-this._contentRect.height;t>0&&(this._contentRect.width=e.width,this._contentRect.x-=t*this.pivotX),n>0&&(this._contentRect.height=e.height,this._contentRect.y-=n*this.pivotY)},ht.prototype._updateContentBounds=function(){this._contentRect=this.getContentRect()},ht.prototype._doWheel=function(e,t){this._updateBounds();var n=new qc.Point(t.source.deltaX,t.source.deltaY);this.canVertical||(n.y=0),this.canHorizontal||(n.x=0);var r=n.x*this.scrollSensitivity,i=n.y*this.scrollSensitivity;this.doScroll(r,i,!1)},ht.prototype._doDragStart=function(e,t){if(t.source.eventId!==qc.Mouse.BUTTON_LEFT)return;this._updateBounds();var n=this.getContentRect();this._contentStartPosition=new qc.Point(n.x,n.y),this._pointerStartCursor=this.node.toLocal(new qc.Point(t.source.startX,t.source.startY)),this._isDragging=!0},ht.prototype._doDragEnd=function(e,t){if(t.source.eventId!==qc.Mouse.BUTTON_LEFT)return;this._isDragging=!1},ht.prototype._doDrag=function(e,t){if(t.source.eventId!==qc.Mouse.BUTTON_LEFT)return;this._updateBounds();var n=this.getContentRect(),r=this.node.toLocal(new qc.Point(t.source.x,t.source.y));if(!this._pointerStartCursor)return;var i=this.canHorizontal?r.x-this._pointerStartCursor.x:0,s=this.canVertical?r.y-this._pointerStartCursor.y:0;this.doScroll(this._contentStartPosition.x+i-n.x,this._contentStartPosition.y+s-n.y,!0)},ht.prototype.doScroll=function(e,t,n){var r=this.getContentRect(),i=new qc.Point(r.x,r.y);i.x+=e,i.y+=t;var s=this._calculateOffset(e,t);i.x+=s.x,i.y+=s.y;if(this.movementType===ct.MOVEMENT_CLAMPED&&this.propagationScroll){var o=this.parent;while(!(o instanceof ct)&&o!==this.game.world)o=o.parent;o instanceof ct&&o.doScroll(-s.x,-s.y,n)}else this.movementType===ct.MOVEMENT_ELASTIC&&(n?(s.x!==0&&(i.x=i.x-this._rubberDelta(s.x,this._viewRect.width)),s.y!==0&&(i.y=i.y-this._rubberDelta(s.y,this._viewRect.height))):(i.x-=s.x,i.y-=s.y,Math.abs(s.x)>this._viewRect.width&&(i.x+=s.x-this.game.math.sign(s.x)*this._viewRect.width),Math.abs(s.y)>this._viewRect.height&&(i.y+=s.y-this.game.math.sign(s.y)*this._viewRect.height)));this.setContentPosition(i.x,i.y),n||this._updateBounds()};var pt=qc.defineBehaviour("com.qici.extraUI.TableViewAdapter",qc.Behaviour,function(){var e=this;e.onDataChange=new qc.Signal},{});t.defineProperties(pt.prototype,{}),pt.prototype.dispatchDataChange=function(){this.onDataChange.dispatch()},pt.prototype.getTableSize=function(){return{x:1,y:Infinity}},pt.prototype.findCellWithPos=function(e,t){return{x:Math.floor(e/100),y:Math.floor(t/100)}},pt.prototype.getCellRect=function(e,t){return new qc.Rectangle(e*100,t*100,100,100)},pt.prototype.revokeCell=function(e,t,n){},pt.prototype.createCell=function(e,t,n){};var dt=qc.defineBehaviour("com.qici.extraUI.TableView",qc.Behaviour,function(){var e=this;e._cellPool=[],e._usingCell=[],e._showRect=new qc.Rectangle(0,0,0,0),e.scrollSupport=new com.qici.extraUI.ScrollSupport(e.game,e.gameObject,e._getViewRect.bind(e),e._getContentRect.bind(e),e._setContentPosition.bind(e)),e.runInEditor=!0},{content:qc.Serializer.NODE,adapterNode:qc.Serializer.NODE,horizontalScrollBar:qc.Serializer.NODE,verticalScrollBar:qc.Serializer.NODE,cellPrefab:qc.Serializer.PREFAB,overflow:qc.Serializer.BOOLEAN,canHorizontal:qc.Serializer.BOOLEAN,canVertical:qc.Serializer.BOOLEAN,movementType:qc.Serializer.NUMBER,elasticity:qc.Serializer.NUMBER,inertia:qc.Serializer.BOOLEAN,decelerationRate:qc.Serializer.NUMBER,scrollSensitivity:qc.Serializer.NUMBER,propagationScroll:qc.Serializer.BOOLEAN,extraLeft:qc.Serializer.NUMBER,extraRight:qc.Serializer.NUMBER,extraTop:qc.Serializer.NUMBER,extraBottom:qc.Serializer.NUMBER});t.defineProperties(dt.prototype,{adapterNode:{get:function(){return this._adapterNode||this.gameObject},set:function(e){if(e===this._adapterNode)return;this._adapterNode=e,this._adapter&&(this._adapter.onDataChange.remove(this._clearTable,this),this._adapter=null),this._needRebuild=!0}},adapter:{get:function(){return this._adapter||(this._adapter=this.adapterNode&&this.adapterNode.getScript("com.qici.extraUI.TableViewAdapter"),this._adapter&&this._adapter.onDataChange.add(this._clearTable,this)),this._adapter}},content:{get:function(){return this._content&&this._content._destroy&&(this.content=null),this._content},set:function(e){var t=this;t._content&&(t._content.onChildrenChanged.remove(t._doChildrenChanged,t),t._content.onLayoutArgumentChanged.remove(t._doLayoutArgumentChanged,t)),t._content=e,t._needRebuild=!0,t._content&&(t._content.onChildrenChanged.add(t._doChildrenChanged,t),t._content.onLayoutArgumentChanged.add(t._doLayoutArgumentChanged,t))}},cellPrefab:{get:function(){return this._cellPrefab},set:function(e){if(e===this._cellPrefab)return;this._cellPrefab=e,this.content&&this.content.removeChildren(),this._cellPool=[],this._needRebuild=!0}},overflow:{get:function(){return this._overflow},set:function(e){if(e===this._overflow)return;this._overflow=e,this._needRebuild=!0}},extraLeft:{get:function(){return this._extraLeft||0},set:function(e){if(e===this._extraLeft)return;this._extraLeft=e,this._needRebuild=!0}},extraRight:{get:function(){return this._extraRight||0},set:function(e){if(e===this._extraRight)return;this._extraRight=e,this._needRebuild=!0}},extraTop:{get:function(){return this._extraTop||0},set:function(e){if(e===this._extraTop)return;this._extraTop=e,this._needRebuild=!0}},extraBottom:{get:function(){return this._extraBottom||0},set:function(e){if(e===this._extraBottom)return;this._extraBottom=e,this._needRebuild=!0}},canHorizontal:{get:function(){return this.scrollSupport?this.scrollSupport.canHorizontal:null},set:function(e){this.scrollSupport&&(this.scrollSupport.canHorizontal=e)}},canVertical:{get:function(){return this.scrollSupport?this.scrollSupport.canVertical:null},set:function(e){this.scrollSupport&&(this.scrollSupport.canVertical=e)}},movementType:{get:function(){return this.scrollSupport?this.scrollSupport.movementType:null},set:function(e){this.scrollSupport&&(this.scrollSupport.movementType=e)}},elasticity:{get:function(){return this.scrollSupport?this.scrollSupport.elasticity:null},set:function(e){this.scrollSupport&&(this.scrollSupport.elasticity=e)}},inertia:{get:function(){return this.scrollSupport?this.scrollSupport.inertia:null},set:function(e){this.scrollSupport&&(this.scrollSupport.inertia=e)}},decelerationRate:{get:function(){return this.scrollSupport?this.scrollSupport.decelerationRate:null},set:function(e){this.scrollSupport&&(this.scrollSupport.decelerationRate=e)}},scrollSensitivity:{get:function(){return this.scrollSupport?this.scrollSupport.scrollSensitivity:null},set:function(e){this.scrollSupport&&(this.scrollSupport.scrollSensitivity=e)}},propagationScroll:{get:function(){return this.scrollSupport?this.scrollSupport.propagationScroll:null},set:function(e){this.scrollSupport&&(this.scrollSupport.propagationScroll=e)}},horizontalScrollBar:{get:function(){return this.scrollSupport?this.scrollSupport.horizontalScrollBar:null},set:function(e){this.scrollSupport&&(this.scrollSupport.horizontalScrollBar=e)}},verticalScrollBar:{get:function(){return this.scrollSupport?this.scrollSupport.verticalScrollBar:null},set:function(e){this.scrollSupport&&(this.scrollSupport.verticalScrollBar=e)}},horizontalNormalizedPosition:{get:function(){return this.scrollSupport?this.scrollSupport.horizontalNormalizedPosition:null},set:function(e){this.scrollSupport&&this.scrollSupport.setNormalizedPosition(e,0)}},verticalNormalizedPosition:{get:function(){return this.scrollSupport?this.scrollSupport.verticalNormalizedPosition:null},set:function(e){this.scrollSupport&&this.scrollSupport.setNormalizedPosition(e,1)}}}),dt.prototype.awake=function(){},dt.prototype.onDestroy=function(){var e=this;e.content=null,e.cellPrefab=null,e._adapter=null,e.adapterNode=null,e._cellPool=[],e._showCell=[],e._usingCell=[]},dt.prototype.update=function(){this.content&&(this.scrollSupport.pivotX=this.content.pivotX,this.scrollSupport.pivotY=this.content.pivotY),this.scrollSupport.update(this.game.time.deltaTime),this._needRebuild&&this._rebuildTable()},dt.prototype.relayout=function(){this._rebuildTable()},dt.prototype._clearTable=function(){var e=this,t=e.gameObject,n=e.content;n.x=0,n.y=0,e.revokeAllCell()},dt.prototype.revokeAllCell=function(){var e=this,t=e.content;t.removeChildren(),Array.prototype.push.apply(e._cellPool,e._usingCell),e._usingCell=[]},dt.prototype._revokeCell=function(e){var t=this;t._cellPool.push(e);var n=t._usingCell.indexOf(e);n>=0&&t._usingCell.splice(n,1)},dt.prototype._createCell=function(){var e=this;if(!e._cellPrefab)return null;var t=e._cellPool.pop()||e.game.add.clone(e._cellPrefab,e.gameObject);return t&&e._usingCell.push(t),t},dt.prototype._getViewRect=function(){return this.gameObject.rect},dt.prototype._getContentRect=function(){var e=this,t=e.adapter,n=e.content;if(!n||!t)return new qc.Rectangle(0,0,0,0);var r=t.getTableSize(),i=r.x<Infinity?r.x-1:0,s=r.y<Infinity?r.y-1:0,o=t.getCellRect(i,s);return new qc.Rectangle(n.x,n.y,r.x<Infinity?o.x+o.width:Infinity,r.y<Infinity?o.y+o.height:Infinity)},dt.prototype._setContentPosition=function(e,t){var n=this,r=n.content;if(!r)return;r.x=e,r.y=t,n._rebuildTable()},dt.prototype._getViewRectInTable=function(){var e=this,t=e.gameObject,n=t.rect,r=e.content;return r?new qc.Rectangle(n.x-e.extraLeft-r.x,n.y-e.extraTop-r.y,n.width+e.extraLeft+e.extraRight,n.height+e.extraTop+e.extraBottom):new qc.Rectangle(0,0,0,0)},dt.prototype._setCellRect=function(e,t,n,r,i){var s=this,o=s.content;if(!o||!e)return;e.x=t,e.y=n,e.width=r,e.height=i},dt.prototype._rebuildTable=function(){var e=this,t=e.adapter,n=e.content;if(!n)return;if(!t){this._clearTable();return}var r=t.getTableSize();if(r.x<=0||r.y<=0||r.x===Infinity&&r.y===Infinity){this._clearTable();return}var i=e._getViewRectInTable(),s=e._showRect,o=i.x,u=i.x+i.width,a=i.y,f=i.y+i.height,l=t.findCellWithPos(o,a),c=t.findCellWithPos(u,f);if(!e.overflow){var h=t.findCellWithPos(o-1,a-1),p=t.findCellWithPos(u+1,f+1);h.x===l.x&&++l.x,h.y===l.y&&++l.y,p.x===c.x&&--c.x,p.y===c.y&&--c.y}var d=Math.max(l.x,0),v=Math.max(l.y,0),m=Math.min(c.x,r.x-1),g=Math.min(c.y,r.y-1),y=n.children,b=s.width*s.height;b!==y.length&&(n.removeChildren(),s.setTo(0,0,0,0),b=0);var w,E,S,x,T,N=b-1;for(E=s.y+s.height-1,x=s.y;E>=x;--E)for(S=s.x+s.width-1,T=s.x;S>=T;--S,--N){if(S>=d&&S<=m&&E>=v&&E<=g)continue;w=n.removeChildAt(N),t.revokeCell(w,S,E),e._revokeCell(w)}var C=Math.max(s.x,d),k=Math.max(s.y,v),L=Math.min(s.x+s.width-1,m),A=Math.min(s.y+s.height-1,g),O=m-d+1,M=g-v+1;if(O>0&&M>0){N=0;for(E=v;E<=g;++E)for(S=d;S<=m;++S,++N){if(S>=C&&S<=L&&E>=k&&E<=A)continue;w=e._createCell();if(!w)continue;n.addChildAt(w,N);var _=t.getCellRect(S,E);e._setCellRect(w,_.x,_.y,_.width,_.height),t.createCell(w,S,E)}}s.setTo(d,v,O,M)},dt.prototype._doChildrenChanged=function(e){this._needRebuild=!0},dt.prototype._doLayoutArgumentChanged=function(){this._needRebuild=!0};var vt=qc.defineBehaviour("qc.Plugins.LockOrientation",qc.Behaviour,function(){var e=this;e.orientation=e.game.device.orientation,e.desktop=!1,e.runInEditor=!0,e.manualType=0},{orientation:qc.Serializer.INT,desktop:qc.Serializer.BOOLEAN,manualType:qc.Serializer.INT});vt.__menu="Plugins/LockOrientation",t.defineProperties(vt.prototype,{orientation:{get:function(){return this._orientation},set:function(e){if(e===this._orientation)return;this._orientation=e,this._doOrientation(this.game.device.orientation)}}}),vt.prototype.awake=function(){var e=this,t=e.gameObject;e.addListener(e.game.world.onSizeChange,e._doOrientation,e),e.addListener(t.parent.onRelayout,e.assureSize,e),e._doOrientation(),e.assureSize();var n=t.parent.getScript("qc.ScaleAdapter");if(n){var r=n.getReferenceResolution;n.getReferenceResolution=function(){var t=r.call(this);return e.rotate90?new qc.Point(t.y,t.x):t}}},vt.prototype.assureSize=function(){var e=this,t=e.gameObject,n=t.parent.rect;e.rotate90===!0?(t.width=n.height,t.height=n.width):(t.width=n.width,t.height=n.height),t.setAnchor(new qc.Point(.5,.5),new qc.Point(.5,.5)),t.anchoredX=0,t.anchoredY=0,t.pivotX=.5,t.pivotY=.5},vt.prototype._doOrientation=function(){var e=this,t=e.gameObject,n=e.game.device.orientation;if(!e.desktop&&!e.game.editor&&e.game.device.desktop){t.rotation=0,e.rotate90=!1;return}switch(e.orientation){case qc.Device.AUTO:default:t.rotation=0,e.rotate90=!1;return;case qc.Device.PORTRAIT:case qc.Device.LANDSCAPE:n===e.orientation?(t.rotation=0,e.rotate90=!1):(t.rotation=-Math.PI/2,e.rotate90=!0),e.assureSize()}var r=t.parent.getScript("qc.ScaleAdapter");r&&(e.rotate90?e.manualType===qc.ScaleAdapter.MANUAL_WIDTH?r.manualType=qc.ScaleAdapter.MANUAL_HEIGHT:e.manualType===qc.ScaleAdapter.MANUAL_HEIGHT?r.manualType=qc.ScaleAdapter.MANUAL_WIDTH:r.manualType=e.manualType:r.manualType=e.manualType)};var mt=qc.defineBehaviour("qc.Plugins.NodeFadeInOut",qc.Tween,function(){this.fadeType=mt.FADE_IN,this.columnCount=1,this.rowCount=1,this.pivotX=.5,this.pivotY=.5,this.fadeStyle=mt.STYLE_ZOOM,this.fadeEffect=mt.EFFECT_XY,this.target=null},{fadeType:qc.Serializer.NUMBER,columnCount:qc.Serializer.NUMBER,rowCount:qc.Serializer.NUMBER,pivotX:qc.Serializer.NUMBER,pivotY:qc.Serializer.NUMBER,fadeStyle:qc.Serializer.NUMBER,fadeEffect:qc.Serializer.NUMBER,target:qc.Serializer.NODE});mt.__menu="Plugins/NodeFadeInOut",t.defineProperties(mt.prototype,{columnCount:{get:function(){return this._columnCount},set:function(e){e=isNaN(e)||e===0?1:e;if(e===this._columnCount)return;this._columnCount=e}},rowCount:{get:function(){return this._rowCount},set:function(e){e=isNaN(e)||e===0?1:e;if(e===this._rowCount)return;this._rowCount=e}},_cachedTarget:{get:function(){return this.target&&this.target._destroy&&(this.target=null),this.target||this.gameObject}}}),mt.prototype.onEnable=function(){var e=this;if(e._cachedTarget._destroy)return;e._cachedTarget.visible=!0,e._cachedTexture&&(e._cachedTexture.destroy(!0),e._cachedTexture=null),e._cachedBounds=e._cachedTarget.localBounds,e._cachedTexture=e._cachedTarget.generateTexture(),e._cachedSprite=new PIXI.Sprite(e._cachedTexture),e._cachedSprite.worldTransform=e._cachedTarget.worldTransform,e._cachedTarget.phaser.anchor&&(e._cachedSprite.anchor=e._cachedTarget.phaser.anchor),e._nodeRenderCanvas||(e._nodeRenderCanvas=e.gameObject.phaser._renderCanvas,e.gameObject.phaser._renderCanvas=e.renderCanvas.bind(this),e.gameObject.phaser.getSelfWidth=function(){return e._cachedSprite.width},e.gameObject.phaser.getSelfHeight=function(){return e._cachedSprite.height},e.gameObject.phaser._skipChildrenRender=!0),e._nodeRenderWebGL||(e._nodeRenderWebGL=e.gameObject.phaser._renderWebGL,e.gameObject.phaser._renderWebGL=e.renderWebGL.bind(this))},mt.prototype.onDisable=function(){this._nodeRenderCanvas&&(this.gameObject.phaser._renderCanvas=this._nodeRenderCanvas,this._nodeRenderCanvas=null),this._nodeRenderWebGL&&(this.gameObject.phaser._renderWebGL=this._nodeRenderWebGL,this._nodeRenderWebGL=null,this.gameObject.phaser.getSelfWidth=null,this.gameObject.phaser.getSelfHeight=null,this.gameObject.phaser._skipChildrenRender=!1),this._cachedTexture&&(this._cachedTexture.destroy(!0),this._cachedTexture=null),this._cachedSprite&&(this._cachedSprite=null),qc.Tween.prototype.onDisable.call(this)},mt.prototype.onDestroy=function(){this._nodeRenderCanvas&&(this.gameObject.phaser._renderCanvas=this._nodeRenderCanvas,this._nodeRenderCanvas=null),this._nodeRenderWebGL&&(this.gameObject.phaser._renderWebGL=this._nodeRenderWebGL,this._nodeRenderWebGL=null),this._cachedTexture&&(this._cachedTexture.destroy(!0),this._cachedTexture=null),this._cachedSprite&&(this._cachedSprite=null),qc.Tween.prototype.onDestroy&&qc.Tween.prototype.onDestroy.call(this)},mt.prototype.onUpdate=function(e,t){this._factorValue=this.fadeType===mt.FADE_IN?1-e:e,this.gameObject.phaser.displayChanged(qc.DisplayChangeStatus.TEXTURE|qc.DisplayChangeStatus.SIZE),t&&!this._cachedTarget._destroy&&this._cachedTarget===this.gameObject&&(this._cachedTarget.visible=this.fadeType===mt.FADE_IN)},mt.prototype.renderCanvas=function(e){this._cachedTarget!==this.gameObject&&this._nodeRenderCanvas.call(this.gameObject.phaser,e);var t=this._cachedTexture,n=this._cachedSprite,r=this._cachedBounds;if(t){var i=t.baseTexture.resolution/e.resolution;e.context.globalAlpha=n.worldAlpha,e.smoothProperty&&e.scaleMode!==t.baseTexture.scaleMode&&(e.scaleMode=t.baseTexture.scaleMode,e.context[e.smoothProperty]=e.scaleMode===PIXI.scaleModes.LINEAR);var s=t.trim?t.trim.x-n.anchor.x*t.trim.width:n.anchor.x*-t.frame.width,o=t.trim?t.trim.y-n.anchor.y*t.trim.height:n.anchor.y*-t.frame.height;e.roundPixels?(e.context.setTransform(n.worldTransform.a,n.worldTransform.b,n.worldTransform.c,n.worldTransform.d,n.worldTransform.tx*e.resolution|0,n.worldTransform.ty*e.resolution|0),s|=0,o|=0):e.context.setTransform(n.worldTransform.a,n.worldTransform.b,n.worldTransform.c,n.worldTransform.d,n.worldTransform.tx*e.resolution,n.worldTransform.ty*e.resolution);var u=t.crop.width/this.columnCount,a=t.crop.height/this.rowCount,f=this.fadeEffect===mt.EFFECT_X||this.fadeEffect===mt.EFFECT_XY,l=this.fadeEffect===mt.EFFECT_Y||this.fadeEffect===mt.EFFECT_XY,c=(f?1-this._factorValue:1)*u/i,h=(l?1-this._factorValue:1)*a/i,p=f&&this.fadeStyle===mt.STYLE_CLIP?u*(1-this._factorValue):u,d=l&&this.fadeStyle===mt.STYLE_CLIP?a*(1-this._factorValue):a;for(var v=0;v<t.crop.height;v+=a){var m=(o+v+a*(l?this._factorValue:0)*this.pivotY)/i+r.y;for(var g=0;g<t.crop.width;g+=u){var y=(s+g+u*(f?this._factorValue:0)*this.pivotX)/i+r.x;e.context.drawImage(t.baseTexture.source,t.crop.x+g,t.crop.y+v,p,d,y,m,c,h)}}}},mt.prototype.renderWebGL=function(e){this._cachedTarget!==this.gameObject&&this._nodeRenderWebGL.call(this.gameObject.phaser,e);var t=this._cachedTexture,n=this._cachedBounds,r=this._cachedSprite,i=t._uvs;if(!i)return;var s=t.baseTexture.resolution/e.resolution,o=t.crop.width/this.columnCount,u=t.crop.height/this.rowCount,a=this.fadeEffect===mt.EFFECT_X||this.fadeEffect===mt.EFFECT_XY,f=this.fadeEffect===mt.EFFECT_Y||this.fadeEffect===mt.EFFECT_XY,l=(a?1-this._factorValue:1)*o/s,c=(f?1-this._factorValue:1)*u/s,h=a&&this.fadeStyle===mt.STYLE_CLIP?o*(1-this._factorValue):o,p=f&&this.fadeStyle===mt.STYLE_CLIP?u*(1-this._factorValue):u,d=r.worldTransform,v=d.a/s,m=d.b/s,g=d.c/s,y=d.d/s,b=d.tx,w=d.ty,E=i.x2-i.x0,S=i.y2-i.y0;for(var x=0;x<t.crop.height;x+=u){var T=(x+u*(f?this._factorValue:0)*this.pivotY)/s+n.y;for(var N=0;N<t.crop.width;N+=o){var C=(N+o*(a?this._factorValue:0)*this.pivotX)/s+n.x;this._webGLAddQuad(e.spriteBatch,r,C,T,C+l,T+c,i.x0+E*N/t.crop.width,i.y0+S*x/t.crop.height,i.x0+E*(N+h)/t.crop.width,i.y0+S*(x+p)/t.crop.height,v,m,g,y,b,w,r.tint)}}},mt.prototype._webGLAddQuad=function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m){e.currentBatchSize>=e.size&&(e.flush(),e.currentBaseTexture=t.texture.baseTexture);var g=e.colors,y=e.positions,b=e.currentBatchSize*4*e.vertSize;e.renderSession.roundPixels?(y[b]=l*n+h*r+d|0,y[b+1]=p*r+c*n+v|0,y[b+5]=l*i+h*r+d|0,y[b+6]=p*r+c*i+v|0,y[b+10]=l*i+h*s+d|0,y[b+11]=p*s+c*i+v|0,y[b+15]=l*n+h*s+d|0,y[b+16]=p*s+c*n+v|0):(y[b]=l*n+h*r+d,y[b+1]=p*r+c*n+v,y[b+5]=l*i+h*r+d,y[b+6]=p*r+c*i+v,y[b+10]=l*i+h*s+d,y[b+11]=p*s+c*i+v,y[b+15]=l*n+h*s+d,y[b+16]=p*s+c*n+v),y[b+2]=o,y[b+3]=u,y[b+7]=a,y[b+8]=u,y[b+12]=a,y[b+13]=f,y[b+17]=o,y[b+18]=f,g[b+4]=g[b+9]=g[b+14]=g[b+19]=(m>>16)+(m&65280)+((m&255)<<16)+(t.worldAlpha*255<<24),e.sprites[e.currentBatchSize++]=t},mt.FADE_IN=0,mt.FADE_OUT=1,mt.STYLE_ZOOM=0,mt.STYLE_CLIP=1,mt.EFFECT_XY=0,mt.EFFECT_X=1,mt.EFFECT_Y=2;var gt=qc.defineBehaviour("qc.TweenFunction",qc.Tween,function(){var e=this;e.funcName="",e.func=null,e.funcContext=null,e.enable=!1},{funcName:qc.Serializer.STRING});gt.__menu="Plugins/TweenFunction",t.defineProperties(gt.prototype,{funcName:{get:function(){return this._funcName},set:function(e){if(e===this._funcName)return;this._funcName=e,this.onEnable()}}}),gt.prototype.onEnable=function(){if(this._funcName.length<=0)return;this.func=this.gameObject[this._funcName];var t=[];this.func&&(t.push(this.gameObject.class),this.func=this.func.bind(this.gameObject));var n=this;this.gameObject.scripts.forEach(function(e){var r=e[n._funcName];r&&(t.push(e.class),n.func=r.bind(e))}),!n.func&&this.enable&&this.game.log.important("TweenFunction({0}) not find!",this._funcName);if(t.length<=1)return;n.game.log.error("Error: Exist multi functions with same name: {0}",t);if(n.game.device.editor===!0){var r=e.parent&&e.parent.G;if(r){var i=r._("TweenFunction func error")+t;r.notification.error(i)}}},gt.prototype.onUpdate=function(e,t){if(typeof this.func!="function")return;if(this.duration==0&&!t)return;this.func(e,this.duration)},gt.begin=function(e,t,n){var r=qc.Tween.begin("qc.TweenFunction",e,t);return r.funcName=n,r};var yt=qc.defineBehaviour("qc.engine.BackgroundController",qc.Behaviour,function(){this.speed=100,this.rightrigidbody=null,this.leftrigidbody=null,this.itemrigidbody=null,this.expressrigidbody=null,this.respeed=0},{speed:qc.Serializer.NUMBER,left:qc.Serializer.NODE,right:qc.Serializer.NODE,background1:qc.Serializer.NODE,background2:qc.Serializer.NODE,background3:qc.Serializer.NODE});yt.prototype.awake=function(){var e=this;ExpressGame.backgroundController=e.getScript("qc.engine.BackgroundController"),e.leftrigidbody=e.left.getScript("qc.arcade.RigidBody"),e.rightrigidbody=e.right.getScript("qc.arcade.RigidBody"),e.leftrigidbody.velocity.x=0,e.leftrigidbody.velocity.y=this.speed,e.rightrigidbody.velocity.x=0,e.rightrigidbody.velocity.y=this.speed},yt.prototype.update=function(){var e=this;ExpressGame.refresh&&(e.leftrigidbody.velocity.y=e.speed,e.rightrigidbody.velocity.y=e.speed)},yt.prototype.pause=function(){var e=this;e.respeed=e.speed,e.speed=0},yt.prototype.play=function(){var e=this;e.speed=e.respeed,ExpressGame.refresh=!0};var bt=qc.defineBehaviour("qc.engine.Car",qc.Behaviour,function(){this.rigidbody=null,this.id=0,this.name="Car",this.speed=200,this.csore=0,this.money=0,this.lv=1,this.ico=null,this.respeed=0},{id:qc.Serializer.NUMBER,name:qc.Serializer.STRING,speed:qc.Serializer.NUMBER,csore:qc.Serializer.NUMBER,money:qc.Serializer.NUMBER,lv:qc.Serializer.NUMBER,ico:qc.Serializer.TEXTURE,minwidth:qc.Serializer.NODE,maxwidth:qc.Serializer.NODE});bt.prototype.awake=function(){var e=this;e.rigidbody=e.getScript("qc.arcade.RigidBody");var t=e.game.math.random(e.minwidth.anchoredX+e.gameObject.width/2,e.maxwidth.anchoredX-e.gameObject.width/2);e.gameObject.anchoredX=t,e.gameObject.anchoredY=-200,e.rigidbody.velocity.x=0,e.rigidbody.velocity.y=e.speed+ExpressGame.backgroundController.speed,this.ico!=null&&this.load()},bt.prototype.update=function(){if(ExpressGame.refresh){var e=this;e.rigidbody.velocity.y=e.speed+ExpressGame.backgroundController.speed}},bt.prototype.load=function(){var e=this;e.gameObject.texture=e.ico},bt.prototype.pause=function(){var e=this;e.respeed=e.speed,e.speed=e.speed/10},bt.prototype.play=function(){var e=this;e.speed=e.respeed};var wt=qc.defineBehaviour("qc.engine.Express",qc.Behaviour,function(){this.rigidbody=null,this.id=0,this.name="Express",this.money=0,this.csore=0,this.type=0,this.ico=null,this.items=null,this.speed=0},{id:qc.Serializer.NUMBER,name:qc.Serializer.STRING,money:qc.Serializer.NUMBER,csore:qc.Serializer.NUMBER,type:qc.Serializer.NUMBER,ico:qc.Serializer.TEXTURE,items:qc.Serializer.NODES,minwidth:qc.Serializer.NODE,maxwidth:qc.Serializer.NODE});wt.prototype.awake=function(){var e=this;e.rigidbody=e.getScript("qc.arcade.RigidBody");var t=e.game.math.random(e.minwidth.anchoredX+e.gameObject.width/2,e.maxwidth.anchoredX-e.gameObject.width/2);e.gameObject.anchoredX=t,e.gameObject.anchoredY=-200,e.rigidbody.velocity.x=0,e.rigidbody.velocity.y=e.speed+ExpressGame.backgroundController.speed,this.ico!=null&&this.load()},wt.prototype.update=function(){if(ExpressGame.refresh){var e=this;e.rigidbody.velocity.y=e.speed+ExpressGame.backgroundController.speed}},wt.prototype.load=function(){var e=this;e.gameObject.texture=e.ico},wt.prototype.outExpress=function(e){var t=e.getScript("qc.engine.Courier");t.csoreChange(-this.csore/2),t.moneyChange(-this.money/2),this.destroy()},wt.prototype.inExpress=function(e){var t=e.getScript("qc.engine.Courier");t.csoreChange(this.csore),t.moneyChange(this.money),ExpressGame.gameController.refreshexpress(),this.destroy()};var Et=qc.defineBehaviour("qc.engine.House",qc.Behaviour,function(){this.id=0,this.name="House",this.type=1,this.height=0,this.ico=null},{id:qc.Serializer.NUMBER,name:qc.Serializer.STRING,type:qc.Serializer.NUMBER,height:qc.Serializer.NUMBER,ico:qc.Serializer.TEXTURE});Et.prototype.awake=function(){},Et.prototype.update=function(){};var St=qc.defineBehaviour("qc.engine.Item",qc.Behaviour,function(){this.id=0,this.name="item",this.money=0,this.csore=0,this.skill=0,this.type="",this.ico=null},{id:qc.Serializer.NUMBER,name:qc.Serializer.STRING,money:qc.Serializer.NUMBER,csore:qc.Serializer.NUMBER,skill:qc.Serializer.NUMBER,type:qc.Serializer.STRING,ico:qc.Serializer.TEXTURE});St.prototype.awake=function(){},St.prototype.update=function(){},St.prototype.getItem=function(e){var t=e.getScript("qc.engine.Courier");t.items.add(this)},St.prototype.outItem=function(){this.destroy()};var xt=qc.defineBehaviour("qc.engine.Player",qc.Behaviour,function(){this.id=0,this.name="Player",this.speed=200,this.type="car",this.csore=0,this.money=0,this.maxSkill=100,this.lv=1,this.ico=null},{id:qc.Serializer.NUMBER,name:qc.Serializer.STRING,speed:qc.Serializer.NUMBER,type:qc.Serializer.STRING,csore:qc.Serializer.NUMBER,money:qc.Serializer.NUMBER,maxSkill:qc.Serializer.NUMBER,lv:qc.Serializer.NUMBER,ico:qc.Serializer.TEXTURE});xt.prototype.awake=function(){},xt.prototype.update=function(){};var Tt=qc.defineBehaviour("qc.engine.Touch",qc.Behaviour,function(){this.rigidbody=null,this.id=0,this.name="Express",this.money=0,this.csore=0,this.type=0,this.ico=null},{id:qc.Serializer.NUMBER,name:qc.Serializer.STRING,money:qc.Serializer.NUMBER,csore:qc.Serializer.NUMBER,type:qc.Serializer.NUMBER,ico:qc.Serializer.TEXTURE});Tt.prototype.awake=function(){var e=this;this.ico!=null&&this.load()},Tt.prototype.update=function(){var e=this;e.gameObject.getWorldPosition().y>1e3&&e.gameObject.destroy()},Tt.prototype.load=function(){var e=this;e.gameObject.texture=e.ico},Tt.prototype.outExpress=function(e){var t=e.getScript("qc.engine.Courier");t.csoreChange(-this.csore/2),t.moneyChange(-this.money/2),this.destroy()},Tt.prototype.inExpress=function(e){var t=e.getScript("qc.engine.Courier");t.csoreChange(this.csore),t.moneyChange(this.money);switch(this.type){case 1:ExpressGame.gameController.express1--;break;case 2:ExpressGame.gameController.express2--;break;case 3:ExpressGame.gameController.express3--;break;default:}ExpressGame.gameController.refreshexpress()},e.ExpressGame=qc.ExpressGame={uiManager:null,gameController:null,carController:null,backgroundController:null,courierController:null,expressController:null,uiController:null,refresh:!1,speedbugclean:!1},qc.initGame=function(e){ExpressGame.game=e};var Nt=qc.defineBehaviour("qc.engine.LoadingUI",qc.Behaviour,function(){this.clue=null},{clue:qc.Serializer.NODE});Nt.prototype.awake=function(){var e=this;this.addListener(e.game.scene.onStartLoad,function(){e.show()}),this.addListener(e.game.scene.onEndLoad,function(){e.gameObject.visible&&(e.duringTween?e.nextChange=1:e.hide())})},Nt.prototype.update=function(){var e=this,t=e.game.assets.loaded,n=e.game.assets.total;n?e.clue.text="加载中："+t+"/"+n:e.clue.text="",e.gameObject.parent.setChildIndex(this.gameObject,e.gameObject.parent.children.length-1)},Nt.prototype.show=function(){var e=this,t=e.gameObject.getScript("qc.Plugins.NodeFadeInOut");e.gameObject.visible=!0,e.gameObject.alpha=0,t.stop(),t.enable=!1,t.target=e.gameObject.game.world,t.fadeType=mt.FADE_OUT,t.fadeStyle=this.getRandomInt(0,2),t.fadeEffect=this.getRandomInt(0,3),t.pivotX=Math.random(0,1),t.pivotY=Math.random(0,1),t.columnCount=this.getRandomInt(1,32),t.rowCount=this.getRandomInt(1,32),t.resetToBeginning(),t.playForward(),e.gameObject.alpha=1,e.duringTween=!0,t.onFinished.addOnce(function(){e.duringTween=!1,e.nextChange&&(e.hide(),e.nextChange=0)})},Nt.prototype.hide=function(){var e=this,t=e.gameObject.getScript("qc.Plugins.NodeFadeInOut");e.gameObject.alpha=1,t.enable=!1,t.target=null,t.fadeType=mt.FADE_OUT,t.fadeStyle=this.getRandomInt(0,2),t.fadeEffect=this.getRandomInt(0,3),t.pivotX=Math.random(0,1),t.pivotY=Math.random(0,1),t.columnCount=this.getRandomInt(1,32),t.rowCount=this.getRandomInt(1,32),t.resetToBeginning(),t.playForward(),e.duringTween=!0,t.onFinished.addOnce(function(){e.gameObject.visible=!1,e.duringTween=!1,e.nextChange=0})},Nt.prototype.getRandomInt=function(e,t){return Math.floor(Math.random()*(t-e))+e};var Ct=qc.defineBehaviour("qc.engine.AutoBackgroundMove",qc.Behaviour,function(){this.speed=100,this.times=6e4,this.maxvalue=0},{speed:qc.Serializer.NUMBER,times:qc.Serializer.NUMBER,maxvalue:qc.Serializer.NUMBER});Ct.prototype.awake=function(){this.speed=ExpressGame.backgroundController.speed},Ct.prototype.update=function(){ExpressGame.speedbugclean&&(this.times=3e4),ExpressGame.refresh&&(this.speed=ExpressGame.backgroundController.speed),this.gameObject.verticalNormalizedPosition=this.gameObject.verticalNormalizedPosition-this.speed/this.times,this.gameObject.verticalNormalizedPosition<=-this.maxvalue&&(this.gameObject.verticalNormalizedPosition=1,ExpressGame.gameController.player.getScript("qc.engine.Courier").csoreChange(100),ExpressGame.gameController.player.getScript("qc.engine.Courier").expChange(10*ExpressGame.gameController.rank))};var kt=qc.defineBehaviour("qc.engine.AutoBackgroundOnCollide",qc.Behaviour,function(){},{});kt.prototype.awake=function(){},kt.prototype.update=function(){},kt.prototype.onCollide=function(e,t){t.top=-960,t.bottom=960};var Lt=qc.defineBehaviour("qc.engine.AutoHouseLoadOnCollide",qc.Behaviour,function(){this.bl=0},{bl:qc.Serializer.NUMBER});Lt.prototype.awake=function(){var e=this},Lt.prototype.update=function(){var e=this;if(e.gameObject.getWorldPosition().y>-200&&e.bl==0){var t=e.game.math.random(1,7),n="Assets/prefab/house/house"+t+".bin";e.game.assets.load("house",n,function(t){var n=e.game.assets.find("house"),r=e.game.add.clone(n,e.gameObject.parent);r.anchoredY=e.gameObject.anchoredY-r.height}),e.bl=1}e.gameObject.getWorldPosition().y>1e3&&e.gameObject.destroy()};var At=qc.defineBehaviour("qc.engine.AutoTouchLoad",qc.Behaviour,function(){this.touchvalue=1,this.touchdelay=4,this.maxtype=3,this.left=null,this.right=null},{touchvalue:qc.Serializer.NUMBER,touchdelay:qc.Serializer.NUMBER,left:qc.Serializer.NODE,right:qc.Serializer.NODE});At.prototype.awake=function(){this.touchvalue=this.game.math.random(1,this.maxtype);var e=this.game.timer.loop(this.touchdelay*1e3,function(){var e=this;e.createtouch()},this)},At.prototype.update=function(){},At.prototype.createtouch=function(){var e=this,t="Assets/prefab/express/touch"+this.touchvalue+".bin";e.game.assets.load("touch",t,function(t){var n=e.game.assets.find("touch"),r=e.game.math.random(1,2);switch(r){case 1:var i=e.game.add.clone(n,e.left);i.anchoredY=e.gameObject.anchoredY;break;case 2:var i=e.game.add.clone(n,e.right);i.anchoredY=e.gameObject.anchoredY;break;default:var i=e.game.add.clone(n,e.left);i.anchoredY=e.gameObject.anchoredY}}),this.touchvalue=e.game.math.random(1,this.maxtype)};var Ot=qc.defineBehaviour("qc.engine.CarOnCollide",qc.Behaviour,function(){},{});Ot.prototype.onCollide=function(e,t){var n=this;if(t.name=="Courier"){ExpressGame.gameController.gamepause(),ExpressGame.refresh=!0,n.game.timer.add(1e3,function(){ExpressGame.refresh=!1},n);var r="Assets/prefab/effect/boom.bin";n.game.assets.load("boom",r,function(e){var t=n.game.assets.find("boom"),r=n.game.add.clone(t,ExpressGame.gameController.player)},this),this.game.timer.add(1500,function(){ExpressGame.gameController.death()},this),n.getScript("qc.engine.CarOnCollide").destroy()}};var Mt=qc.defineBehaviour("qc.engine.DestoryOnCollide",qc.Behaviour,function(){},{});Mt.prototype.onCollide=function(e,t){t.name=="buttomout"&&e.destroy()};var _t=qc.defineBehaviour("qc.engine.ExpressOnCollide",qc.Behaviour,function(){},{});_t.prototype.awake=function(){},_t.prototype.update=function(){},_t.prototype.onCollide=function(e,t){var n=this;if(t.name=="Courier"){switch(n.getScript("qc.engine.Express").type){case 1:ExpressGame.gameController.express1+=1,ExpressGame.gameController.expressadd(1,0,0);break;case 2:ExpressGame.gameController.express2+=1,ExpressGame.gameController.expressadd(0,1,0);break;case 3:ExpressGame.gameController.express3+=1,ExpressGame.gameController.expressadd(0,0,1);break;default:}this.game.timer.add(300,function(){ExpressGame.gameController.refreshexpress()},this);var r="Assets/prefab/effect/kirakira.bin";n.game.assets.load("kirakira",r,function(t){var r=n.game.assets.find("kirakira"),i=n.game.add.clone(r,e.parent);i.x=n.gameObject.x,i.y=n.gameObject.y;var s=i.addScript("qc.arcade.RigidBody");s.velocity.y=ExpressGame.backgroundController.speed,n.game.timer.add(1e3,function(){i.destroy()},n)}),e.destroy()}};var Dt=qc.defineBehaviour("qc.engine.loadGame",qc.Behaviour,function(){},{});Dt.prototype.awake=function(){var e=this;e.game.timer.add(5,function(){e.game.world.find("Loading").destroy(),e.game.scene.load("test1",!0,function(){e.game.assets.load("csore","Assets/atlas/texiao.bin"),e.game.assets.load("csore","Assets/atlas/csore.bin"),e.game.assets.load("turn_secen","Assets/atlas/turn_secen.bin"),e.game.assets.load("housecar","Assets/atlas/housecar.bin"),e.game.assets.load("express","Assets/prefab/express/express1.bin"),e.game.assets.load("express","Assets/prefab/express/express2.bin"),e.game.assets.load("express","Assets/prefab/express/express3.bin"),e.game.assets.load("touch","Assets/prefab/express/touch1.bin"),e.game.assets.load("touch","Assets/prefab/express/touch2.bin"),e.game.assets.load("touch","Assets/prefab/express/touch3.bin"),e.game.assets.load("car","Assets/prefab/enemy/car1.bin"),e.game.assets.load("car","Assets/prefab/enemy/car2.bin"),e.game.assets.load("car","Assets/prefab/enemy/car3.bin"),e.game.assets.load("car","Assets/prefab/enemy/car4.bin"),e.game.assets.load("car","Assets/prefab/enemy/car5.bin")},function(){})},e)};var Pt=qc.defineBehaviour("qc.engine.Courier",qc.Behaviour,function(){this.id=0,this.name="Courier",this.speed=600,this.csore=0,this.money=0,this.exp=0,this.skill=0,this.maxSkill=100,this.lv=1,this.ico=null},{id:qc.Serializer.NUMBER,name:qc.Serializer.STRING,speed:qc.Serializer.NUMBER,csore:qc.Serializer.NUMBER,money:qc.Serializer.NUMBER,exp:qc.Serializer.NUMBER,skill:qc.Serializer.NUMBER,maxSkill:qc.Serializer.NUMBER,lv:qc.Serializer.NUMBER,ico:qc.Serializer.TEXTURE});Pt.prototype.awake=function(){},Pt.prototype.update=function(){},Pt.prototype.speedChange=function(e){this.speed+e>2e3?this.speed=2e3:this.speed+e<0?this.speed=0:this.speed=this.speed+e},Pt.prototype.skillChange=function(e){this.skill+e>this.maxSkill?this.skill=this.maxSkill:this.skill+e<0?this.skill=0:this.skill=this.skill+e},Pt.prototype.csoreChange=function(e){this.csore+e<0?this.csore=0:this.csore=this.csore+e},Pt.prototype.expChange=function(e){this.exp+e<0?this.exp=0:this.exp=this.exp+e},Pt.prototype.moneyChange=function(e){this.money+e<0?this.money=0:this.money=this.money+e},Pt.prototype.levelup=function(e){this.speed=this.speed+30*e,this.csore=this.csore+100*e,this.level=this.level+e},Pt.prototype.death=function(){this.speed=0},Pt.prototype.damage=function(e){},Pt.prototype.express=function(e){};var Ht=qc.defineBehaviour("qc.engine.CarController",qc.Behaviour,function(){this.bulletRoot=null,this.nowcar=null,this.value=1,this.delay=5,this.maxtype=3,this.carcreatetimer=null,this.count=0,this.isplay=!0},{bulletRoot:qc.Serializer.NODE,nowcar:qc.Serializer.PREFAB,value:qc.Serializer.NUMBER,delay:qc.Serializer.NUMBER,maxtype:qc.Serializer.NUMBER});Ht.prototype.awake=function(){this.value=this.game.math.random(1,this.maxtype),ExpressGame.carController=this.getScript("qc.engine.CarController")},Ht.prototype.update=function(){this.isplay&&(this.count>this.delay*1e3&&(this.createcar(),this.count-=this.delay*1e3),this.count+=this.game.time.deltaTime)},Ht.prototype.createcar=function(){var e=this,t="Assets/prefab/enemy/car"+this.value+".bin";e.game.assets.load("car",t,function(t){var n=e.game.assets.find("car"),r=e.game.add.clone(n,e.bulletRoot)}),this.value=e.game.math.random(1,e.maxtype)},Ht.prototype.pause=function(){var e=this;e.isplay=!1},Ht.prototype.play=function(){var e=this;e.isplay=!0};var Bt=qc.defineBehaviour("qc.engine.CourierController",qc.Behaviour,function(){this.rigidbody=null,this.player=null,this.angle=5,this.tinyangle=.1,this.type=0,this.isplay=!0,this.reVelocityx=0,this.reVelocityy=0,this.startmoveX=0,this.startmoveY=0},{angle:qc.Serializer.NUMBER,tinyangle:qc.Serializer.NUMBER});Bt.prototype.awake=function(){var e=this,t=e.game.input;e.rigidbody=e.getScript("qc.arcade.RigidBody"),e.player=e.getScript("qc.engine.Courier"),e.game.input.onPointerDown.add(this.onPointerDown,this),e.game.input.onPointerUp.add(this.onPointerUp,this),e.game.input.onPointerMove.add(this.onPointerMove,this),e.game.input.onKeyUp.add(this.onKeyUp,e),ExpressGame.courierController=e.getScript("qc.engine.CourierController")},Bt.prototype.onKeyUp=function(e,t){if(e==39||e==37)this.type=0},Bt.prototype.update=function(){var e=this;e.isplay&&(e.game.input.isKeyDown(qc.Keyboard.LEFT)?e.type=-1:e.game.input.isKeyDown(qc.Keyboard.RIGHT)&&(e.type=1),e.type==-1&&(e.gameObject.rotation>-e.game.math.degToRad(e.angle)?(e.gameObject.rotation-=e.tinyangle,e.rigidbody.velocity.x-=e.player.speed/20):(e.gameObject.rotation=e.game.math.degToRad(-e.angle),e.rigidbody.velocity.x=-e.player.speed)),e.type==1&&(e.gameObject.rotation<e.game.math.degToRad(e.angle)?(e.gameObject.rotation+=e.tinyangle,e.rigidbody.velocity.x+=e.player.speed/20):(e.gameObject.rotation=e.game.math.degToRad(e.angle),e.rigidbody.velocity.x=e.player.speed)),e.type==0&&(e.gameObject.rotation<-e.tinyangle?(e.gameObject.rotation+=e.tinyangle,e.rigidbody.velocity.x+=e.player.speed/20):e.gameObject.rotation>e.tinyangle?(e.gameObject.rotation-=e.tinyangle,e.rigidbody.velocity.x-=e.player.speed/20):(e.gameObject.rotation=0,e.rigidbody.velocity.x=0)))},Bt.prototype.onPointerDown=function(e,t,n){var r=this;this.startmoveX=t},Bt.prototype.onPointerMove=function(e,t,n){var r=this;r.isplay&&(t<this.startmoveX?r.type=-1:r.type=1)},Bt.prototype.onPointerUp=function(e,t,n){var r=this;this.startmoveX=t,r.isplay&&(r.type=0)},Bt.prototype.pause=function(){var e=this;e.reVelocityx=e.rigidbody.velocity.x,e.rigidbody.velocity.x=0,e.isplay=!1},Bt.prototype.play=function(){var e=this;e.rigidbody.velocity.x=e.reVelocityx,e.isplay=!0};var jt=qc.defineBehaviour("qc.engine.ExpressController",qc.Behaviour,function(){this.bulletRoot=null,this.expressvalue=1,this.touchvalue=1,this.expressdelay=5,this.touchdelay=10,this.maxtype=3,this.left=null,this.right=null,this.expresstimer=null,this.touchtimer=null},{bulletRoot:qc.Serializer.NODE,expressvalue:qc.Serializer.NUMBER,touchvalue:qc.Serializer.NUMBER,expressdelay:qc.Serializer.NUMBER,touchdelay:qc.Serializer.NUMBER,left:qc.Serializer.NODE,right:qc.Serializer.NODE});jt.prototype.awake=function(){this.expressvalue=this.game.math.random(1,this.maxtype),this.touchvalue=this.game.math.random(1,this.maxtype),this.expresstimer=this.game.timer.loop(this.expressdelay*1e3,function(){var e=this;e.createexpress()},this),this.touchtimer=this.game.timer.loop(this.touchdelay*1e3,function(){var e=this;e.createtouch()},this),ExpressGame.carController=this.getScript("qc.engine.ExpressController")},jt.prototype.update=function(){ExpressGame.refresh},jt.prototype.pause=function(){this.game.timer.remove(this.expresstimer),this.game.timer.remove(this.touchtimer)},jt.prototype.play=function(){this.expresstimer=this.game.timer.loop(this.expressdelay*1e3,function(){var e=this;e.createexpress()},this),this.touchtimer=this.game.timer.loop(this.touchdelay*1e3,function(){var e=this;e.createtouch()},this)},jt.prototype.createexpress=function(){var e=this,t="Assets/prefab/express/express"+this.expressvalue+".bin";e.game.assets.load("express",t,function(t){var n=e.game.assets.find("express"),r=e.game.add.clone(n,e.bulletRoot)}),this.expressvalue=e.game.math.random(1,this.maxtype)},jt.prototype.createtouch=function(){var e=this,t="Assets/prefab/express/touch"+this.touchvalue+".bin";e.game.assets.load("touch",t,function(t){var n=e.game.assets.find("touch"),r=e.game.math.random(1,2);switch(r){case 1:var i=e.game.add.clone(n,e.left);i.anchoredY=-e.left.anchoredY-200-960;break;case 2:var i=e.game.add.clone(n,e.right);i.anchoredY=-e.right.anchoredY-200-960;break;default:var i=e.game.add.clone(n,e.left);i.anchoredY=-e.left.anchoredY-200-960}}),this.touchvalue=e.game.math.random(1,this.maxtype)};var Ft=qc.defineBehaviour("qc.engine.GameController",qc.Behaviour,function(){this.player=null,this.express1=0,this.express2=0,this.express3=0,this.UI=null,this.rank=1,this.rankrefresh=!0,this.exp=0,this.ranktime=10,this.speed=100,this.cardelay=5,this.expressdelay=2,this.touchdelay=1,this.count=0,this.isplay=!0},{player:qc.Serializer.NODE,express1:qc.Serializer.NUMBER,express2:qc.Serializer.NUMBER,express3:qc.Serializer.NUMBER,ranktime:qc.Serializer.NUMBER,rank:qc.Serializer.NUMBER,rankrefresh:qc.Serializer.BOOLEAN,speed:qc.Serializer.NUMBER,cardelay:qc.Serializer.NUMBER,expressdelay:qc.Serializer.NUMBER,touchdelay:qc.Serializer.NUMBER});Ft.prototype.awake=function(){var e=this;ExpressGame.gameController=this.getScript("qc.engine.GameController"),this.game.timer.add(5,function(){e.game.world.find("scoreviwe").visible=!1,e.game.world.find("Loading").visible=!1},this),e.game.assets.load("housecar","Assets/atlas/housecar.bin")},Ft.prototype.update=function(){var e=this;e.isplay&&(e.count>e.ranktime*1e3&&(e.rank++,e.rankrefresh=!0,ExpressGame.uiController.infomationchange("难度提升，当前难度为 "+e.rank),e.count-=e.ranktime*1e3,e.player.getScript(qc.engine.Courier).csoreChange(e.rank*100)),e.count+=e.game.time.deltaTime,e.rankrefresh&&(ExpressGame.backgroundController.speed=e.speed*e.rank,this.game.world.find("GameController").getScript("qc.engine.CarController").delay=e.cardelay/e.rank,ExpressGame.refresh=!0,e.game.timer.add(1e3,function(){ExpressGame.refresh=!1},e)))},Ft.prototype.refreshexpress=function(){var e=this;ExpressGame.uiController.expresschange(e.express1,e.express2,e.express3)},Ft.prototype.expressadd=function(e,t,n){var r=this;ExpressGame.uiController.expressadd(e,t,n)},Ft.prototype.pause=function(){var e=this;e.isplay=!1},Ft.prototype.play=function(){var e=this;e.isplay=!0},Ft.prototype.gamepause=function(){var e=this;ExpressGame.backgroundController.pause(),ExpressGame.carController.pause(),ExpressGame.courierController.pause(),e.pause()},Ft.prototype.death=function(){var e=this,t=e.player.getScript("qc.engine.Courier");ExpressGame.uiController.death(t.csore,t.money,t.exp)},Ft.prototype.gameclean=function(){var e=this;e.game.timer.remove(ExpressGame.uiController.infomationtimer),e.game.timer.remove(this.game.world.find("GameController").getScript("qc.engine.ExpressController").expresstimer),e.game.timer.remove(this.game.world.find("GameController").getScript("qc.engine.ExpressController").touchtimer)};var It=qc.defineBehaviour("qc.engine.UIController",qc.Behaviour,function(){this.UI=null,this.infomationtimer=null,this.scoreview=null},{UI:qc.Serializer.NODE,scoreview:qc.Serializer.NODE});It.prototype.awake=function(){ExpressGame.uiController=this.getScript("qc.engine.UIController")},It.prototype.update=function(){},It.prototype.expresschange=function(e,t,n){var r=this;r.UI.find("express1").getChildAt(0).text=e.toString(),r.UI.find("express2").getChildAt(0).text=t.toString(),r.UI.find("express3").getChildAt(0).text=n.toString()},It.prototype.expressadd=function(e,t,n){var r=this;if(e!=0){var i="Assets/prefab/effect/numberchange.bin";r.game.assets.load("numberchange",i,function(e){var t=r.game.assets.find("numberchange"),n=r.game.add.clone(t,r.UI.find("express1").getChildAt(0))},this)}if(t!=0){var i="Assets/prefab/effect/numberchange.bin";r.game.assets.load("numberchange",i,function(e){var t=r.game.assets.find("numberchange"),n=r.game.add.clone(t,r.UI.find("express2").getChildAt(0))},this)}if(n!=0){var i="Assets/prefab/effect/numberchange.bin";r.game.assets.load("numberchange",i,function(e){var t=r.game.assets.find("numberchange"),n=r.game.add.clone(t,r.UI.find("express3").getChildAt(0))},this)}},It.prototype.infomationchange=function(e){var t=this.UI.find("infomation");t.getChildAt(0).text=e,t.getScript("qc.TweenPosition").playGroupForward(!1),this.infomationtimer=this.game.timer.add(2e3,function(){var e=this;t.getScript("qc.TweenPosition").playGroupReverse(!1)},this)},It.prototype.death=function(e,t,n){var r=this;r.scoreview.find("scoreText").text=e.toString(),r.scoreview.find("moneyText").text=t.toString(),r.scoreview.find("expText").text=n.toString(),r.scoreview.visible=!0,r.game.paused=!0};var qt=qc.defineBehaviour("qc.engine.test1",qc.Behaviour,function(){this.speed=60,this.maxTime=3,this.fireTime=0,this.bulletRoot=null,this.bulletPrefab=null,this.firep=null,this.pointx=0,this.pointy=0,this.canjump=!1,this.isjump=!0,this.enemy=null,this.floor1=null,this.floor2=null},{speed:qc.Serializer.NUMBER,maxTime:qc.Serializer.NUMBER,bulletRoot:qc.Serializer.NODE,bulletPrefab:qc.Serializer.PREFAB,firep:qc.Serializer.NODE,pointx:qc.Serializer.NUMBER,pointy:qc.Serializer.NUMBER,canjump:qc.Serializer.BOOLEAN,isjump:qc.Serializer.BOOLEAN,fireTime:qc.Serializer.NUMBER,enemy:qc.Serializer.NODE,floor1:qc.Serializer.NODE,floor2:qc.Serializer.NODE});qt.prototype.awake=function(){this.pointx=this.firep.x-this.gameObject.anchoredX,this.pointy=this.firep.y-this.gameObject.anchoredY},qt.prototype.update=function(){var e=this,t=this.getScript("qc.arcade.RigidBody");t.angularAcceleration=0;if(t.velocity.y<-40||t.velocity.y>40)e.gameObject.playAnimation("cheer"),this.isjump=!0,this.canjump=!1,this.pointx=51,this.pointy=-59;e.game.input.isKeyDown(qc.Keyboard.LEFT)?(t.velocity.x=-500,e.gameObject.scaleX=-1,this.isjump||e.gameObject.playAnimation("move")):e.game.input.isKeyDown(qc.Keyboard.RIGHT)?(t.velocity.x=500,e.gameObject.scaleX=1,this.isjump||e.gameObject.playAnimation("move")):(t.velocity.x=0,this.isjump||e.gameObject.playAnimation("idle")),e.game.input.isKeyDown(qc.Keyboard.Z)&&this.canjump&&(t.velocity.set(t.velocity.x,-3e3),e.gameObject.playAnimation("cheer"),this.canjump=!1,this.isjump=!0),e.game.input.isKeyDown(qc.Keyboard.X)&&this.fireTime>this.maxTime&&(e.fire(),this.fireTime=0),this.firep.x=this.gameObject.anchoredX+this.pointx*e.gameObject.scaleX,this.firep.y=this.gameObject.anchoredY+this.pointy,this.fireTime<=this.maxTime&&this.fireTime++},qt.prototype.fire=function(){var e=this,t=this.getScript("qc.arcade.RigidBody"),n=e.game.add.clone(e.bulletPrefab,e.bulletRoot);n.x=this.firep.x,n.y=this.firep.y;var r=n.getScript("qc.arcade.RigidBody");r.addCollide(this.enemy),r.addCollide(this.floor1),r.addCollide(this.floor2),r.velocity.x=1e3*e.gameObject.scaleX,r.velocity.y=1e3;var i=this.game.timer.add(3e3,function(){n.destroy()})};var Rt=qc.defineBehaviour("qc.engine.backBtnClick",qc.Behaviour,function(){this.backBtn=null},{backBtn:qc.Serializer.NODE});Rt.prototype.awake=function(){this.addListener(this.backBtn.onClick,this.backBtnClick,this)},Rt.prototype.backBtnClick=function(){ExpressGame.uiManager.switchStateTo(Qt.index)};var Ut=qc.defineBehaviour("qc.engine.BtnScale",qc.Behaviour,function(){this.Button=null,this.tweenScale=null},{Button:qc.Serializer.NODE});Ut.prototype.awake=function(){this.tweenScale=this.Button.addScript("qc.TweenScale"),this.tweenScale.from.x=1,this.tweenScale.from.y=1,this.tweenScale.to.y=.9,this.tweenScale.to.x=.9,this.tweenScale.duration=.1,this.addListener(this.Button.onDown,this.ButtonDown,this),this.addListener(this.Button.onUp,this.ButtonUp,this)},Ut.prototype.ButtonDown=function(){this.tweenScale.playForward()},Ut.prototype.ButtonUp=function(){this.tweenScale.playReverse()};var zt=qc.defineBehaviour("qc.engine.indexStartClick",qc.Behaviour,function(){this.type=1},{type:qc.Serializer.NUMBER});zt.prototype.onClick=function(){var e=this;switch(this.type){case 1:ExpressGame.speedbugclean=!0,this.game.scene.load("test1",!0,function(){e.game.world.find("Loading").visible=!0},function(){e.game.world.find("Loading").destroy()});break;case 2:ExpressGame.speedbugclean=!0,this.game.scene.load("test1",!0,function(){e.game.world.find("Loading").visible=!0},function(){e.game.world.find("Loading").destroy()});break;case 3:break;default:}};var Wt=qc.defineBehaviour("qc.engine.pause",qc.Behaviour,function(){this.pausegameObject=null,this.type=0,this.speed=200},{pausegameObject:qc.Serializer.NODE,type:qc.Serializer.NUMBER});Wt.prototype.awake=function(){this.type!=0&&this.addListener(this.gameObject.onNativeClick,this.gamePause,this)},Wt.prototype.update=function(){},Wt.prototype.gamePause=function(){var e=this;e.type==1?(e.pausegameObject.visible=!1,e.game.paused=!1):e.type!=2&&e.type==3&&(this.game.paused=!1,ExpressGame.gameController.gameclean(),e.game.world.find("Loading").visible=!0,this.game.scene.load("index",!0,function(){},function(){e.game.world.find("Loading").destroy()}))},Wt.prototype.onClick=function(e){var t=this;t.type==0&&(t.pausegameObject.visible=!0,t.game.paused=!0)};var Xt=qc.defineBehaviour("qc.engine.scoreviewMainClick",qc.Behaviour,function(){},{});Xt.prototype.awake=function(){this.addListener(this.gameObject.onNativeClick,this.gamePause,this)},Xt.prototype.gamePause=function(){var e=this;this.game.paused=!1,ExpressGame.gameController.gameclean(),e.game.world.find("Loading").visible=!0,e.game.scene.load("index",!0,function(){},function(){e.game.world.find("Loading").destroy()})};var Vt=qc.defineBehaviour("qc.engine.scoreviewStartClick",qc.Behaviour,function(){},{});Vt.prototype.awake=function(){this.addListener(this.gameObject.onNativeClick,this.gamePause,this)},Vt.prototype.gamePause=function(){var e=this;this.game.paused=!1,ExpressGame.gameController.gameclean(),this.game.timer.add(5,this.load.bind(this))},Vt.prototype.load=function(){var e=this;this.game.scene.load("test1",!0,function(){e.game.assets.load("csore","Assets/atlas/effect.bin"),e.game.assets.load("csore","Assets/atlas/csore.bin"),e.game.assets.load("turn_secen","Assets/atlas/turn_secen.bin"),e.game.assets.load("housecar","Assets/atlas/housecar.bin"),e.game.assets.load("express","Assets/prefab/express/express1.bin"),e.game.assets.load("express","Assets/prefab/express/express2.bin"),e.game.assets.load("express","Assets/prefab/express/express3.bin"),e.game.assets.load("touch","Assets/prefab/express/touch1.bin"),e.game.assets.load("touch","Assets/prefab/express/touch2.bin"),e.game.assets.load("touch","Assets/prefab/express/touch3.bin"),e.game.assets.load("car","Assets/prefab/enemy/car1.bin"),e.game.assets.load("car","Assets/prefab/enemy/car2.bin"),e.game.assets.load("car","Assets/prefab/enemy/car3.bin"),e.game.assets.load("car","Assets/prefab/enemy/car4.bin"),e.game.assets.load("car","Assets/prefab/enemy/car5.bin")},function(){})};var $t=qc.defineBehaviour("qc.engine.touchClick",qc.Behaviour,function(){},{});$t.prototype.awake=function(){},$t.prototype.update=function(){},$t.prototype.expanime=function(e){var t=this,n="Assets/prefab/express/expanime"+e+".bin";t.game.assets.load("expanime",n,function(e){var n=t.game.assets.find("expanime"),r=t.game.add.clone(n,t.game.world.find("UIRoot"));r.x=ExpressGame.gameController.player.getWorldPosition().x,r.y=ExpressGame.gameController.player.getWorldPosition().y;var i=r.getScript("qc.TweenPosition");i.from.x=r.x,i.from.y=r.y,i.to.x=t.gameObject.getWorldPosition().x,i.to.y=t.gameObject.getWorldPosition().y+ExpressGame.backgroundController.speed*.5,t.game.timer.add(500,function(){r.destroy()},t)}),this.game.timer.add(500,function(){t.gameObject.destroy()},this),t.getScript("qc.engine.touchClick").destroy()},$t.prototype.onClick=function(){var e=this,t=e.getScript("qc.engine.Touch");switch(t.type){case 1:ExpressGame.gameController.express1>0&&(t.inExpress(ExpressGame.gameController.player),e.expanime(t.type));break;case 2:ExpressGame.gameController.express2>0&&(t.inExpress(ExpressGame.gameController.player),e.expanime(t.type));break;case 3:ExpressGame.gameController.express3>0&&(t.inExpress(ExpressGame.gameController.player),e.expanime(t.type));break;default:}};var Jt=qc.defineBehaviour("qc.engine.indexBtn",qc.Behaviour,function(){this.helpBtn=null,this.setBtn=null,this.infoBtn=null,this.music_xBtn=null,this.musicText=null,this.moreBtn=null,this.medalBtn=null,this.scoreBtn=null,this.fcBtn=null,this.fcText=null,this.startBtn=null,this.setBlue=null},{helpBtn:qc.Serializer.NODE,setBtn:qc.Serializer.NODE,setBlue:qc.Serializer.NODE,infoBtn:qc.Serializer.NODE,music_xBtn:qc.Serializer.NODE,musicText:qc.Serializer.NODE,moreBtn:qc.Serializer.NODE,moreBlue:qc.Serializer.NODE,medalBtn:qc.Serializer.NODE,scoreBtn:qc.Serializer.NODE,fcBtn:qc.Serializer.NODE,fcText:qc.Serializer.NODE,startBtn:qc.Serializer.NODE});Jt.prototype.awake=function(){this.addListener(this.helpBtn.onClick,this.helpBtnClick,this),this.addListener(this.infoBtn.onClick,this.infoBtnClick,this),this.addListener(this.medalBtn.onClick,this.medalBtnClick,this),this.addListener(this.scoreBtn.onClick,this.scoreBtnClick,this),this.addListener(this.startBtn.onClick,this.startBtnClick,this),this.addListener(this.setBtn.onClick,this.setBtnClick,this),this.addListener(this.moreBtn.onClick,this.moreBtnClick,this),this.addListener(this.music_xBtn.onClick,this.music_xBtnClick,this),this.addListener(this.fcBtn.onClick,this.fcBtnClick,this)},Jt.prototype.helpBtnClick=function(){ExpressGame.uiManager.switchStateTo(Qt.help)},Jt.prototype.infoBtnClick=function(){ExpressGame.uiManager.switchStateTo(Qt.info)},Jt.prototype.medalBtnClick=function(){ExpressGame.uiManager.switchStateTo(Qt.medal)},Jt.prototype.scoreBtnClick=function(){ExpressGame.uiManager.switchStateTo(Qt.score)},Jt.prototype.startBtnClick=function(){ExpressGame.uiManager.switchStateTo(Qt.start)},Jt.prototype.setBtnClick=function(){var e=this,t=this.setBlue.getScript("qc.TweenPosition"),n=this.setBlue.getScript("qc.TweenAlpha");this.setBlue.anchoredY==120?(n.delay=.1,n.duration=.1,t.playGroupForward()):(n.delay=0,n.duration=.05,t.playGroupReverse())},Jt.prototype.moreBtnClick=function(){var e=this,t=this.moreBlue.getScript("qc.TweenPosition"),n=this.moreBlue.getScript("qc.TweenAlpha");this.moreBlue.anchoredY==175?(t.duration=.1,n.delay=.1,n.duration=.1,t.playGroupForward()):(t.duration=.2,n.delay=0,n.duration=.04,t.playGroupReverse())},Jt.prototype.music_xBtnClick=function(){var e=this.musicText.getScript("qc.TweenPosition"),t=this.musicText.getScript("qc.TweenAlpha");e.resetGroupToBeginning(),e.playGroupForward()},Jt.prototype.fcBtnClick=function(){var e=this.fcText.getScript("qc.TweenPosition"),t=this.fcText.getScript("qc.TweenAlpha");e.resetGroupToBeginning(),e.playGroupForward()};var Kt=qc.defineBehaviour("qc.engine.touchInput",qc.Behaviour,function(){this.type=1},{type:qc.Serializer.NUMBER});Kt.prototype.awake=function(){},Kt.prototype.onDown=function(){ExpressGame.courierController.type=this.type},Kt.prototype.onUp=function(){ExpressGame.courierController.type=0};var Qt=qc.defineBehaviour("qc.engine.UIManager",qc.Behaviour,function(){var e=this;ExpressGame.uiManager=e},{Index:qc.Serializer.NODE,Help:qc.Serializer.NODE,Info:qc.Serializer.NODE,Medal:qc.Serializer.NODE,Start:qc.Serializer.NODE,Score:qc.Serializer.NODE});Qt.index=0,Qt.help=1,Qt.info=2,Qt.medal=3,Qt.start=4,Qt.score=5,Qt.prototype.awake=function(){this.switchStateTo(Qt.index)},Qt.prototype.switchStateTo=function(e){var t=this;ExpressGame.game.time.frameRate=30,t.Index.visible=e===Qt.index,t.Index.visible,t.Help.visible=e===Qt.help,t.Info.visible=e===Qt.info,t.Medal.visible=e===Qt.medal,t.Start.visible=e===Qt.start,t.Score.visible=e===Qt.score}}).call(this,this,Object)